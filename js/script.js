!function t(e,n,i){function o(r,a){if(!n[r]){if(!e[r]){var l="function"==typeof require&&require;if(!a&&l)return l(r,!0);if(s)return s(r,!0);var u=new Error("Cannot find module '"+r+"'");throw u.code="MODULE_NOT_FOUND",u}var h=n[r]={exports:{}};e[r][0].call(h.exports,function(t){var n=e[r][1][t];return o(n?n:t)},h,h.exports,t,e,n,i)}return n[r].exports}for(var s="function"==typeof require&&require,r=0;r<i.length;r++)o(i[r]);return o}({1:[function(t,e,n){!function(t){"use strict";function n(t,e){t.className+=" "+e}function i(t,e){for(var n=e.split(" "),i=0;i<n.length;i+=1)t.className=t.className.replace(" "+n[i],"")}function o(){return"rtl"===t.getComputedStyle(document.body).direction}function s(){return document.documentElement&&document.documentElement.scrollTop||document.body.scrollTop}function r(){return document.documentElement&&document.documentElement.scrollLeft||document.body.scrollLeft}function a(t){for(;t.lastChild;)t.removeChild(t.lastChild)}function l(t){if(null===t)return t;var e;if(Array.isArray(t)){e=[];for(var n=0;n<t.length;n+=1)e.push(l(t[n]));return e}if(t instanceof Date)return new Date(t.getTime());if(t instanceof RegExp)return e=new RegExp(t.source),e.global=t.global,e.ignoreCase=t.ignoreCase,e.multiline=t.multiline,e.lastIndex=t.lastIndex,e;if("object"==typeof t){e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=l(t[i]));return e}return t}function u(t,e){var n=t.elements.root;n.parentNode.removeChild(n),delete t.elements,t.settings=l(t.__settings),t.__init=e,delete t.__internal}function h(t,e){return function(){if(arguments.length>0){for(var n=[],i=0;i<arguments.length;i+=1)n.push(arguments[i]);return n.push(t),e.apply(t,n)}return e.apply(t,[null,t])}}function c(t,e){return{index:t,button:e,cancel:!1}}function d(){function t(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function e(t){var e=i[t].dialog;return e&&"function"==typeof e.__init&&e.__init(e),e}function n(e,n,o,s){var r={dialog:null,factory:n};return void 0!==s&&(r.factory=function(){return t(new i[s].factory,new n)}),o||(r.dialog=t(new r.factory,y)),i[e]=r}var i={};return{defaults:f,dialog:function(i,o,s,r){if("function"!=typeof o)return e(i);if(this.hasOwnProperty(i))throw new Error("alertify.dialog: name already exists");var a=n(i,o,s,r);s?this[i]=function(){if(0===arguments.length)return a.dialog;var e=t(new a.factory,y);return e&&"function"==typeof e.__init&&e.__init(e),e.main.apply(e,arguments),e.show.apply(e)}:this[i]=function(){if(a.dialog&&"function"==typeof a.dialog.__init&&a.dialog.__init(a.dialog),0===arguments.length)return a.dialog;var t=a.dialog;return t.main.apply(a.dialog,arguments),t.show.apply(a.dialog)}},closeAll:function(t){for(var e=m.slice(0),n=0;n<e.length;n+=1){var i=e[n];(void 0===t||t!==i)&&i.close()}},setting:function(t,n,i){if("notifier"===t)return b.setting(n,i);var o=e(t);return o?o.setting(n,i):void 0},set:function(t,e,n){return this.setting(t,e,n)},get:function(t,e){return this.setting(t,e)},notify:function(t,e,n,i){return b.create(e,i).push(t,n)},message:function(t,e,n){return b.create(null,n).push(t,e)},success:function(t,e,n){return b.create("success",n).push(t,e)},error:function(t,e,n){return b.create("error",n).push(t,e)},warning:function(t,e,n){return b.create("warning",n).push(t,e)},dismissAll:function(){b.dismissAll()}}}var p={ENTER:13,ESC:27,F1:112,F12:123,LEFT:37,RIGHT:39},f={modal:!0,basic:!1,frameless:!1,movable:!0,moveBounded:!1,resizable:!0,closable:!0,closableByDimmer:!0,maximizable:!0,startMaximized:!1,pinnable:!0,pinned:!0,padding:!0,overflow:!0,maintainFocus:!0,transition:"pulse",autoReset:!0,notifier:{delay:5,position:"bottom-right"},glossary:{title:"AlertifyJS",ok:"OK",cancel:"Cancel",acccpt:"Accept",deny:"Deny",confirm:"Confirm",decline:"Decline",close:"Close",maximize:"Maximize",restore:"Restore"},theme:{input:"ajs-input",ok:"ajs-ok",cancel:"ajs-cancel"}},m=[],_=function(){return document.addEventListener?function(t,e,n,i){t.addEventListener(e,n,i===!0)}:document.attachEvent?function(t,e,n){t.attachEvent("on"+e,n)}:void 0}(),g=function(){return document.removeEventListener?function(t,e,n,i){t.removeEventListener(e,n,i===!0)}:document.detachEvent?function(t,e,n){t.detachEvent("on"+e,n)}:void 0}(),v=function(){var t,e,n=!1,i={animation:"animationend",OAnimation:"oAnimationEnd oanimationend",msAnimation:"MSAnimationEnd",MozAnimation:"animationend",WebkitAnimation:"webkitAnimationEnd"};for(t in i)if(void 0!==document.documentElement.style[t]){e=i[t],n=!0;break}return{type:e,supported:n}}(),y=function(){function e(t){if(!t.__internal){delete t.__init,t.__settings||(t.__settings=l(t.settings)),null===Pt&&document.body.setAttribute("tabindex","0");var e;"function"==typeof t.setup?(e=t.setup(),e.options=e.options||{},e.focus=e.focus||{}):e={buttons:[],focus:{element:null,select:!1},options:{}},"object"!=typeof t.hooks&&(t.hooks={});var i=[];if(Array.isArray(e.buttons))for(var o=0;o<e.buttons.length;o+=1){var s=e.buttons[o],r={};for(var a in s)s.hasOwnProperty(a)&&(r[a]=s[a]);i.push(r)}var u=t.__internal={isOpen:!1,activeElement:document.body,timerIn:void 0,timerOut:void 0,buttons:i,focus:e.focus,options:{title:void 0,modal:void 0,basic:void 0,frameless:void 0,pinned:void 0,movable:void 0,moveBounded:void 0,resizable:void 0,autoReset:void 0,closable:void 0,closableByDimmer:void 0,maximizable:void 0,startMaximized:void 0,pinnable:void 0,transition:void 0,padding:void 0,overflow:void 0,onshow:void 0,onclose:void 0,onfocus:void 0},resetHandler:void 0,beginMoveHandler:void 0,beginResizeHandler:void 0,bringToFrontHandler:void 0,modalClickHandler:void 0,buttonsClickHandler:void 0,commandsClickHandler:void 0,transitionInHandler:void 0,transitionOutHandler:void 0,destroy:void 0},c={};c.root=document.createElement("div"),c.root.className=Et.base+" "+Et.hidden+" ",c.root.innerHTML=Tt.dimmer+Tt.modal,c.dimmer=c.root.firstChild,c.modal=c.root.lastChild,c.modal.innerHTML=Tt.dialog,c.dialog=c.modal.firstChild,c.dialog.innerHTML=Tt.reset+Tt.commands+Tt.header+Tt.body+Tt.footer+Tt.resizeHandle+Tt.reset,c.reset=[],c.reset.push(c.dialog.firstChild),c.reset.push(c.dialog.lastChild),c.commands={},c.commands.container=c.reset[0].nextSibling,c.commands.pin=c.commands.container.firstChild,c.commands.maximize=c.commands.pin.nextSibling,c.commands.close=c.commands.maximize.nextSibling,c.header=c.commands.container.nextSibling,c.body=c.header.nextSibling,c.body.innerHTML=Tt.content,c.content=c.body.firstChild,c.footer=c.body.nextSibling,c.footer.innerHTML=Tt.buttons.auxiliary+Tt.buttons.primary,c.resizeHandle=c.footer.nextSibling,c.buttons={},c.buttons.auxiliary=c.footer.firstChild,c.buttons.primary=c.buttons.auxiliary.nextSibling,c.buttons.primary.innerHTML=Tt.button,c.buttonTemplate=c.buttons.primary.firstChild,c.buttons.primary.removeChild(c.buttonTemplate);for(var d=0;d<t.__internal.buttons.length;d+=1){var p=t.__internal.buttons[d];Lt.indexOf(p.key)<0&&Lt.push(p.key),p.element=c.buttonTemplate.cloneNode(),p.element.innerHTML=p.text,"string"==typeof p.className&&""!==p.className&&n(p.element,p.className);for(var f in p.attrs)"className"!==f&&p.attrs.hasOwnProperty(f)&&p.element.setAttribute(f,p.attrs[f]);"auxiliary"===p.scope?c.buttons.auxiliary.appendChild(p.element):c.buttons.primary.appendChild(p.element)}t.elements=c,u.resetHandler=h(t,q),u.beginMoveHandler=h(t,Q),u.beginResizeHandler=h(t,ot),u.bringToFrontHandler=h(t,T),u.modalClickHandler=h(t,H),u.buttonsClickHandler=h(t,W),u.commandsClickHandler=h(t,k),u.transitionInHandler=h(t,X),u.transitionOutHandler=h(t,J),t.set("title",void 0===e.options.title?x.defaults.glossary.title:e.options.title),t.set("modal",void 0===e.options.modal?x.defaults.modal:e.options.modal),t.set("basic",void 0===e.options.basic?x.defaults.basic:e.options.basic),t.set("frameless",void 0===e.options.frameless?x.defaults.frameless:e.options.frameless),t.set("movable",void 0===e.options.movable?x.defaults.movable:e.options.movable),t.set("moveBounded",void 0===e.options.moveBounded?x.defaults.moveBounded:e.options.moveBounded),t.set("resizable",void 0===e.options.resizable?x.defaults.resizable:e.options.resizable),t.set("autoReset",void 0===e.options.autoReset?x.defaults.autoReset:e.options.autoReset),t.set("closable",void 0===e.options.closable?x.defaults.closable:e.options.closable),t.set("closableByDimmer",void 0===e.options.closableByDimmer?x.defaults.closableByDimmer:e.options.closableByDimmer),t.set("maximizable",void 0===e.options.maximizable?x.defaults.maximizable:e.options.maximizable),t.set("startMaximized",void 0===e.options.startMaximized?x.defaults.startMaximized:e.options.startMaximized),t.set("pinnable",void 0===e.options.pinnable?x.defaults.pinnable:e.options.pinnable),t.set("pinned",void 0===e.options.pinned?x.defaults.pinned:e.options.pinned),t.set("transition",void 0===e.options.transition?x.defaults.transition:e.options.transition),t.set("padding",void 0===e.options.padding?x.defaults.padding:e.options.padding),t.set("overflow",void 0===e.options.overflow?x.defaults.overflow:e.options.overflow),"function"==typeof t.build&&t.build()}document.body.appendChild(t.elements.root)}function d(){bt=r(),xt=s()}function f(){t.scrollTo(bt,xt)}function y(){for(var t=0,e=0;e<m.length;e+=1){var o=m[e];(o.isModal()||o.isMaximized())&&(t+=1)}0===t?i(document.body,Et.noOverflow):t>0&&document.body.className.indexOf(Et.noOverflow)<0&&n(document.body,Et.noOverflow)}function b(t,e,o){"string"==typeof o&&i(t.elements.root,Et.prefix+o),n(t.elements.root,Et.prefix+e),Pt=t.elements.root.offsetWidth}function L(t){t.get("modal")?(i(t.elements.root,Et.modeless),t.isOpen()&&(pt(t),N(t),y())):(n(t.elements.root,Et.modeless),t.isOpen()&&(dt(t),N(t),y()))}function P(t){t.get("basic")?n(t.elements.root,Et.basic):i(t.elements.root,Et.basic)}function w(t){t.get("frameless")?n(t.elements.root,Et.frameless):i(t.elements.root,Et.frameless)}function T(t,e){for(var n=m.indexOf(e),i=n+1;i<m.length;i+=1)if(m[i].isModal())return;return document.body.lastChild!==e.elements.root&&(document.body.appendChild(e.elements.root),m.splice(m.indexOf(e),1),m.push(e),V(e)),!1}function E(t,e,o,s){switch(e){case"title":t.setHeader(s);break;case"modal":L(t);break;case"basic":P(t);break;case"frameless":w(t);break;case"pinned":j(t);break;case"closable":R(t);break;case"maximizable":U(t);break;case"pinnable":I(t);break;case"movable":nt(t);break;case"resizable":lt(t);break;case"transition":b(t,s,o);break;case"padding":s?i(t.elements.root,Et.noPadding):t.elements.root.className.indexOf(Et.noPadding)<0&&n(t.elements.root,Et.noPadding);break;case"overflow":s?i(t.elements.root,Et.noOverflow):t.elements.root.className.indexOf(Et.noOverflow)<0&&n(t.elements.root,Et.noOverflow);break;case"transition":b(t,s,o)}"function"==typeof t.hooks.onupdate&&t.hooks.onupdate.call(t,e,o,s)}function C(t,e,n,i,o){var s={op:void 0,items:[]};if("undefined"==typeof o&&"string"==typeof i)s.op="get",e.hasOwnProperty(i)?(s.found=!0,s.value=e[i]):(s.found=!1,s.value=void 0);else{var r;if(s.op="set","object"==typeof i){var a=i;for(var l in a)e.hasOwnProperty(l)?(e[l]!==a[l]&&(r=e[l],e[l]=a[l],n.call(t,l,r,a[l])),s.items.push({key:l,value:a[l],found:!0})):s.items.push({key:l,value:a[l],found:!1})}else{if("string"!=typeof i)throw new Error("args must be a string or object");e.hasOwnProperty(i)?(e[i]!==o&&(r=e[i],e[i]=o,n.call(t,i,r,o)),s.items.push({key:i,value:o,found:!0})):s.items.push({key:i,value:o,found:!1})}}return s}function M(t){var e;Z(t,function(t){return e=t.invokeOnClose===!0}),!e&&t.isOpen()&&t.close()}function k(t,e){var n=t.srcElement||t.target;switch(n){case e.elements.commands.pin:e.isPinned()?O(e):S(e);break;case e.elements.commands.maximize:e.isMaximized()?A(e):D(e);break;case e.elements.commands.close:M(e)}return!1}function S(t){t.set("pinned",!0)}function O(t){t.set("pinned",!1)}function D(t){n(t.elements.root,Et.maximized),t.isOpen()&&y()}function A(t){i(t.elements.root,Et.maximized),t.isOpen()&&y()}function I(t){t.get("pinnable")?n(t.elements.root,Et.pinnable):i(t.elements.root,Et.pinnable)}function z(t){var e=r();t.elements.modal.style.marginTop=s()+"px",t.elements.modal.style.marginLeft=e+"px",t.elements.modal.style.marginRight=-e+"px"}function B(t){var e=parseInt(t.elements.modal.style.marginTop,10),n=parseInt(t.elements.modal.style.marginLeft,10);if(t.elements.modal.style.marginTop="",t.elements.modal.style.marginLeft="",t.elements.modal.style.marginRight="",t.isOpen()){var i=0,o=0;""!==t.elements.dialog.style.top&&(i=parseInt(t.elements.dialog.style.top,10)),t.elements.dialog.style.top=i+(e-s())+"px",""!==t.elements.dialog.style.left&&(o=parseInt(t.elements.dialog.style.left,10)),t.elements.dialog.style.left=o+(n-r())+"px"}}function N(t){t.get("modal")||t.get("pinned")?B(t):z(t)}function j(t){t.get("pinned")?(i(t.elements.root,Et.unpinned),t.isOpen()&&B(t)):(n(t.elements.root,Et.unpinned),t.isOpen()&&!t.isModal()&&z(t))}function U(t){t.get("maximizable")?n(t.elements.root,Et.maximizable):i(t.elements.root,Et.maximizable)}function R(t){t.get("closable")?(n(t.elements.root,Et.closable),vt(t)):(i(t.elements.root,Et.closable),yt(t))}function H(t,e){var n=t.srcElement||t.target;return Ct||n!==e.elements.modal||e.get("closableByDimmer")!==!0||M(e),Ct=!1,!1}function Z(t,e){for(var n=0;n<t.__internal.buttons.length;n+=1){var i=t.__internal.buttons[n];if(!i.element.disabled&&e(i)){var o=c(n,i);"function"==typeof t.callback&&t.callback.apply(t,[o]),o.cancel===!1&&t.close();break}}}function W(t,e){var n=t.srcElement||t.target;Z(e,function(t){return t.element===n&&(Mt=!0)})}function F(t){if(Mt)return void(Mt=!1);var e=m[m.length-1],n=t.keyCode;return 0===e.__internal.buttons.length&&n===p.ESC&&e.get("closable")===!0?(M(e),!1):Lt.indexOf(n)>-1?(Z(e,function(t){return t.key===n}),!1):void 0}function G(t){var e=m[m.length-1],n=t.keyCode;if(n===p.LEFT||n===p.RIGHT){for(var i=e.__internal.buttons,o=0;o<i.length;o+=1)if(document.activeElement===i[o].element)switch(n){case p.LEFT:return void i[(o||i.length)-1].element.focus();case p.RIGHT:return void i[(o+1)%i.length].element.focus()}}else if(n<p.F12+1&&n>p.F1-1&&Lt.indexOf(n)>-1)return t.preventDefault(),t.stopPropagation(),Z(e,function(t){return t.key===n}),!1}function V(t,e){if(e)e.focus();else{var n=t.__internal.focus,i=n.element;switch(typeof n.element){case"number":t.__internal.buttons.length>n.element&&(i=t.get("basic")===!0?t.elements.reset[0]:t.__internal.buttons[n.element].element);break;case"string":i=t.elements.body.querySelector(n.element);break;case"function":i=n.element.call(t)}"undefined"!=typeof i&&null!==i||0!==t.__internal.buttons.length||(i=t.elements.reset[0]),i&&i.focus&&(i.focus(),n.select&&i.select&&i.select())}}function q(t,e){if(!e)for(var n=m.length-1;n>-1;n-=1)if(m[n].isModal()){e=m[n];break}if(e&&e.isModal()){var i,o=t.srcElement||t.target,s=o===e.elements.reset[1]||0===e.__internal.buttons.length&&o===document.body;s&&(e.get("maximizable")?i=e.elements.commands.maximize:e.get("closable")&&(i=e.elements.commands.close)),void 0===i&&("number"==typeof e.__internal.focus.element?o===e.elements.reset[0]?i=e.elements.buttons.auxiliary.firstChild||e.elements.buttons.primary.firstChild:s&&(i=e.elements.reset[0]):o===e.elements.reset[0]&&(i=e.elements.buttons.primary.lastChild||e.elements.buttons.auxiliary.lastChild)),V(e,i)}}function X(t,e){clearTimeout(e.__internal.timerIn),V(e),f(),Mt=!1,"function"==typeof e.get("onfocus")&&e.get("onfocus").call(e),g(e.elements.dialog,v.type,e.__internal.transitionInHandler),i(e.elements.root,Et.animationIn)}function J(t,e){clearTimeout(e.__internal.timerOut),g(e.elements.dialog,v.type,e.__internal.transitionOutHandler),et(e),at(e),e.isMaximized()&&!e.get("startMaximized")&&A(e),x.defaults.maintainFocus&&e.__internal.activeElement&&(e.__internal.activeElement.focus(),e.__internal.activeElement=null),"function"==typeof e.__internal.destroy&&e.__internal.destroy.apply(e)}function Y(t,e){var n=t[Dt]-St,i=t[At]-Ot;zt&&(i-=document.body.scrollTop),e.style.left=n+"px",e.style.top=i+"px"}function K(t,e){var n=t[Dt]-St,i=t[At]-Ot;zt&&(i-=document.body.scrollTop),e.style.left=Math.min(It.maxLeft,Math.max(It.minLeft,n))+"px",zt?e.style.top=Math.min(It.maxTop,Math.max(It.minTop,i))+"px":e.style.top=Math.max(It.minTop,i)+"px"}function Q(t,e){if(null===Nt&&!e.isMaximized()&&e.get("movable")){var i,o=0,s=0;if("touchstart"===t.type?(t.preventDefault(),i=t.targetTouches[0],Dt="clientX",At="clientY"):0===t.button&&(i=t),i){var r=e.elements.dialog;if(n(r,Et.capture),r.style.left&&(o=parseInt(r.style.left,10)),r.style.top&&(s=parseInt(r.style.top,10)),St=i[Dt]-o,Ot=i[At]-s,e.isModal()?Ot+=e.elements.modal.scrollTop:e.isPinned()&&(Ot-=document.body.scrollTop),e.get("moveBounded")){var a=r,l=-o,u=-s;do l+=a.offsetLeft,u+=a.offsetTop;while(a=a.offsetParent);It={maxLeft:l,minLeft:-l,maxTop:document.documentElement.clientHeight-r.clientHeight-u,minTop:-u},Bt=K}else It=null,Bt=Y;return zt=!e.isModal()&&e.isPinned(),kt=e,Bt(i,r),n(document.body,Et.noSelection),!1}}}function $(t){if(kt){var e;"touchmove"===t.type?(t.preventDefault(),e=t.targetTouches[0]):0===t.button&&(e=t),e&&Bt(e,kt.elements.dialog)}}function tt(){if(kt){var t=kt.elements.dialog;kt=It=null,i(document.body,Et.noSelection),i(t,Et.capture)}}function et(t){kt=null;var e=t.elements.dialog;e.style.left=e.style.top=""}function nt(t){t.get("movable")?(n(t.elements.root,Et.movable),t.isOpen()&&ft(t)):(et(t),i(t.elements.root,Et.movable),t.isOpen()&&mt(t))}function it(t,e,n){var i=e,s=0,r=0;do s+=i.offsetLeft,r+=i.offsetTop;while(i=i.offsetParent);var a,l;n===!0?(a=t.pageX,l=t.pageY):(a=t.clientX,l=t.clientY);var u=o();if(u&&(a=document.body.offsetWidth-a,isNaN(jt)||(s=document.body.offsetWidth-s-e.offsetWidth)),e.style.height=l-r+Ht+"px",e.style.width=a-s+Ht+"px",!isNaN(jt)){var h=.5*Math.abs(e.offsetWidth-Ut);u&&(h*=-1),e.offsetWidth>Ut?e.style.left=jt+h+"px":e.offsetWidth>=Rt&&(e.style.left=jt-h+"px")}}function ot(t,e){if(!e.isMaximized()){var i;if("touchstart"===t.type?(t.preventDefault(),i=t.targetTouches[0]):0===t.button&&(i=t),i){Nt=e,Ht=e.elements.resizeHandle.offsetHeight/2;var o=e.elements.dialog;return n(o,Et.capture),jt=parseInt(o.style.left,10),o.style.height=o.offsetHeight+"px",o.style.minHeight=e.elements.header.offsetHeight+e.elements.footer.offsetHeight+"px",o.style.width=(Ut=o.offsetWidth)+"px","none"!==o.style.maxWidth&&(o.style.minWidth=(Rt=o.offsetWidth)+"px"),o.style.maxWidth="none",n(document.body,Et.noSelection),!1}}}function st(t){if(Nt){var e;"touchmove"===t.type?(t.preventDefault(),e=t.targetTouches[0]):0===t.button&&(e=t),e&&it(e,Nt.elements.dialog,!Nt.get("modal")&&!Nt.get("pinned"))}}function rt(){if(Nt){var t=Nt.elements.dialog;Nt=null,i(document.body,Et.noSelection),i(t,Et.capture),Ct=!0}}function at(t){Nt=null;var e=t.elements.dialog;"none"===e.style.maxWidth&&(e.style.maxWidth=e.style.minWidth=e.style.width=e.style.height=e.style.minHeight=e.style.left="",jt=Number.Nan,Ut=Rt=Ht=0)}function lt(t){t.get("resizable")?(n(t.elements.root,Et.resizable),t.isOpen()&&_t(t)):(at(t),i(t.elements.root,Et.resizable),t.isOpen()&&gt(t))}function ut(){for(var t=0;t<m.length;t+=1){var e=m[t];e.get("autoReset")&&(et(e),at(e))}}function ht(e){1===m.length&&(_(t,"resize",ut),_(document.body,"keyup",F),_(document.body,"keydown",G),_(document.body,"focus",q),_(document.documentElement,"mousemove",$),_(document.documentElement,"touchmove",$),_(document.documentElement,"mouseup",tt),_(document.documentElement,"touchend",tt),_(document.documentElement,"mousemove",st),_(document.documentElement,"touchmove",st),_(document.documentElement,"mouseup",rt),_(document.documentElement,"touchend",rt)),_(e.elements.commands.container,"click",e.__internal.commandsClickHandler),_(e.elements.footer,"click",e.__internal.buttonsClickHandler),_(e.elements.reset[0],"focus",e.__internal.resetHandler),_(e.elements.reset[1],"focus",e.__internal.resetHandler),Mt=!0,_(e.elements.dialog,v.type,e.__internal.transitionInHandler),e.get("modal")||dt(e),e.get("resizable")&&_t(e),e.get("movable")&&ft(e)}function ct(e){1===m.length&&(g(t,"resize",ut),g(document.body,"keyup",F),g(document.body,"keydown",G),g(document.body,"focus",q),g(document.documentElement,"mousemove",$),g(document.documentElement,"mouseup",tt),g(document.documentElement,"mousemove",st),g(document.documentElement,"mouseup",rt)),g(e.elements.commands.container,"click",e.__internal.commandsClickHandler),g(e.elements.footer,"click",e.__internal.buttonsClickHandler),g(e.elements.reset[0],"focus",e.__internal.resetHandler),g(e.elements.reset[1],"focus",e.__internal.resetHandler),_(e.elements.dialog,v.type,e.__internal.transitionOutHandler),e.get("modal")||pt(e),e.get("movable")&&mt(e),e.get("resizable")&&gt(e)}function dt(t){_(t.elements.dialog,"focus",t.__internal.bringToFrontHandler,!0)}function pt(t){g(t.elements.dialog,"focus",t.__internal.bringToFrontHandler,!0)}function ft(t){_(t.elements.header,"mousedown",t.__internal.beginMoveHandler),_(t.elements.header,"touchstart",t.__internal.beginMoveHandler)}function mt(t){g(t.elements.header,"mousedown",t.__internal.beginMoveHandler),g(t.elements.header,"touchstart",t.__internal.beginMoveHandler)}function _t(t){_(t.elements.resizeHandle,"mousedown",t.__internal.beginResizeHandler),_(t.elements.resizeHandle,"touchstart",t.__internal.beginResizeHandler)}function gt(t){g(t.elements.resizeHandle,"mousedown",t.__internal.beginResizeHandler),g(t.elements.resizeHandle,"touchstart",t.__internal.beginResizeHandler)}function vt(t){_(t.elements.modal,"click",t.__internal.modalClickHandler)}function yt(t){g(t.elements.modal,"click",t.__internal.modalClickHandler)}var bt,xt,Lt=[],Pt=null,wt=t.navigator.userAgent.indexOf("Safari")>-1&&t.navigator.userAgent.indexOf("Chrome")<0,Tt={dimmer:'<div class="ajs-dimmer"></div>',modal:'<div class="ajs-modal" tabindex="0"></div>',dialog:'<div class="ajs-dialog" tabindex="0"></div>',reset:'<button class="ajs-reset"></button>',commands:'<div class="ajs-commands"><button class="ajs-pin"></button><button class="ajs-maximize"></button><button class="ajs-close"></button></div>',header:'<div class="ajs-header"></div>',body:'<div class="ajs-body"></div>',content:'<div class="ajs-content"></div>',footer:'<div class="ajs-footer"></div>',buttons:{primary:'<div class="ajs-primary ajs-buttons"></div>',auxiliary:'<div class="ajs-auxiliary ajs-buttons"></div>'},button:'<button class="ajs-button"></button>',resizeHandle:'<div class="ajs-handle"></div>'},Et={base:"alertify",prefix:"ajs-",hidden:"ajs-hidden",noSelection:"ajs-no-selection",noOverflow:"ajs-no-overflow",noPadding:"ajs-no-padding",modeless:"ajs-modeless",movable:"ajs-movable",resizable:"ajs-resizable",capture:"ajs-capture",fixed:"ajs-fixed",closable:"ajs-closable",maximizable:"ajs-maximizable",maximize:"ajs-maximize",restore:"ajs-restore",pinnable:"ajs-pinnable",unpinned:"ajs-unpinned",pin:"ajs-pin",maximized:"ajs-maximized",animationIn:"ajs-in",animationOut:"ajs-out",shake:"ajs-shake",basic:"ajs-basic",frameless:"ajs-frameless"},Ct=!1,Mt=!1,kt=null,St=0,Ot=0,Dt="pageX",At="pageY",It=null,zt=!1,Bt=null,Nt=null,jt=Number.Nan,Ut=0,Rt=0,Ht=0;return{__init:e,isOpen:function(){return this.__internal.isOpen},isModal:function(){return this.elements.root.className.indexOf(Et.modeless)<0},isMaximized:function(){return this.elements.root.className.indexOf(Et.maximized)>-1},isPinned:function(){return this.elements.root.className.indexOf(Et.unpinned)<0},maximize:function(){return this.isMaximized()||D(this),this},restore:function(){return this.isMaximized()&&A(this),this},pin:function(){return this.isPinned()||S(this),this},unpin:function(){return this.isPinned()&&O(this),this},bringToFront:function(){return T(null,this),this},moveTo:function(t,e){if(!isNaN(t)&&!isNaN(e)){var n=this.elements.dialog,i=n,s=0,r=0;n.style.left&&(s-=parseInt(n.style.left,10)),n.style.top&&(r-=parseInt(n.style.top,10));do s+=i.offsetLeft,r+=i.offsetTop;while(i=i.offsetParent);var a=t-s,l=e-r;o()&&(a*=-1),n.style.left=a+"px",n.style.top=l+"px"}return this},resizeTo:function(t,e){var n=parseFloat(t),i=parseFloat(e),o=/(\d*\.\d+|\d+)%/;if(!isNaN(n)&&!isNaN(i)&&this.get("resizable")===!0){(""+t).match(o)&&(n=n/100*document.documentElement.clientWidth),(""+e).match(o)&&(i=i/100*document.documentElement.clientHeight);var s=this.elements.dialog;"none"!==s.style.maxWidth&&(s.style.minWidth=(Rt=s.offsetWidth)+"px"),s.style.maxWidth="none",s.style.minHeight=this.elements.header.offsetHeight+this.elements.footer.offsetHeight+"px",s.style.width=n+"px",s.style.height=i+"px"}return this},setting:function(t,e){var n=this,i=C(this,this.__internal.options,function(t,e,i){E(n,t,e,i)},t,e);if("get"===i.op)return i.found?i.value:"undefined"!=typeof this.settings?C(this,this.settings,this.settingUpdated||function(){},t,e).value:void 0;if("set"===i.op){if(i.items.length>0)for(var o=this.settingUpdated||function(){},s=0;s<i.items.length;s+=1){var r=i.items[s];r.found||"undefined"==typeof this.settings||C(this,this.settings,o,r.key,r.value)}return this}},set:function(t,e){return this.setting(t,e),this},get:function(t){return this.setting(t)},setHeader:function(e){return"string"==typeof e?(a(this.elements.header),this.elements.header.innerHTML=e):e instanceof t.HTMLElement&&this.elements.header.firstChild!==e&&(a(this.elements.header),this.elements.header.appendChild(e)),this},setContent:function(e){return"string"==typeof e?(a(this.elements.content),this.elements.content.innerHTML=e):e instanceof t.HTMLElement&&this.elements.content.firstChild!==e&&(a(this.elements.content),this.elements.content.appendChild(e)),this},showModal:function(t){return this.show(!0,t)},show:function(t,o){if(e(this),this.__internal.isOpen){et(this),at(this),n(this.elements.dialog,Et.shake);var s=this;setTimeout(function(){i(s.elements.dialog,Et.shake)},200)}else{if(this.__internal.isOpen=!0,m.push(this),x.defaults.maintainFocus&&(this.__internal.activeElement=document.activeElement),"function"==typeof this.prepare&&this.prepare(),ht(this),void 0!==t&&this.set("modal",t),d(),y(),"string"==typeof o&&""!==o&&(this.__internal.className=o,n(this.elements.root,o)),this.get("startMaximized")?this.maximize():this.isMaximized()&&A(this),N(this),i(this.elements.root,Et.animationOut),n(this.elements.root,Et.animationIn),clearTimeout(this.__internal.timerIn),this.__internal.timerIn=setTimeout(this.__internal.transitionInHandler,v.supported?1e3:100),wt){var r=this.elements.root;r.style.display="none",setTimeout(function(){r.style.display="block"},0)}Pt=this.elements.root.offsetWidth,i(this.elements.root,Et.hidden),"function"==typeof this.hooks.onshow&&this.hooks.onshow.call(this),"function"==typeof this.get("onshow")&&this.get("onshow").call(this)}return this},close:function(){return this.__internal.isOpen&&(ct(this),i(this.elements.root,Et.animationIn),n(this.elements.root,Et.animationOut),clearTimeout(this.__internal.timerOut),this.__internal.timerOut=setTimeout(this.__internal.transitionOutHandler,v.supported?1e3:100),n(this.elements.root,Et.hidden),Pt=this.elements.modal.offsetWidth,"undefined"!=typeof this.__internal.className&&""!==this.__internal.className&&i(this.elements.root,this.__internal.className),"function"==typeof this.hooks.onclose&&this.hooks.onclose.call(this),"function"==typeof this.get("onclose")&&this.get("onclose").call(this),m.splice(m.indexOf(this),1),this.__internal.isOpen=!1,y()),this},closeOthers:function(){return x.closeAll(this),this},destroy:function(){return this.__internal.isOpen?(this.__internal.destroy=function(){u(this,e)},this.close()):u(this,e),this}}}(),b=function(){function e(t){t.__internal||(t.__internal={position:x.defaults.notifier.position,delay:x.defaults.notifier.delay},c=document.createElement("DIV"),r(t)),c.parentNode!==document.body&&document.body.appendChild(c)}function o(t){t.__internal.pushed=!0,d.push(t)}function s(t){d.splice(d.indexOf(t),1),t.__internal.pushed=!1}function r(t){switch(c.className=p.base,t.__internal.position){case"top-right":n(c,p.top+" "+p.right);break;case"top-left":n(c,p.top+" "+p.left);break;case"bottom-left":n(c,p.bottom+" "+p.left);break;default:case"bottom-right":n(c,p.bottom+" "+p.right)}}function l(e,r){function l(t,e){e.dismiss(!0)}function d(t,e){g(e.element,v.type,d),c.removeChild(e.element)}function f(t){return t.__internal||(t.__internal={pushed:!1,delay:void 0,timer:void 0,clickHandler:void 0,transitionEndHandler:void 0,transitionTimeout:void 0},t.__internal.clickHandler=h(t,l),t.__internal.transitionEndHandler=h(t,d)),t}function m(t){clearTimeout(t.__internal.timer),clearTimeout(t.__internal.transitionTimeout)}return f({element:e,push:function(t,e){if(!this.__internal.pushed){o(this),m(this);var i,s;switch(arguments.length){case 0:s=this.__internal.delay;break;case 1:"number"==typeof t?s=t:(i=t,s=this.__internal.delay);break;case 2:i=t,s=e}return"undefined"!=typeof i&&this.setContent(i),b.__internal.position.indexOf("top")<0?c.appendChild(this.element):c.insertBefore(this.element,c.firstChild),u=this.element.offsetWidth,n(this.element,p.visible),_(this.element,"click",this.__internal.clickHandler),this.delay(s)}return this},ondismiss:function(){},callback:r,dismiss:function(t){return this.__internal.pushed&&(m(this),("function"!=typeof this.ondismiss||this.ondismiss.call(this)!==!1)&&(g(this.element,"click",this.__internal.clickHandler),"undefined"!=typeof this.element&&this.element.parentNode===c&&(this.__internal.transitionTimeout=setTimeout(this.__internal.transitionEndHandler,v.supported?1e3:100),i(this.element,p.visible),"function"==typeof this.callback&&this.callback.call(this,t)),s(this))),this},delay:function(t){if(m(this),this.__internal.delay="undefined"==typeof t||isNaN(+t)?b.__internal.delay:+t,this.__internal.delay>0){var e=this;this.__internal.timer=setTimeout(function(){e.dismiss()},1e3*this.__internal.delay)}return this},setContent:function(e){return"string"==typeof e?(a(this.element),this.element.innerHTML=e):e instanceof t.HTMLElement&&this.element.firstChild!==e&&(a(this.element),this.element.appendChild(e)),this},dismissOthers:function(){return b.dismissAll(this),this}})}var u,c,d=[],p={base:"alertify-notifier",message:"ajs-message",top:"ajs-top",right:"ajs-right",bottom:"ajs-bottom",left:"ajs-left",visible:"ajs-visible",hidden:"ajs-hidden"};return{setting:function(t,n){if(e(this),"undefined"==typeof n)return this.__internal[t];switch(t){case"position":this.__internal.position=n,r(this);break;case"delay":this.__internal.delay=n}return this},set:function(t,e){return this.setting(t,e),this},get:function(t){return this.setting(t)},create:function(t,n){e(this);var i=document.createElement("div");return i.className=p.message+("string"==typeof t&&""!==t?" ajs-"+t:""),l(i,n)},dismissAll:function(t){for(var e=d.slice(0),n=0;n<e.length;n+=1){var i=e[n];(void 0===t||t!==i)&&i.dismiss()}}}}(),x=new d;x.dialog("alert",function(){return{main:function(t,e,n){var i,o,s;switch(arguments.length){case 1:o=t;break;case 2:"function"==typeof e?(o=t,s=e):(i=t,o=e);break;case 3:i=t,o=e,s=n}return this.set("title",i),this.set("message",o),this.set("onok",s),this},setup:function(){return{buttons:[{text:x.defaults.glossary.ok,key:p.ESC,invokeOnClose:!0,className:x.defaults.theme.ok}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},build:function(){},prepare:function(){},setMessage:function(t){this.setContent(t)},settings:{message:void 0,onok:void 0,label:void 0},settingUpdated:function(t,e,n){switch(t){case"message":this.setMessage(n);break;case"label":this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=n)}},callback:function(t){if("function"==typeof this.get("onok")){var e=this.get("onok").call(this,t);"undefined"!=typeof e&&(t.cancel=!e)}}}}),x.dialog("confirm",function(){function t(t){null!==n.timer&&(clearInterval(n.timer),n.timer=null,t.__internal.buttons[n.index].element.innerHTML=n.text)}function e(e,i,o){t(e),n.duration=o,n.index=i,n.text=e.__internal.buttons[i].element.innerHTML,n.timer=setInterval(h(e,n.task),1e3),n.task(null,e)}var n={timer:null,index:null,
text:null,duration:null,task:function(e,i){if(i.isOpen()){if(i.__internal.buttons[n.index].element.innerHTML=n.text+" (&#8207;"+n.duration+"&#8207;) ",n.duration-=1,-1===n.duration){t(i);var o=i.__internal.buttons[n.index],s=c(n.index,o);"function"==typeof i.callback&&i.callback.apply(i,[s]),s.close!==!1&&i.close()}}else t(i)}};return{main:function(t,e,n,i){var o,s,r,a;switch(arguments.length){case 1:s=t;break;case 2:s=t,r=e;break;case 3:s=t,r=e,a=n;break;case 4:o=t,s=e,r=n,a=i}return this.set("title",o),this.set("message",s),this.set("onok",r),this.set("oncancel",a),this},setup:function(){return{buttons:[{text:x.defaults.glossary.ok,key:p.ENTER,className:x.defaults.theme.ok},{text:x.defaults.glossary.cancel,key:p.ESC,invokeOnClose:!0,className:x.defaults.theme.cancel}],focus:{element:0,select:!1},options:{maximizable:!1,resizable:!1}}},build:function(){},prepare:function(){},setMessage:function(t){this.setContent(t)},settings:{message:null,labels:null,onok:null,oncancel:null,defaultFocus:null,reverseButtons:null},settingUpdated:function(t,e,n){switch(t){case"message":this.setMessage(n);break;case"labels":"ok"in n&&this.__internal.buttons[0].element&&(this.__internal.buttons[0].text=n.ok,this.__internal.buttons[0].element.innerHTML=n.ok),"cancel"in n&&this.__internal.buttons[1].element&&(this.__internal.buttons[1].text=n.cancel,this.__internal.buttons[1].element.innerHTML=n.cancel);break;case"reverseButtons":n===!0?this.elements.buttons.primary.appendChild(this.__internal.buttons[0].element):this.elements.buttons.primary.appendChild(this.__internal.buttons[1].element);break;case"defaultFocus":this.__internal.focus.element="ok"===n?0:1}},callback:function(e){t(this);var n;switch(e.index){case 0:"function"==typeof this.get("onok")&&(n=this.get("onok").call(this,e),"undefined"!=typeof n&&(e.cancel=!n));break;case 1:"function"==typeof this.get("oncancel")&&(n=this.get("oncancel").call(this,e),"undefined"!=typeof n&&(e.cancel=!n))}},autoOk:function(t){return e(this,0,t),this},autoCancel:function(t){return e(this,1,t),this}}}),x.dialog("prompt",function(){var e=document.createElement("INPUT"),n=document.createElement("P");return{main:function(t,e,n,i,o){var s,r,a,l,u;switch(arguments.length){case 1:r=t;break;case 2:r=t,a=e;break;case 3:r=t,a=e,l=n;break;case 4:r=t,a=e,l=n,u=i;break;case 5:s=t,r=e,a=n,l=i,u=o}return this.set("title",s),this.set("message",r),this.set("value",a),this.set("onok",l),this.set("oncancel",u),this},setup:function(){return{buttons:[{text:x.defaults.glossary.ok,key:p.ENTER,className:x.defaults.theme.ok},{text:x.defaults.glossary.cancel,key:p.ESC,invokeOnClose:!0,className:x.defaults.theme.cancel}],focus:{element:e,select:!0},options:{maximizable:!1,resizable:!1}}},build:function(){e.className=x.defaults.theme.input,e.setAttribute("type","text"),e.value=this.get("value"),this.elements.content.appendChild(n),this.elements.content.appendChild(e)},prepare:function(){},setMessage:function(e){"string"==typeof e?(a(n),n.innerHTML=e):e instanceof t.HTMLElement&&n.firstChild!==e&&(a(n),n.appendChild(e))},settings:{message:void 0,labels:void 0,onok:void 0,oncancel:void 0,value:"",type:"text",reverseButtons:void 0},settingUpdated:function(t,n,i){switch(t){case"message":this.setMessage(i);break;case"value":e.value=i;break;case"type":switch(i){case"text":case"color":case"date":case"datetime-local":case"email":case"month":case"number":case"password":case"search":case"tel":case"time":case"week":e.type=i;break;default:e.type="text"}break;case"labels":i.ok&&this.__internal.buttons[0].element&&(this.__internal.buttons[0].element.innerHTML=i.ok),i.cancel&&this.__internal.buttons[1].element&&(this.__internal.buttons[1].element.innerHTML=i.cancel);break;case"reverseButtons":i===!0?this.elements.buttons.primary.appendChild(this.__internal.buttons[0].element):this.elements.buttons.primary.appendChild(this.__internal.buttons[1].element)}},callback:function(t){var n;switch(t.index){case 0:this.settings.value=e.value,"function"==typeof this.get("onok")&&(n=this.get("onok").call(this,t,this.settings.value),"undefined"!=typeof n&&(t.cancel=!n));break;case 1:"function"==typeof this.get("oncancel")&&(n=this.get("oncancel").call(this,t),"undefined"!=typeof n&&(t.cancel=!n))}}}}),"object"==typeof e&&"object"==typeof e.exports?e.exports=x:"function"==typeof define&&define.amd?define([],function(){return x}):t.alertify||(t.alertify=x)}("undefined"!=typeof window?window:this)},{}],2:[function(t,e,n){"document"in window.self&&("classList"in document.createElement("_")?!function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,i=arguments.length;for(n=0;i>n;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}():!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",i=t.Element[n],o=Object,s=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},r=Array[n].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},a=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},l=function(t,e){if(""===e)throw new a("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new a("INVALID_CHARACTER_ERR","String contains an invalid character");return r.call(t,e)},u=function(t){for(var e=s.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],i=0,o=n.length;o>i;i++)this.push(n[i]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},h=u[n]=[],c=function(){return new u(this)};if(a[n]=Error[n],h.item=function(t){return this[t]||null},h.contains=function(t){return t+="",-1!==l(this,t)},h.add=function(){var t,e=arguments,n=0,i=e.length,o=!1;do t=e[n]+"",-1===l(this,t)&&(this.push(t),o=!0);while(++n<i);o&&this._updateClassName()},h.remove=function(){var t,e,n=arguments,i=0,o=n.length,s=!1;do for(t=n[i]+"",e=l(this,t);-1!==e;)this.splice(e,1),s=!0,e=l(this,t);while(++i<o);s&&this._updateClassName()},h.toggle=function(t,e){t+="";var n=this.contains(t),i=n?e!==!0&&"remove":e!==!1&&"add";return i&&this[i](t),e===!0||e===!1?e:!n},h.toString=function(){return this.join(" ")},o.defineProperty){var d={get:c,enumerable:!0,configurable:!0};try{o.defineProperty(i,e,d)}catch(p){-2146823252===p.number&&(d.enumerable=!1,o.defineProperty(i,e,d))}}else o[n].__defineGetter__&&i.__defineGetter__(e,c)}}(window.self))},{}],3:[function(t,e,n){"use strict";var i,o=t("es5-ext/object/copy"),s=t("es5-ext/object/map"),r=t("es5-ext/object/valid-callable"),a=t("es5-ext/object/valid-value"),l=Function.prototype.bind,u=Object.defineProperty,h=Object.prototype.hasOwnProperty;i=function(t,e,n){var i,s=a(e)&&r(e.value);return i=o(e),delete i.writable,delete i.value,i.get=function(){return h.call(this,t)?s:(e.value=l.call(s,null==n?this:this[n]),u(this,t,e),this[t])},i},e.exports=function(t){var e=arguments[1];return s(t,function(t,n){return i(n,t,e)})}},{"es5-ext/object/copy":18,"es5-ext/object/map":26,"es5-ext/object/valid-callable":31,"es5-ext/object/valid-value":32}],4:[function(t,e,n){"use strict";var i,o=t("es5-ext/object/assign"),s=t("es5-ext/object/normalize-options"),r=t("es5-ext/object/is-callable"),a=t("es5-ext/string/#/contains");i=e.exports=function(t,e){var n,i,r,l,u;return arguments.length<2||"string"!=typeof t?(l=e,e=t,t=null):l=arguments[2],null==t?(n=r=!0,i=!1):(n=a.call(t,"c"),i=a.call(t,"e"),r=a.call(t,"w")),u={value:e,configurable:n,enumerable:i,writable:r},l?o(s(l),u):u},i.gs=function(t,e,n){var i,l,u,h;return"string"!=typeof t?(u=n,n=e,e=t,t=null):u=arguments[3],null==e?e=void 0:r(e)?null==n?n=void 0:r(n)||(u=n,n=void 0):(u=e,e=n=void 0),null==t?(i=!0,l=!1):(i=a.call(t,"c"),l=a.call(t,"e")),h={get:e,set:n,configurable:i,enumerable:l},u?o(s(u),h):h}},{"es5-ext/object/assign":15,"es5-ext/object/is-callable":21,"es5-ext/object/normalize-options":27,"es5-ext/string/#/contains":33}],5:[function(t,e,n){"use strict";var i=t("../../object/valid-value");e.exports=function(){return i(this).length=0,this}},{"../../object/valid-value":32}],6:[function(t,e,n){"use strict";var i=t("../../number/to-pos-integer"),o=t("../../object/valid-value"),s=Array.prototype.indexOf,r=Object.prototype.hasOwnProperty,a=Math.abs,l=Math.floor;e.exports=function(t){var e,n,u,h;if(t===t)return s.apply(this,arguments);for(n=i(o(this).length),u=arguments[1],u=isNaN(u)?0:u>=0?l(u):i(this.length)-l(a(u)),e=u;n>e;++e)if(r.call(this,e)&&(h=this[e],h!==h))return e;return-1}},{"../../number/to-pos-integer":13,"../../object/valid-value":32}],7:[function(t,e,n){"use strict";var i=Object.prototype.toString,o=i.call(function(){return arguments}());e.exports=function(t){return i.call(t)===o}},{}],8:[function(t,e,n){"use strict";e.exports=new Function("return this")()},{}],9:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?Math.sign:t("./shim")},{"./is-implemented":10,"./shim":11}],10:[function(t,e,n){"use strict";e.exports=function(){var t=Math.sign;return"function"!=typeof t?!1:1===t(10)&&-1===t(-20)}},{}],11:[function(t,e,n){"use strict";e.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:t>0?1:-1}},{}],12:[function(t,e,n){"use strict";var i=t("../math/sign"),o=Math.abs,s=Math.floor;e.exports=function(t){return isNaN(t)?0:(t=Number(t),0!==t&&isFinite(t)?i(t)*s(o(t)):t)}},{"../math/sign":9}],13:[function(t,e,n){"use strict";var i=t("./to-integer"),o=Math.max;e.exports=function(t){return o(0,i(t))}},{"./to-integer":12}],14:[function(t,e,n){"use strict";var i=t("./valid-callable"),o=t("./valid-value"),s=Function.prototype.bind,r=Function.prototype.call,a=Object.keys,l=Object.prototype.propertyIsEnumerable;e.exports=function(t,e){return function(n,u){var h,c=arguments[2],d=arguments[3];return n=Object(o(n)),i(u),h=a(n),d&&h.sort("function"==typeof d?s.call(d,n):void 0),"function"!=typeof t&&(t=h[t]),r.call(t,h,function(t,i){return l.call(n,t)?r.call(u,c,n[t],t,n,i):e})}}},{"./valid-callable":31,"./valid-value":32}],15:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?Object.assign:t("./shim")},{"./is-implemented":16,"./shim":17}],16:[function(t,e,n){"use strict";e.exports=function(){var t,e=Object.assign;return"function"!=typeof e?!1:(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},{}],17:[function(t,e,n){"use strict";var i=t("../keys"),o=t("../valid-value"),s=Math.max;e.exports=function(t,e){var n,r,a,l=s(arguments.length,2);for(t=Object(o(t)),a=function(i){try{t[i]=e[i]}catch(o){n||(n=o)}},r=1;l>r;++r)e=arguments[r],i(e).forEach(a);if(void 0!==n)throw n;return t}},{"../keys":23,"../valid-value":32}],18:[function(t,e,n){"use strict";var i=t("./assign"),o=t("./valid-value");e.exports=function(t){var e=Object(o(t));return e!==t?e:i({},t)}},{"./assign":15,"./valid-value":32}],19:[function(t,e,n){"use strict";var i,o=Object.create;t("./set-prototype-of/is-implemented")()||(i=t("./set-prototype-of/shim")),e.exports=function(){var t,e,n;return i?1!==i.level?o:(t={},e={},n={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(t){return"__proto__"===t?void(e[t]={configurable:!0,enumerable:!1,writable:!0,value:void 0}):void(e[t]=n)}),Object.defineProperties(t,e),Object.defineProperty(i,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:t}),function(e,n){return o(null===e?t:e,n)}):o}()},{"./set-prototype-of/is-implemented":29,"./set-prototype-of/shim":30}],20:[function(t,e,n){"use strict";e.exports=t("./_iterate")("forEach")},{"./_iterate":14}],21:[function(t,e,n){"use strict";e.exports=function(t){return"function"==typeof t}},{}],22:[function(t,e,n){"use strict";var i={"function":!0,object:!0};e.exports=function(t){return null!=t&&i[typeof t]||!1}},{}],23:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?Object.keys:t("./shim")},{"./is-implemented":24,"./shim":25}],24:[function(t,e,n){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},{}],25:[function(t,e,n){"use strict";var i=Object.keys;e.exports=function(t){return i(null==t?t:Object(t))}},{}],26:[function(t,e,n){"use strict";var i=t("./valid-callable"),o=t("./for-each"),s=Function.prototype.call;e.exports=function(t,e){var n={},r=arguments[2];return i(e),o(t,function(t,i,o,a){n[i]=s.call(e,r,t,i,o,a)}),n}},{"./for-each":20,"./valid-callable":31}],27:[function(t,e,n){"use strict";var i=Array.prototype.forEach,o=Object.create,s=function(t,e){var n;for(n in t)e[n]=t[n]};e.exports=function(t){var e=o(null);return i.call(arguments,function(t){null!=t&&s(Object(t),e)}),e}},{}],28:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?Object.setPrototypeOf:t("./shim")},{"./is-implemented":29,"./shim":30}],29:[function(t,e,n){"use strict";var i=Object.create,o=Object.getPrototypeOf,s={};e.exports=function(){var t=Object.setPrototypeOf,e=arguments[0]||i;return"function"!=typeof t?!1:o(t(e(null),s))===s}},{}],30:[function(t,e,n){"use strict";var i,o=t("../is-object"),s=t("../valid-value"),r=Object.prototype.isPrototypeOf,a=Object.defineProperty,l={configurable:!0,enumerable:!1,writable:!0,value:void 0};i=function(t,e){if(s(t),null===e||o(e))return t;throw new TypeError("Prototype must be null or an object")},e.exports=function(t){var e,n;return t?(2===t.level?t.set?(n=t.set,e=function(t,e){return n.call(i(t,e),e),t}):e=function(t,e){return i(t,e).__proto__=e,t}:e=function o(t,e){var n;return i(t,e),n=r.call(o.nullPolyfill,t),n&&delete o.nullPolyfill.__proto__,null===e&&(e=o.nullPolyfill),t.__proto__=e,n&&a(o.nullPolyfill,"__proto__",l),t},Object.defineProperty(e,"level",{configurable:!1,enumerable:!1,writable:!1,value:t.level})):null}(function(){var t,e=Object.create(null),n={},i=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(i){try{t=i.set,t.call(e,n)}catch(o){}if(Object.getPrototypeOf(e)===n)return{set:t,level:2}}return e.__proto__=n,Object.getPrototypeOf(e)===n?{level:2}:(e={},e.__proto__=n,Object.getPrototypeOf(e)===n?{level:1}:!1)}()),t("../create")},{"../create":19,"../is-object":22,"../valid-value":32}],31:[function(t,e,n){"use strict";e.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},{}],32:[function(t,e,n){"use strict";e.exports=function(t){if(null==t)throw new TypeError("Cannot use null or undefined");return t}},{}],33:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?String.prototype.contains:t("./shim")},{"./is-implemented":34,"./shim":35}],34:[function(t,e,n){"use strict";var i="razdwatrzy";e.exports=function(){return"function"!=typeof i.contains?!1:i.contains("dwa")===!0&&i.contains("foo")===!1}},{}],35:[function(t,e,n){"use strict";var i=String.prototype.indexOf;e.exports=function(t){return i.call(this,t,arguments[1])>-1}},{}],36:[function(t,e,n){"use strict";var i=Object.prototype.toString,o=i.call("");e.exports=function(t){return"string"==typeof t||t&&"object"==typeof t&&(t instanceof String||i.call(t)===o)||!1}},{}],37:[function(t,e,n){"use strict";var i,o=t("es5-ext/object/set-prototype-of"),s=t("es5-ext/string/#/contains"),r=t("d"),a=t("./"),l=Object.defineProperty;i=e.exports=function(t,e){return this instanceof i?(a.call(this,t),e=e?s.call(e,"key+value")?"key+value":s.call(e,"key")?"key":"value":"value",void l(this,"__kind__",r("",e))):new i(t,e)},o&&o(i,a),i.prototype=Object.create(a.prototype,{constructor:r(i),_resolve:r(function(t){return"value"===this.__kind__?this.__list__[t]:"key+value"===this.__kind__?[t,this.__list__[t]]:t}),toString:r(function(){return"[object Array Iterator]"})})},{"./":40,d:4,"es5-ext/object/set-prototype-of":28,"es5-ext/string/#/contains":33}],38:[function(t,e,n){"use strict";var i=t("es5-ext/function/is-arguments"),o=t("es5-ext/object/valid-callable"),s=t("es5-ext/string/is-string"),r=t("./get"),a=Array.isArray,l=Function.prototype.call,u=Array.prototype.some;e.exports=function(t,e){var n,h,c,d,p,f,m,_,g=arguments[2];if(a(t)||i(t)?n="array":s(t)?n="string":t=r(t),o(e),c=function(){d=!0},"array"===n)return void u.call(t,function(t){return l.call(e,g,t,c),d?!0:void 0});if("string"!==n)for(h=t.next();!h.done;){if(l.call(e,g,h.value,c),d)return;h=t.next()}else for(f=t.length,p=0;f>p&&(m=t[p],f>p+1&&(_=m.charCodeAt(0),_>=55296&&56319>=_&&(m+=t[++p])),l.call(e,g,m,c),!d);++p);}},{"./get":39,"es5-ext/function/is-arguments":7,"es5-ext/object/valid-callable":31,"es5-ext/string/is-string":36}],39:[function(t,e,n){"use strict";var i=t("es5-ext/function/is-arguments"),o=t("es5-ext/string/is-string"),s=t("./array"),r=t("./string"),a=t("./valid-iterable"),l=t("es6-symbol").iterator;e.exports=function(t){return"function"==typeof a(t)[l]?t[l]():i(t)?new s(t):o(t)?new r(t):new s(t)}},{"./array":37,"./string":42,"./valid-iterable":43,"es5-ext/function/is-arguments":7,"es5-ext/string/is-string":36,"es6-symbol":50}],40:[function(t,e,n){"use strict";var i,o=t("es5-ext/array/#/clear"),s=t("es5-ext/object/assign"),r=t("es5-ext/object/valid-callable"),a=t("es5-ext/object/valid-value"),l=t("d"),u=t("d/auto-bind"),h=t("es6-symbol"),c=Object.defineProperty,d=Object.defineProperties;e.exports=i=function(t,e){return this instanceof i?(d(this,{__list__:l("w",a(t)),__context__:l("w",e),__nextIndex__:l("w",0)}),void(e&&(r(e.on),e.on("_add",this._onAdd),e.on("_delete",this._onDelete),e.on("_clear",this._onClear)))):new i(t,e)},d(i.prototype,s({constructor:l(i),_next:l(function(){var t;if(this.__list__)return this.__redo__&&(t=this.__redo__.shift(),void 0!==t)?t:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:l(function(){return this._createResult(this._next())}),_createResult:l(function(t){return void 0===t?{done:!0,value:void 0}:{done:!1,value:this._resolve(t)}}),_resolve:l(function(t){return this.__list__[t]}),_unBind:l(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:l(function(){return"[object Iterator]"})},u({_onAdd:l(function(t){if(!(t>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__)return void c(this,"__redo__",l("c",[t]));this.__redo__.forEach(function(e,n){e>=t&&(this.__redo__[n]=++e)},this),this.__redo__.push(t)}}),_onDelete:l(function(t){var e;t>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(e=this.__redo__.indexOf(t),-1!==e&&this.__redo__.splice(e,1),this.__redo__.forEach(function(e,n){e>t&&(this.__redo__[n]=--e)},this)))}),_onClear:l(function(){this.__redo__&&o.call(this.__redo__),this.__nextIndex__=0})}))),c(i.prototype,h.iterator,l(function(){return this})),c(i.prototype,h.toStringTag,l("","Iterator"))},{d:4,"d/auto-bind":3,"es5-ext/array/#/clear":5,"es5-ext/object/assign":15,"es5-ext/object/valid-callable":31,"es5-ext/object/valid-value":32,"es6-symbol":50}],41:[function(t,e,n){"use strict";var i=t("es5-ext/function/is-arguments"),o=t("es5-ext/string/is-string"),s=t("es6-symbol").iterator,r=Array.isArray;e.exports=function(t){return null==t?!1:r(t)?!0:o(t)?!0:i(t)?!0:"function"==typeof t[s]}},{"es5-ext/function/is-arguments":7,"es5-ext/string/is-string":36,"es6-symbol":50}],42:[function(t,e,n){"use strict";var i,o=t("es5-ext/object/set-prototype-of"),s=t("d"),r=t("./"),a=Object.defineProperty;i=e.exports=function(t){return this instanceof i?(t=String(t),r.call(this,t),void a(this,"__length__",s("",t.length))):new i(t)},o&&o(i,r),i.prototype=Object.create(r.prototype,{constructor:s(i),_next:s(function(){return this.__list__?this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind():void 0}),_resolve:s(function(t){var e,n=this.__list__[t];return this.__nextIndex__===this.__length__?n:(e=n.charCodeAt(0),e>=55296&&56319>=e?n+this.__list__[this.__nextIndex__++]:n)}),toString:s(function(){return"[object String Iterator]"})})},{"./":40,d:4,"es5-ext/object/set-prototype-of":28}],43:[function(t,e,n){"use strict";var i=t("./is-iterable");e.exports=function(t){if(!i(t))throw new TypeError(t+" is not iterable");return t}},{"./is-iterable":41}],44:[function(t,e,n){(function(n,i){(function(){"use strict";function o(t){return"function"==typeof t||"object"==typeof t&&null!==t}function s(t){return"function"==typeof t}function r(t){return"object"==typeof t&&null!==t}function a(t){G=t}function l(t){J=t}function u(){return function(){n.nextTick(f)}}function h(){return function(){F(f)}}function c(){var t=0,e=new Q(f),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function d(){var t=new MessageChannel;return t.port1.onmessage=f,function(){t.port2.postMessage(0)}}function p(){return function(){setTimeout(f,1)}}function f(){for(var t=0;X>t;t+=2){var e=et[t],n=et[t+1];e(n),et[t]=void 0,et[t+1]=void 0}X=0}function m(){try{var e=t,n=e("vertx");return F=n.runOnLoop||n.runOnContext,h()}catch(i){return p()}}function _(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function v(){return new TypeError("A promises callback cannot return that same promise.")}function y(t){try{return t.then}catch(e){return st.error=e,st}}function b(t,e,n,i){try{t.call(e,n,i)}catch(o){return o}}function x(t,e,n){J(function(t){var i=!1,o=b(n,e,function(n){i||(i=!0,e!==n?w(t,n):E(t,n))},function(e){i||(i=!0,C(t,e))},"Settle: "+(t._label||" unknown promise"));!i&&o&&(i=!0,C(t,o))},t)}function L(t,e){e._state===it?E(t,e._result):e._state===ot?C(t,e._result):M(e,void 0,function(e){w(t,e)},function(e){C(t,e)})}function P(t,e){if(e.constructor===t.constructor)L(t,e);else{var n=y(e);n===st?C(t,st.error):void 0===n?E(t,e):s(n)?x(t,e,n):E(t,e)}}function w(t,e){t===e?C(t,g()):o(e)?P(t,e):E(t,e)}function T(t){t._onerror&&t._onerror(t._result),k(t)}function E(t,e){t._state===nt&&(t._result=e,t._state=it,0!==t._subscribers.length&&J(k,t))}function C(t,e){t._state===nt&&(t._state=ot,t._result=e,J(T,t))}function M(t,e,n,i){var o=t._subscribers,s=o.length;t._onerror=null,o[s]=e,o[s+it]=n,o[s+ot]=i,0===s&&t._state&&J(k,t)}function k(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i,o,s=t._result,r=0;r<e.length;r+=3)i=e[r],o=e[r+n],i?D(n,i,o,s):o(s);t._subscribers.length=0}}function S(){this.error=null}function O(t,e){try{return t(e)}catch(n){return rt.error=n,rt}}function D(t,e,n,i){var o,r,a,l,u=s(n);if(u){if(o=O(n,i),o===rt?(l=!0,r=o.error,o=null):a=!0,e===o)return void C(e,v())}else o=i,a=!0;e._state!==nt||(u&&a?w(e,o):l?C(e,r):t===it?E(e,o):t===ot&&C(e,o))}function A(t,e){try{e(function(e){w(t,e)},function(e){C(t,e)})}catch(n){C(t,n)}}function I(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(_),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?E(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&E(n.promise,n._result))):C(n.promise,n._validationError())}function z(t){return new at(this,t).promise}function B(t){function e(t){w(o,t)}function n(t){C(o,t)}var i=this,o=new i(_);if(!q(t))return C(o,new TypeError("You must pass an array to race.")),o;for(var s=t.length,r=0;o._state===nt&&s>r;r++)M(i.resolve(t[r]),void 0,e,n);return o}function N(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(_);return w(n,t),n}function j(t){var e=this,n=new e(_);return C(n,t),n}function U(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function R(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function H(t){this._id=dt++,this._state=void 0,this._result=void 0,this._subscribers=[],_!==t&&(s(t)||U(),this instanceof H||R(),A(this,t))}function Z(){var t;if("undefined"!=typeof i)t=i;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=pt)}var W;W=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var F,G,V,q=W,X=0,J=({}.toString,function(t,e){et[X]=t,et[X+1]=e,X+=2,2===X&&(G?G(f):V())}),Y="undefined"!=typeof window?window:void 0,K=Y||{},Q=K.MutationObserver||K.WebKitMutationObserver,$="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),tt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,et=new Array(1e3);V=$?u():Q?c():tt?d():void 0===Y&&"function"==typeof t?m():p();var nt=void 0,it=1,ot=2,st=new S,rt=new S;I.prototype._validateInput=function(t){return q(t)},I.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},I.prototype._init=function(){this._result=new Array(this.length)};var at=I;I.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,i=t._input,o=0;n._state===nt&&e>o;o++)t._eachEntry(i[o],o)},I.prototype._eachEntry=function(t,e){var n=this,i=n._instanceConstructor;r(t)?t.constructor===i&&t._state!==nt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(i.resolve(t),e):(n._remaining--,n._result[e]=t)},I.prototype._settledAt=function(t,e,n){var i=this,o=i.promise;o._state===nt&&(i._remaining--,t===ot?C(o,n):i._result[e]=n),0===i._remaining&&E(o,i._result)},I.prototype._willSettleAt=function(t,e){var n=this;M(t,void 0,function(t){n._settledAt(it,e,t)},function(t){n._settledAt(ot,e,t)})};var lt=z,ut=B,ht=N,ct=j,dt=0,pt=H;H.all=lt,H.race=ut,H.resolve=ht,H.reject=ct,H._setScheduler=a,H._setAsap=l,H._asap=J,H.prototype={constructor:H,then:function(t,e){var n=this,i=n._state;if(i===it&&!t||i===ot&&!e)return this;var o=new this.constructor(_),s=n._result;if(i){var r=arguments[i-1];J(function(){D(i,o,r,s)})}else M(n,o,t,e);return o},"catch":function(t){return this.then(null,t)}};var ft=Z,mt={Promise:pt,polyfill:ft};"function"==typeof define&&define.amd?define(function(){return mt}):"undefined"!=typeof e&&e.exports?e.exports=mt:"undefined"!=typeof this&&(this.ES6Promise=mt),ft()}).call(this)}).call(this,t("_process"),"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{_process:58}],45:[function(t,e,n){"use strict";t("./is-implemented")()||Object.defineProperty(t("es5-ext/global"),"Set",{value:t("./polyfill"),configurable:!0,enumerable:!1,writable:!0})},{"./is-implemented":46,"./polyfill":49,"es5-ext/global":8}],46:[function(t,e,n){"use strict";e.exports=function(){var t,e,n;return"function"!=typeof Set?!1:(t=new Set(["raz","dwa","trzy"]),"[object Set]"!==String(t)?!1:3!==t.size?!1:"function"!=typeof t.add?!1:"function"!=typeof t.clear?!1:"function"!=typeof t["delete"]?!1:"function"!=typeof t.entries?!1:"function"!=typeof t.forEach?!1:"function"!=typeof t.has?!1:"function"!=typeof t.keys?!1:"function"!=typeof t.values?!1:(e=t.values(),n=e.next(),n.done!==!1?!1:"raz"!==n.value?!1:!0))}},{}],47:[function(t,e,n){"use strict";e.exports=function(){return"undefined"==typeof Set?!1:"[object Set]"===Object.prototype.toString.call(Set.prototype)}()},{}],48:[function(t,e,n){"use strict";var i,o=t("es5-ext/object/set-prototype-of"),s=t("es5-ext/string/#/contains"),r=t("d"),a=t("es6-iterator"),l=t("es6-symbol").toStringTag,u=Object.defineProperty;i=e.exports=function(t,e){return this instanceof i?(a.call(this,t.__setData__,t),e=e&&s.call(e,"key+value")?"key+value":"value",void u(this,"__kind__",r("",e))):new i(t,e)},o&&o(i,a),i.prototype=Object.create(a.prototype,{constructor:r(i),_resolve:r(function(t){return"value"===this.__kind__?this.__list__[t]:[this.__list__[t],this.__list__[t]]}),toString:r(function(){return"[object Set Iterator]"})}),u(i.prototype,l,r("c","Set Iterator"))},{d:4,"es5-ext/object/set-prototype-of":28,"es5-ext/string/#/contains":33,"es6-iterator":40,"es6-symbol":50}],49:[function(t,e,n){"use strict";var i,o,s=t("es5-ext/array/#/clear"),r=t("es5-ext/array/#/e-index-of"),a=t("es5-ext/object/set-prototype-of"),l=t("es5-ext/object/valid-callable"),u=t("d"),h=t("event-emitter"),c=t("es6-symbol"),d=t("es6-iterator/valid-iterable"),p=t("es6-iterator/for-of"),f=t("./lib/iterator"),m=t("./is-native-implemented"),_=Function.prototype.call,g=Object.defineProperty,v=Object.getPrototypeOf;e.exports=i=function(){var t,e=arguments[0];if(!(this instanceof i))throw new TypeError("Constructor requires 'new'");return t=m&&a?a(new Set,v(this)):this,null!=e&&d(e),g(t,"__setData__",u("c",[])),e?(p(e,function(t){-1===r.call(this,t)&&this.push(t)},t.__setData__),t):t},m&&(a&&a(i,Set),i.prototype=Object.create(Set.prototype,{constructor:u(i)})),h(Object.defineProperties(i.prototype,{add:u(function(t){return this.has(t)?this:(this.emit("_add",this.__setData__.push(t)-1,t),this)}),clear:u(function(){this.__setData__.length&&(s.call(this.__setData__),this.emit("_clear"))}),"delete":u(function(t){var e=r.call(this.__setData__,t);return-1===e?!1:(this.__setData__.splice(e,1),this.emit("_delete",e,t),!0)}),entries:u(function(){return new f(this,"key+value")}),forEach:u(function(t){var e,n,i,o=arguments[1];for(l(t),e=this.values(),n=e._next();void 0!==n;)i=e._resolve(n),_.call(t,o,i,i,this),n=e._next()}),has:u(function(t){return-1!==r.call(this.__setData__,t)}),keys:u(o=function(){return this.values()}),size:u.gs(function(){return this.__setData__.length}),values:u(function(){return new f(this)}),toString:u(function(){return"[object Set]"})})),g(i.prototype,c.iterator,u(o)),g(i.prototype,c.toStringTag,u("c","Set"))},{"./is-native-implemented":47,"./lib/iterator":48,d:4,"es5-ext/array/#/clear":5,"es5-ext/array/#/e-index-of":6,"es5-ext/object/set-prototype-of":28,"es5-ext/object/valid-callable":31,"es6-iterator/for-of":38,"es6-iterator/valid-iterable":43,"es6-symbol":50,"event-emitter":55}],50:[function(t,e,n){"use strict";e.exports=t("./is-implemented")()?Symbol:t("./polyfill")},{"./is-implemented":51,"./polyfill":53}],51:[function(t,e,n){"use strict";e.exports=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(e){return!1}return"symbol"==typeof Symbol.iterator?!0:"object"!=typeof Symbol.isConcatSpreadable?!1:"object"!=typeof Symbol.iterator?!1:"object"!=typeof Symbol.toPrimitive?!1:"object"!=typeof Symbol.toStringTag?!1:"object"!=typeof Symbol.unscopables?!1:!0}},{}],52:[function(t,e,n){"use strict";e.exports=function(t){return t&&("symbol"==typeof t||"Symbol"===t["@@toStringTag"])||!1}},{}],53:[function(t,e,n){"use strict";var i,o,s,r=t("d"),a=t("./validate-symbol"),l=Object.create,u=Object.defineProperties,h=Object.defineProperty,c=Object.prototype,d=l(null);"function"==typeof Symbol&&(i=Symbol);var p=function(){var t=l(null);return function(e){for(var n,i,o=0;t[e+(o||"")];)++o;return e+=o||"",t[e]=!0,n="@@"+e,h(c,n,r.gs(null,function(t){i||(i=!0,h(this,n,r(t)),i=!1)})),n}}();s=function(t){if(this instanceof s)throw new TypeError("TypeError: Symbol is not a constructor");return o(t)},e.exports=o=function f(t){var e;if(this instanceof f)throw new TypeError("TypeError: Symbol is not a constructor");return e=l(s.prototype),t=void 0===t?"":String(t),u(e,{__description__:r("",t),__name__:r("",p(t))})},u(o,{"for":r(function(t){return d[t]?d[t]:d[t]=o(String(t))}),keyFor:r(function(t){var e;a(t);for(e in d)if(d[e]===t)return e}),hasInstance:r("",i&&i.hasInstance||o("hasInstance")),isConcatSpreadable:r("",i&&i.isConcatSpreadable||o("isConcatSpreadable")),iterator:r("",i&&i.iterator||o("iterator")),match:r("",i&&i.match||o("match")),replace:r("",i&&i.replace||o("replace")),search:r("",i&&i.search||o("search")),species:r("",i&&i.species||o("species")),split:r("",i&&i.split||o("split")),toPrimitive:r("",i&&i.toPrimitive||o("toPrimitive")),
toStringTag:r("",i&&i.toStringTag||o("toStringTag")),unscopables:r("",i&&i.unscopables||o("unscopables"))}),u(s.prototype,{constructor:r(o),toString:r("",function(){return this.__name__})}),u(o.prototype,{toString:r(function(){return"Symbol ("+a(this).__description__+")"}),valueOf:r(function(){return a(this)})}),h(o.prototype,o.toPrimitive,r("",function(){return a(this)})),h(o.prototype,o.toStringTag,r("c","Symbol")),h(s.prototype,o.toStringTag,r("c",o.prototype[o.toStringTag])),h(s.prototype,o.toPrimitive,r("c",o.prototype[o.toPrimitive]))},{"./validate-symbol":54,d:4}],54:[function(t,e,n){"use strict";var i=t("./is-symbol");e.exports=function(t){if(!i(t))throw new TypeError(t+" is not a symbol");return t}},{"./is-symbol":52}],55:[function(t,e,n){"use strict";var i,o,s,r,a,l,u,h=t("d"),c=t("es5-ext/object/valid-callable"),d=Function.prototype.apply,p=Function.prototype.call,f=Object.create,m=Object.defineProperty,_=Object.defineProperties,g=Object.prototype.hasOwnProperty,v={configurable:!0,enumerable:!1,writable:!0};i=function(t,e){var n;return c(e),g.call(this,"__ee__")?n=this.__ee__:(n=v.value=f(null),m(this,"__ee__",v),v.value=null),n[t]?"object"==typeof n[t]?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},o=function(t,e){var n,o;return c(e),o=this,i.call(this,t,n=function(){s.call(o,t,n),d.call(e,this,arguments)}),n.__eeOnceListener__=e,this},s=function(t,e){var n,i,o,s;if(c(e),!g.call(this,"__ee__"))return this;if(n=this.__ee__,!n[t])return this;if(i=n[t],"object"==typeof i)for(s=0;o=i[s];++s)(o===e||o.__eeOnceListener__===e)&&(2===i.length?n[t]=i[s?0:1]:i.splice(s,1));else(i===e||i.__eeOnceListener__===e)&&delete n[t];return this},r=function(t){var e,n,i,o,s;if(g.call(this,"__ee__")&&(o=this.__ee__[t]))if("object"==typeof o){for(n=arguments.length,s=new Array(n-1),e=1;n>e;++e)s[e-1]=arguments[e];for(o=o.slice(),e=0;i=o[e];++e)d.call(i,this,s)}else switch(arguments.length){case 1:p.call(o,this);break;case 2:p.call(o,this,arguments[1]);break;case 3:p.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,s=new Array(n-1),e=1;n>e;++e)s[e-1]=arguments[e];d.call(o,this,s)}},a={on:i,once:o,off:s,emit:r},l={on:h(i),once:h(o),off:h(s),emit:h(r)},u=_({},l),e.exports=n=function(t){return null==t?f(u):_(Object(t),l)},n.methods=a},{d:4,"es5-ext/object/valid-callable":31}],56:[function(t,e,n){!function(t,n,i,o){"use strict";function s(t,e,n){return setTimeout(h(t,n),e)}function r(t,e,n){return Array.isArray(t)?(a(t,n[e],n),!0):!1}function a(t,e,n){var i;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==o)for(i=0;i<t.length;)e.call(n,t[i],i,t),i++;else for(i in t)t.hasOwnProperty(i)&&e.call(n,t[i],i,t)}function l(e,n,i){var o="DEPRECATED METHOD: "+n+"\n"+i+" AT \n";return function(){var n=new Error("get-stack-trace"),i=n&&n.stack?n.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",s=t.console&&(t.console.warn||t.console.log);return s&&s.call(t.console,o,i),e.apply(this,arguments)}}function u(t,e,n){var i,o=e.prototype;i=t.prototype=Object.create(o),i.constructor=t,i._super=o,n&&lt(i,n)}function h(t,e){return function(){return t.apply(e,arguments)}}function c(t,e){return typeof t==ct?t.apply(e?e[0]||o:o,e):t}function d(t,e){return t===o?e:t}function p(t,e,n){a(g(e),function(e){t.addEventListener(e,n,!1)})}function f(t,e,n){a(g(e),function(e){t.removeEventListener(e,n,!1)})}function m(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function _(t,e){return t.indexOf(e)>-1}function g(t){return t.trim().split(/\s+/g)}function v(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var i=0;i<t.length;){if(n&&t[i][n]==e||!n&&t[i]===e)return i;i++}return-1}function y(t){return Array.prototype.slice.call(t,0)}function b(t,e,n){for(var i=[],o=[],s=0;s<t.length;){var r=e?t[s][e]:t[s];v(o,r)<0&&i.push(t[s]),o[s]=r,s++}return n&&(i=e?i.sort(function(t,n){return t[e]>n[e]}):i.sort()),i}function x(t,e){for(var n,i,s=e[0].toUpperCase()+e.slice(1),r=0;r<ut.length;){if(n=ut[r],i=n?n+s:e,i in t)return i;r++}return o}function L(){return gt++}function P(e){var n=e.ownerDocument||e;return n.defaultView||n.parentWindow||t}function w(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){c(t.options.enable,[t])&&n.handler(e)},this.init()}function T(t){var e,n=t.options.inputClass;return new(e=n?n:bt?U:xt?Z:yt?F:j)(t,E)}function E(t,e,n){var i=n.pointers.length,o=n.changedPointers.length,s=e&Ct&&i-o===0,r=e&(kt|St)&&i-o===0;n.isFirst=!!s,n.isFinal=!!r,s&&(t.session={}),n.eventType=e,C(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function C(t,e){var n=t.session,i=e.pointers,o=i.length;n.firstInput||(n.firstInput=S(e)),o>1&&!n.firstMultiple?n.firstMultiple=S(e):1===o&&(n.firstMultiple=!1);var s=n.firstInput,r=n.firstMultiple,a=r?r.center:s.center,l=e.center=O(i);e.timeStamp=ft(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=z(a,l),e.distance=I(a,l),M(n,e),e.offsetDirection=A(e.deltaX,e.deltaY);var u=D(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=u.x,e.overallVelocityY=u.y,e.overallVelocity=pt(u.x)>pt(u.y)?u.x:u.y,e.scale=r?N(r.pointers,i):1,e.rotation=r?B(r.pointers,i):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,k(n,e);var h=t.element;m(e.srcEvent.target,h)&&(h=e.srcEvent.target),e.target=h}function M(t,e){var n=e.center,i=t.offsetDelta||{},o=t.prevDelta||{},s=t.prevInput||{};(e.eventType===Ct||s.eventType===kt)&&(o=t.prevDelta={x:s.deltaX||0,y:s.deltaY||0},i=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=o.x+(n.x-i.x),e.deltaY=o.y+(n.y-i.y)}function k(t,e){var n,i,s,r,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(e.eventType!=St&&(l>Et||a.velocity===o)){var u=e.deltaX-a.deltaX,h=e.deltaY-a.deltaY,c=D(l,u,h);i=c.x,s=c.y,n=pt(c.x)>pt(c.y)?c.x:c.y,r=A(u,h),t.lastInterval=e}else n=a.velocity,i=a.velocityX,s=a.velocityY,r=a.direction;e.velocity=n,e.velocityX=i,e.velocityY=s,e.direction=r}function S(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:dt(t.pointers[n].clientX),clientY:dt(t.pointers[n].clientY)},n++;return{timeStamp:ft(),pointers:e,center:O(e),deltaX:t.deltaX,deltaY:t.deltaY}}function O(t){var e=t.length;if(1===e)return{x:dt(t[0].clientX),y:dt(t[0].clientY)};for(var n=0,i=0,o=0;e>o;)n+=t[o].clientX,i+=t[o].clientY,o++;return{x:dt(n/e),y:dt(i/e)}}function D(t,e,n){return{x:e/t||0,y:n/t||0}}function A(t,e){return t===e?Ot:pt(t)>=pt(e)?0>t?Dt:At:0>e?It:zt}function I(t,e,n){n||(n=Ut);var i=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return Math.sqrt(i*i+o*o)}function z(t,e,n){n||(n=Ut);var i=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return 180*Math.atan2(o,i)/Math.PI}function B(t,e){return z(e[1],e[0],Rt)+z(t[1],t[0],Rt)}function N(t,e){return I(e[0],e[1],Rt)/I(t[0],t[1],Rt)}function j(){this.evEl=Zt,this.evWin=Wt,this.allow=!0,this.pressed=!1,w.apply(this,arguments)}function U(){this.evEl=Vt,this.evWin=qt,w.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function R(){this.evTarget=Jt,this.evWin=Yt,this.started=!1,w.apply(this,arguments)}function H(t,e){var n=y(t.touches),i=y(t.changedTouches);return e&(kt|St)&&(n=b(n.concat(i),"identifier",!0)),[n,i]}function Z(){this.evTarget=Qt,this.targetIds={},w.apply(this,arguments)}function W(t,e){var n=y(t.touches),i=this.targetIds;if(e&(Ct|Mt)&&1===n.length)return i[n[0].identifier]=!0,[n,n];var o,s,r=y(t.changedTouches),a=[],l=this.target;if(s=n.filter(function(t){return m(t.target,l)}),e===Ct)for(o=0;o<s.length;)i[s[o].identifier]=!0,o++;for(o=0;o<r.length;)i[r[o].identifier]&&a.push(r[o]),e&(kt|St)&&delete i[r[o].identifier],o++;return a.length?[b(s.concat(a),"identifier",!0),a]:void 0}function F(){w.apply(this,arguments);var t=h(this.handler,this);this.touch=new Z(this.manager,t),this.mouse=new j(this.manager,t)}function G(t,e){this.manager=t,this.set(e)}function V(t){if(_(t,oe))return oe;var e=_(t,se),n=_(t,re);return e&&n?oe:e||n?e?se:re:_(t,ie)?ie:ne}function q(t){this.options=lt({},this.defaults,t||{}),this.id=L(),this.manager=null,this.options.enable=d(this.options.enable,!0),this.state=ae,this.simultaneous={},this.requireFail=[]}function X(t){return t&de?"cancel":t&he?"end":t&ue?"move":t&le?"start":""}function J(t){return t==zt?"down":t==It?"up":t==Dt?"left":t==At?"right":""}function Y(t,e){var n=e.manager;return n?n.get(t):t}function K(){q.apply(this,arguments)}function Q(){K.apply(this,arguments),this.pX=null,this.pY=null}function $(){K.apply(this,arguments)}function tt(){q.apply(this,arguments),this._timer=null,this._input=null}function et(){K.apply(this,arguments)}function nt(){K.apply(this,arguments)}function it(){q.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function ot(t,e){return e=e||{},e.recognizers=d(e.recognizers,ot.defaults.preset),new st(t,e)}function st(t,e){this.options=lt({},ot.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.element=t,this.input=T(this),this.touchAction=new G(this,this.options.touchAction),rt(this,!0),a(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function rt(t,e){var n=t.element;n.style&&a(t.options.cssProps,function(t,i){n.style[x(n.style,i)]=e?t:""})}function at(t,e){var i=n.createEvent("Event");i.initEvent(t,!0,!0),i.gesture=e,e.target.dispatchEvent(i)}var lt,ut=["","webkit","Moz","MS","ms","o"],ht=n.createElement("div"),ct="function",dt=Math.round,pt=Math.abs,ft=Date.now;lt="function"!=typeof Object.assign?function(t){if(t===o||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==o&&null!==i)for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])}return e}:Object.assign;var mt=l(function(t,e,n){for(var i=Object.keys(e),s=0;s<i.length;)(!n||n&&t[i[s]]===o)&&(t[i[s]]=e[i[s]]),s++;return t},"extend","Use `assign`."),_t=l(function(t,e){return mt(t,e,!0)},"merge","Use `assign`."),gt=1,vt=/mobile|tablet|ip(ad|hone|od)|android/i,yt="ontouchstart"in t,bt=x(t,"PointerEvent")!==o,xt=yt&&vt.test(navigator.userAgent),Lt="touch",Pt="pen",wt="mouse",Tt="kinect",Et=25,Ct=1,Mt=2,kt=4,St=8,Ot=1,Dt=2,At=4,It=8,zt=16,Bt=Dt|At,Nt=It|zt,jt=Bt|Nt,Ut=["x","y"],Rt=["clientX","clientY"];w.prototype={handler:function(){},init:function(){this.evEl&&p(this.element,this.evEl,this.domHandler),this.evTarget&&p(this.target,this.evTarget,this.domHandler),this.evWin&&p(P(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&f(this.element,this.evEl,this.domHandler),this.evTarget&&f(this.target,this.evTarget,this.domHandler),this.evWin&&f(P(this.element),this.evWin,this.domHandler)}};var Ht={mousedown:Ct,mousemove:Mt,mouseup:kt},Zt="mousedown",Wt="mousemove mouseup";u(j,w,{handler:function(t){var e=Ht[t.type];e&Ct&&0===t.button&&(this.pressed=!0),e&Mt&&1!==t.which&&(e=kt),this.pressed&&this.allow&&(e&kt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:wt,srcEvent:t}))}});var Ft={pointerdown:Ct,pointermove:Mt,pointerup:kt,pointercancel:St,pointerout:St},Gt={2:Lt,3:Pt,4:wt,5:Tt},Vt="pointerdown",qt="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Vt="MSPointerDown",qt="MSPointerMove MSPointerUp MSPointerCancel"),u(U,w,{handler:function(t){var e=this.store,n=!1,i=t.type.toLowerCase().replace("ms",""),o=Ft[i],s=Gt[t.pointerType]||t.pointerType,r=s==Lt,a=v(e,t.pointerId,"pointerId");o&Ct&&(0===t.button||r)?0>a&&(e.push(t),a=e.length-1):o&(kt|St)&&(n=!0),0>a||(e[a]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:s,srcEvent:t}),n&&e.splice(a,1))}});var Xt={touchstart:Ct,touchmove:Mt,touchend:kt,touchcancel:St},Jt="touchstart",Yt="touchstart touchmove touchend touchcancel";u(R,w,{handler:function(t){var e=Xt[t.type];if(e===Ct&&(this.started=!0),this.started){var n=H.call(this,t,e);e&(kt|St)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Lt,srcEvent:t})}}});var Kt={touchstart:Ct,touchmove:Mt,touchend:kt,touchcancel:St},Qt="touchstart touchmove touchend touchcancel";u(Z,w,{handler:function(t){var e=Kt[t.type],n=W.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Lt,srcEvent:t})}}),u(F,w,{handler:function(t,e,n){var i=n.pointerType==Lt,o=n.pointerType==wt;if(i)this.mouse.allow=!1;else if(o&&!this.mouse.allow)return;e&(kt|St)&&(this.mouse.allow=!0),this.callback(t,e,n)},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var $t=x(ht.style,"touchAction"),te=$t!==o,ee="compute",ne="auto",ie="manipulation",oe="none",se="pan-x",re="pan-y";G.prototype={set:function(t){t==ee&&(t=this.compute()),te&&this.manager.element.style&&(this.manager.element.style[$t]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return a(this.manager.recognizers,function(e){c(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),V(t.join(" "))},preventDefaults:function(t){if(!te){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var i=this.actions,o=_(i,oe),s=_(i,re),r=_(i,se);if(o){var a=1===t.pointers.length,l=t.distance<2,u=t.deltaTime<250;if(a&&l&&u)return}if(!r||!s)return o||s&&n&Bt||r&&n&Nt?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var ae=1,le=2,ue=4,he=8,ce=he,de=16,pe=32;q.prototype={defaults:{},set:function(t){return lt(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(r(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=Y(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return r(t,"dropRecognizeWith",this)?this:(t=Y(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(r(t,"requireFailure",this))return this;var e=this.requireFail;return t=Y(t,this),-1===v(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(r(t,"dropRequireFailure",this))return this;t=Y(t,this);var e=v(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,i=this.state;he>i&&e(n.options.event+X(i)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),i>=he&&e(n.options.event+X(i))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=pe)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(pe|ae)))return!1;t++}return!0},recognize:function(t){var e=lt({},t);return c(this.options.enable,[this,e])?(this.state&(ce|de|pe)&&(this.state=ae),this.state=this.process(e),void(this.state&(le|ue|he|de)&&this.tryEmit(e))):(this.reset(),void(this.state=pe))},process:function(t){},getTouchAction:function(){},reset:function(){}},u(K,q,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,i=e&(le|ue),o=this.attrTest(t);return i&&(n&St||!o)?e|de:i||o?n&kt?e|he:e&le?e|ue:le:pe}}),u(Q,K,{defaults:{event:"pan",threshold:10,pointers:1,direction:jt},getTouchAction:function(){var t=this.options.direction,e=[];return t&Bt&&e.push(re),t&Nt&&e.push(se),e},directionTest:function(t){var e=this.options,n=!0,i=t.distance,o=t.direction,s=t.deltaX,r=t.deltaY;return o&e.direction||(e.direction&Bt?(o=0===s?Ot:0>s?Dt:At,n=s!=this.pX,i=Math.abs(t.deltaX)):(o=0===r?Ot:0>r?It:zt,n=r!=this.pY,i=Math.abs(t.deltaY))),t.direction=o,n&&i>e.threshold&&o&e.direction},attrTest:function(t){return K.prototype.attrTest.call(this,t)&&(this.state&le||!(this.state&le)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=J(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),u($,K,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[oe]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&le)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),u(tt,q,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ne]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!i||!n||t.eventType&(kt|St)&&!o)this.reset();else if(t.eventType&Ct)this.reset(),this._timer=s(function(){this.state=ce,this.tryEmit()},e.time,this);else if(t.eventType&kt)return ce;return pe},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===ce&&(t&&t.eventType&kt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=ft(),this.manager.emit(this.options.event,this._input)))}}),u(et,K,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[oe]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&le)}}),u(nt,K,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Bt|Nt,pointers:1},getTouchAction:function(){return Q.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(Bt|Nt)?e=t.overallVelocity:n&Bt?e=t.overallVelocityX:n&Nt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&pt(e)>this.options.velocity&&t.eventType&kt},emit:function(t){var e=J(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),u(it,q,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[ie]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,i=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&Ct&&0===this.count)return this.failTimeout();if(i&&o&&n){if(t.eventType!=kt)return this.failTimeout();var r=this.pTime?t.timeStamp-this.pTime<e.interval:!0,a=!this.pCenter||I(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&r?this.count+=1:this.count=1,this._input=t;var l=this.count%e.taps;if(0===l)return this.hasRequireFailures()?(this._timer=s(function(){this.state=ce,this.tryEmit()},e.interval,this),le):ce}return pe},failTimeout:function(){return this._timer=s(function(){this.state=pe},this.options.interval,this),pe},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==ce&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),ot.VERSION="2.0.6",ot.defaults={domEvents:!1,touchAction:ee,enable:!0,inputTarget:null,inputClass:null,preset:[[et,{enable:!1}],[$,{enable:!1},["rotate"]],[nt,{direction:Bt}],[Q,{direction:Bt},["swipe"]],[it],[it,{event:"doubletap",taps:2},["tap"]],[tt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var fe=1,me=2;st.prototype={set:function(t){return lt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?me:fe},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,i=this.recognizers,o=e.curRecognizer;(!o||o&&o.state&ce)&&(o=e.curRecognizer=null);for(var s=0;s<i.length;)n=i[s],e.stopped===me||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(t),!o&&n.state&(le|ue|he)&&(o=e.curRecognizer=n),s++}},get:function(t){if(t instanceof q)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(r(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(r(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=v(e,t);-1!==n&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){var n=this.handlers;return a(g(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this},off:function(t,e){var n=this.handlers;return a(g(t),function(t){e?n[t]&&n[t].splice(v(n[t],e),1):delete n[t]}),this},emit:function(t,e){this.options.domEvents&&at(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](e),i++}},destroy:function(){this.element&&rt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},lt(ot,{INPUT_START:Ct,INPUT_MOVE:Mt,INPUT_END:kt,INPUT_CANCEL:St,STATE_POSSIBLE:ae,STATE_BEGAN:le,STATE_CHANGED:ue,STATE_ENDED:he,STATE_RECOGNIZED:ce,STATE_CANCELLED:de,STATE_FAILED:pe,DIRECTION_NONE:Ot,DIRECTION_LEFT:Dt,DIRECTION_RIGHT:At,DIRECTION_UP:It,DIRECTION_DOWN:zt,DIRECTION_HORIZONTAL:Bt,DIRECTION_VERTICAL:Nt,DIRECTION_ALL:jt,Manager:st,Input:w,TouchAction:G,TouchInput:Z,MouseInput:j,PointerEventInput:U,TouchMouseInput:F,SingleTouchInput:R,Recognizer:q,AttrRecognizer:K,Tap:it,Pan:Q,Swipe:nt,Pinch:$,Rotate:et,Press:tt,on:p,off:f,each:a,merge:_t,extend:mt,assign:lt,inherit:u,bindFn:h,prefixed:x});var _e="undefined"!=typeof t?t:"undefined"!=typeof self?self:{};_e.Hammer=ot,"function"==typeof define&&define.amd?define(function(){return ot}):"undefined"!=typeof e&&e.exports?e.exports=ot:t[i]=ot}(window,document,"Hammer")},{}],57:[function(t,e,n){!function(t,n,i){var o=t.L,s={};s.version="0.7.7","object"==typeof e&&"object"==typeof e.exports?e.exports=s:"function"==typeof define&&define.amd&&define(s),s.noConflict=function(){return t.L=o,this},t.L=s,s.Util={extend:function(t){var e,n,i,o,s=Array.prototype.slice.call(arguments,1);for(n=0,i=s.length;i>n;n++){o=s[n]||{};for(e in o)o.hasOwnProperty(e)&&(t[e]=o[e])}return t},bind:function(t,e){var n=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,n||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(n){return n[e]=n[e]||++t,n[e]}}(),invokeEach:function(t,e,n){var i,o;if("object"==typeof t){o=Array.prototype.slice.call(arguments,3);for(i in t)e.apply(n,[i,t[i]].concat(o));return!0}return!1},limitExecByInterval:function(t,e,n){var i,o;return function s(){var r=arguments;return i?void(o=!0):(i=!0,setTimeout(function(){i=!1,o&&(s.apply(n,r),o=!1)},e),void t.apply(n,r))}},falseFn:function(){return!1},formatNum:function(t,e){var n=Math.pow(10,e||5);return Math.round(t*n)/n},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return s.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=s.extend({},t.options,e),t.options},getParamString:function(t,e,n){var i=[];for(var o in t)i.push(encodeURIComponent(n?o.toUpperCase():o)+"="+encodeURIComponent(t[o]));return(e&&-1!==e.indexOf("?")?"&":"?")+i.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var o=e[n];if(o===i)throw new Error("No value provided for variable "+t);return"function"==typeof o&&(o=o(e)),o})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var n,i,o=["webkit","moz","o","ms"];for(n=0;n<o.length&&!i;n++)i=t[o[n]+e];return i}function n(e){var n=+new Date,o=Math.max(0,16-(n-i));return i=n+o,t.setTimeout(e,o)}var i=0,o=t.requestAnimationFrame||e("RequestAnimationFrame")||n,r=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};s.Util.requestAnimFrame=function(e,i,r,a){return e=s.bind(e,i),r&&o===n?void e():o.call(t,e,a)},s.Util.cancelAnimFrame=function(e){e&&r.call(t,e)}}(),s.extend=s.Util.extend,s.bind=s.Util.bind,s.stamp=s.Util.stamp,s.setOptions=s.Util.setOptions,s.Class=function(){},s.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},n=function(){};n.prototype=this.prototype;var i=new n;i.constructor=e,e.prototype=i;for(var o in this)this.hasOwnProperty(o)&&"prototype"!==o&&(e[o]=this[o]);t.statics&&(s.extend(e,t.statics),delete t.statics),t.includes&&(s.Util.extend.apply(null,[i].concat(t.includes)),delete t.includes),t.options&&i.options&&(t.options=s.extend({},i.options,t.options)),s.extend(i,t),i._initHooks=[];var r=this;return e.__super__=r.prototype,i.callInitHooks=function(){if(!this._initHooksCalled){r.prototype.callInitHooks&&r.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=i._initHooks.length;e>t;t++)i._initHooks[t].call(this)}},e},s.Class.include=function(t){s.extend(this.prototype,t)},s.Class.mergeOptions=function(t){s.extend(this.prototype.options,t)},s.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),n="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(n)};var r="_leaflet_events";s.Mixin={},s.Mixin.Events={addEventListener:function(t,e,n){if(s.Util.invokeEach(t,this.addEventListener,this,e,n))return this;var i,o,a,l,u,h,c,d=this[r]=this[r]||{},p=n&&n!==this&&s.stamp(n);for(t=s.Util.splitWords(t),i=0,o=t.length;o>i;i++)a={action:e,context:n||this},l=t[i],p?(u=l+"_idx",h=u+"_len",c=d[u]=d[u]||{},c[p]||(c[p]=[],d[h]=(d[h]||0)+1),c[p].push(a)):(d[l]=d[l]||[],d[l].push(a));return this},hasEventListeners:function(t){var e=this[r];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,n){if(!this[r])return this;if(!t)return this.clearAllEventListeners();if(s.Util.invokeEach(t,this.removeEventListener,this,e,n))return this;var i,o,a,l,u,h,c,d,p,f=this[r],m=n&&n!==this&&s.stamp(n);for(t=s.Util.splitWords(t),i=0,o=t.length;o>i;i++)if(a=t[i],h=a+"_idx",c=h+"_len",d=f[h],e){if(l=m&&d?d[m]:f[a]){for(u=l.length-1;u>=0;u--)l[u].action!==e||n&&l[u].context!==n||(p=l.splice(u,1),p[0].action=s.Util.falseFn);n&&d&&0===l.length&&(delete d[m],f[c]--)}}else delete f[a],delete f[h],delete f[c];return this},clearAllEventListeners:function(){return delete this[r],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var n,i,o,a,l,u=s.Util.extend({},e,{type:t,target:this}),h=this[r];if(h[t])for(n=h[t].slice(),i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,u);a=h[t+"_idx"];for(l in a)if(n=a[l].slice())for(i=0,o=n.length;o>i;i++)n[i].action.call(n[i].context,u);return this},addOneTimeEventListener:function(t,e,n){if(s.Util.invokeEach(t,this.addOneTimeEventListener,this,e,n))return this;var i=s.bind(function(){this.removeEventListener(t,e,n).removeEventListener(t,i,n)},this);return this.addEventListener(t,e,n).addEventListener(t,i,n)}},s.Mixin.Events.on=s.Mixin.Events.addEventListener,s.Mixin.Events.off=s.Mixin.Events.removeEventListener,s.Mixin.Events.once=s.Mixin.Events.addOneTimeEventListener,s.Mixin.Events.fire=s.Mixin.Events.fireEvent,function(){var e="ActiveXObject"in t,o=e&&!n.addEventListener,r=navigator.userAgent.toLowerCase(),a=-1!==r.indexOf("webkit"),l=-1!==r.indexOf("chrome"),u=-1!==r.indexOf("phantom"),h=-1!==r.indexOf("android"),c=-1!==r.search("android [23]"),d=-1!==r.indexOf("gecko"),p=typeof orientation!=i+"",f=!t.PointerEvent&&t.MSPointerEvent,m=t.PointerEvent&&t.navigator.pointerEnabled||f,_="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,g=n.documentElement,v=e&&"transition"in g.style,y="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!c,b="MozPerspective"in g.style,x="OTransition"in g.style,L=!t.L_DISABLE_3D&&(v||y||b||x)&&!u,P=!t.L_NO_TOUCH&&!u&&(m||"ontouchstart"in t||t.DocumentTouch&&n instanceof t.DocumentTouch);s.Browser={ie:e,ielt9:o,webkit:a,gecko:d&&!a&&!t.opera&&!e,android:h,android23:c,chrome:l,ie3d:v,webkit3d:y,gecko3d:b,opera3d:x,any3d:L,mobile:p,mobileWebkit:p&&a,mobileWebkit3d:p&&y,mobileOpera:p&&t.opera,touch:P,msPointer:f,pointer:m,retina:_}}(),s.Point=function(t,e,n){this.x=n?Math.round(t):t,this.y=n?Math.round(e):e},s.Point.prototype={clone:function(){return new s.Point(this.x,this.y)},add:function(t){return this.clone()._add(s.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(s.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=s.point(t);var e=t.x-this.x,n=t.y-this.y;return Math.sqrt(e*e+n*n)},equals:function(t){return t=s.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=s.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+s.Util.formatNum(this.x)+", "+s.Util.formatNum(this.y)+")"}},s.point=function(t,e,n){return t instanceof s.Point?t:s.Util.isArray(t)?new s.Point(t[0],t[1]):t===i||null===t?t:new s.Point(t,e,n)},s.Bounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},s.Bounds.prototype={extend:function(t){return t=s.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new s.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new s.Point(this.min.x,this.max.y)},getTopRight:function(){return new s.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,n;return t="number"==typeof t[0]||t instanceof s.Point?s.point(t):s.bounds(t),t instanceof s.Bounds?(e=t.min,n=t.max):e=n=t,e.x>=this.min.x&&n.x<=this.max.x&&e.y>=this.min.y&&n.y<=this.max.y},intersects:function(t){t=s.bounds(t);var e=this.min,n=this.max,i=t.min,o=t.max,r=o.x>=e.x&&i.x<=n.x,a=o.y>=e.y&&i.y<=n.y;return r&&a},isValid:function(){return!(!this.min||!this.max)}},s.bounds=function(t,e){return!t||t instanceof s.Bounds?t:new s.Bounds(t,e)},s.Transformation=function(t,e,n,i){this._a=t,this._b=e,this._c=n,this._d=i},s.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new s.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},s.DomUtil={get:function(t){return"string"==typeof t?n.getElementById(t):t},getStyle:function(t,e){var i=t.style[e];if(!i&&t.currentStyle&&(i=t.currentStyle[e]),(!i||"auto"===i)&&n.defaultView){var o=n.defaultView.getComputedStyle(t,null);i=o?o[e]:null}return"auto"===i?null:i},getViewportOffset:function(t){var e,i=0,o=0,r=t,a=n.body,l=n.documentElement;do{if(i+=r.offsetTop||0,o+=r.offsetLeft||0,i+=parseInt(s.DomUtil.getStyle(r,"borderTopWidth"),10)||0,o+=parseInt(s.DomUtil.getStyle(r,"borderLeftWidth"),10)||0,e=s.DomUtil.getStyle(r,"position"),r.offsetParent===a&&"absolute"===e)break;if("fixed"===e){
i+=a.scrollTop||l.scrollTop||0,o+=a.scrollLeft||l.scrollLeft||0;break}if("relative"===e&&!r.offsetLeft){var u=s.DomUtil.getStyle(r,"width"),h=s.DomUtil.getStyle(r,"max-width"),c=r.getBoundingClientRect();("none"!==u||"none"!==h)&&(o+=c.left+r.clientLeft),i+=c.top+(a.scrollTop||l.scrollTop||0);break}r=r.offsetParent}while(r);r=t;do{if(r===a)break;i-=r.scrollTop||0,o-=r.scrollLeft||0,r=r.parentNode}while(r);return new s.Point(o,i)},documentIsLtr:function(){return s.DomUtil._docIsLtrCached||(s.DomUtil._docIsLtrCached=!0,s.DomUtil._docIsLtr="ltr"===s.DomUtil.getStyle(n.body,"direction")),s.DomUtil._docIsLtr},create:function(t,e,i){var o=n.createElement(t);return o.className=e,i&&i.appendChild(o),o},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=s.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=s.Util.splitWords(e),o=0,r=n.length;r>o;o++)t.classList.add(n[o]);else if(!s.DomUtil.hasClass(t,e)){var a=s.DomUtil._getClass(t);s.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):s.DomUtil._setClass(t,s.Util.trim((" "+s.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var n=!1,i="DXImageTransform.Microsoft.Alpha";try{n=t.filters.item(i)}catch(o){if(1===e)return}e=Math.round(100*e),n?(n.Enabled=100!==e,n.Opacity=e):t.style.filter+=" progid:"+i+"(opacity="+e+")"}},testProp:function(t){for(var e=n.documentElement.style,i=0;i<t.length;i++)if(t[i]in e)return t[i];return!1},getTranslateString:function(t){var e=s.Browser.webkit3d,n="translate"+(e?"3d":"")+"(",i=(e?",0":"")+")";return n+t.x+"px,"+t.y+"px"+i},getScaleString:function(t,e){var n=s.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),i=" scale("+t+") ";return n+i},setPosition:function(t,e,n){t._leaflet_pos=e,!n&&s.Browser.any3d?t.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},s.DomUtil.TRANSFORM=s.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),s.DomUtil.TRANSITION=s.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),s.DomUtil.TRANSITION_END="webkitTransition"===s.DomUtil.TRANSITION||"OTransition"===s.DomUtil.TRANSITION?s.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in n)s.extend(s.DomUtil,{disableTextSelection:function(){s.DomEvent.on(t,"selectstart",s.DomEvent.preventDefault)},enableTextSelection:function(){s.DomEvent.off(t,"selectstart",s.DomEvent.preventDefault)}});else{var e=s.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);s.extend(s.DomUtil,{disableTextSelection:function(){if(e){var t=n.documentElement.style;this._userSelect=t[e],t[e]="none"}},enableTextSelection:function(){e&&(n.documentElement.style[e]=this._userSelect,delete this._userSelect)}})}s.extend(s.DomUtil,{disableImageDrag:function(){s.DomEvent.on(t,"dragstart",s.DomEvent.preventDefault)},enableImageDrag:function(){s.DomEvent.off(t,"dragstart",s.DomEvent.preventDefault)}})}(),s.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==i&&(this.alt=parseFloat(n))},s.extend(s.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),s.LatLng.prototype={equals:function(t){if(!t)return!1;t=s.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=s.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+s.Util.formatNum(this.lat,t)+", "+s.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=s.latLng(t);var e=6378137,n=s.LatLng.DEG_TO_RAD,i=(t.lat-this.lat)*n,o=(t.lng-this.lng)*n,r=this.lat*n,a=t.lat*n,l=Math.sin(i/2),u=Math.sin(o/2),h=l*l+u*u*Math.cos(r)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(h),Math.sqrt(1-h))},wrap:function(t,e){var n=this.lng;return t=t||-180,e=e||180,n=(n+e)%(e-t)+(t>n||n===e?e:t),new s.LatLng(this.lat,n)}},s.latLng=function(t,e){return t instanceof s.LatLng?t:s.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new s.LatLng(t[0],t[1],t[2]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new s.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===i?null:new s.LatLng(t,e)},s.LatLngBounds=function(t,e){if(t)for(var n=e?[t,e]:t,i=0,o=n.length;o>i;i++)this.extend(n[i])},s.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=s.latLng(t);return t=null!==e?e:s.latLngBounds(t),t instanceof s.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new s.LatLng(t.lat,t.lng),this._northEast=new s.LatLng(t.lat,t.lng)):t instanceof s.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,n=this._northEast,i=Math.abs(e.lat-n.lat)*t,o=Math.abs(e.lng-n.lng)*t;return new s.LatLngBounds(new s.LatLng(e.lat-i,e.lng-o),new s.LatLng(n.lat+i,n.lng+o))},getCenter:function(){return new s.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new s.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new s.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof s.LatLng?s.latLng(t):s.latLngBounds(t);var e,n,i=this._southWest,o=this._northEast;return t instanceof s.LatLngBounds?(e=t.getSouthWest(),n=t.getNorthEast()):e=n=t,e.lat>=i.lat&&n.lat<=o.lat&&e.lng>=i.lng&&n.lng<=o.lng},intersects:function(t){t=s.latLngBounds(t);var e=this._southWest,n=this._northEast,i=t.getSouthWest(),o=t.getNorthEast(),r=o.lat>=e.lat&&i.lat<=n.lat,a=o.lng>=e.lng&&i.lng<=n.lng;return r&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=s.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},s.latLngBounds=function(t,e){return!t||t instanceof s.LatLngBounds?t:new s.LatLngBounds(t,e)},s.Projection={},s.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=s.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=t.lng*e,r=i*e;return r=Math.log(Math.tan(Math.PI/4+r/2)),new s.Point(o,r)},unproject:function(t){var e=s.LatLng.RAD_TO_DEG,n=t.x*e,i=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new s.LatLng(i,n)}},s.Projection.LonLat={project:function(t){return new s.Point(t.lng,t.lat)},unproject:function(t){return new s.LatLng(t.y,t.x)}},s.CRS={latLngToPoint:function(t,e){var n=this.projection.project(t),i=this.scale(e);return this.transformation._transform(n,i)},pointToLatLng:function(t,e){var n=this.scale(e),i=this.transformation.untransform(t,n);return this.projection.unproject(i)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return s.point(e,e)}},s.CRS.Simple=s.extend({},s.CRS,{projection:s.Projection.LonLat,transformation:new s.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),s.CRS.EPSG3857=s.extend({},s.CRS,{code:"EPSG:3857",projection:s.Projection.SphericalMercator,transformation:new s.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),n=6378137;return e.multiplyBy(n)}}),s.CRS.EPSG900913=s.extend({},s.CRS.EPSG3857,{code:"EPSG:900913"}),s.CRS.EPSG4326=s.extend({},s.CRS,{code:"EPSG:4326",projection:s.Projection.LonLat,transformation:new s.Transformation(1/360,.5,-1/360,.5)}),s.Map=s.Class.extend({includes:s.Mixin.Events,options:{crs:s.CRS.EPSG3857,fadeAnimation:s.DomUtil.TRANSITION&&!s.Browser.android23,trackResize:!0,markerZoomAnimation:s.DomUtil.TRANSITION&&s.Browser.any3d},initialize:function(t,e){e=s.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=s.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==i&&this.setView(s.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(s.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,n){var i=this.getZoomScale(e),o=this.getSize().divideBy(2),r=t instanceof s.Point?t:this.latLngToContainerPoint(t),a=r.subtract(o).multiplyBy(1-1/i),l=this.containerPointToLatLng(o.add(a));return this.setView(l,e,{zoom:n})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():s.latLngBounds(t);var n=s.point(e.paddingTopLeft||e.padding||[0,0]),i=s.point(e.paddingBottomRight||e.padding||[0,0]),o=this.getBoundsZoom(t,!1,n.add(i));o=e.maxZoom?Math.min(e.maxZoom,o):o;var r=i.subtract(n).divideBy(2),a=this.project(t.getSouthWest(),o),l=this.project(t.getNorthEast(),o),u=this.unproject(a.add(l).divideBy(2).add(r),o);return this.setView(u,o,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(s.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=s.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var n=this.getCenter(),i=this._limitCenter(n,this._zoom,t);return n.equals(i)?this:this.panTo(i,e)},addLayer:function(t){var e=s.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=s.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?s.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=s.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var n=this.getSize(),i=e.divideBy(2).round(),o=n.divideBy(2).round(),r=i.subtract(o);return r.x||r.y?(t.animate&&t.pan?this.panBy(r):(t.pan&&this._rawPanBy(r),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:n})):this},addHandler:function(t,e){if(!e)return this;var n=this[t]=new e(this);return this._handlers.push(n),this.options[t]&&n.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),n=this.unproject(t.getTopRight());return new s.LatLngBounds(e,n)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,n){t=s.latLngBounds(t);var i,o=this.getMinZoom()-(e?1:0),r=this.getMaxZoom(),a=this.getSize(),l=t.getNorthWest(),u=t.getSouthEast(),h=!0;n=s.point(n||[0,0]);do o++,i=this.project(u,o).subtract(this.project(l,o)).add(n),h=e?i.x<a.x||i.y<a.y:a.contains(i);while(h&&r>=o);return h&&e?null:e?o:o-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new s.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new s.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(s.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(s.point(t),e)},layerPointToLatLng:function(t){var e=s.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(s.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return s.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return s.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(s.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(s.latLng(t)))},mouseEventToContainerPoint:function(t){return s.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=s.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;s.DomUtil.addClass(t,"leaflet-container"+(s.Browser.touch?" leaflet-touch":"")+(s.Browser.retina?" leaflet-retina":"")+(s.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=s.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(s.DomUtil.addClass(t.markerPane,e),s.DomUtil.addClass(t.shadowPane,e),s.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return s.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?s.Util.isArray(t)?t:[t]:[];for(var e=0,n=t.length;n>e;e++)this.addLayer(t[e])},_resetView:function(t,e,n,i){var o=this._zoom!==e;i||(this.fire("movestart"),o&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),n?this._initialTopLeftPoint._add(this._getMapPanePos()):s.DomUtil.setPosition(this._mapPane,new s.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var r=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!n}),r&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(o||i)&&this.fire("zoomend"),this.fire("moveend",{hard:!n})},_rawPanBy:function(t){s.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-(1/0),o=this._getZoomSpan();for(t in this._zoomBoundLayers){var s=this._zoomBoundLayers[t];isNaN(s.options.minZoom)||(e=Math.min(e,s.options.minZoom)),isNaN(s.options.maxZoom)||(n=Math.max(n,s.options.maxZoom))}t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=e),o!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(s.DomEvent){e=e||"on",s.DomEvent[e](this._container,"click",this._onMouseClick,this);var n,i,o=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(n=0,i=o.length;i>n;n++)s.DomEvent[e](this._container,o[n],this._fireMouseEvent,this);this.options.trackResize&&s.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){s.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=s.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||s.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!s.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&s.DomEvent.preventDefault(t);var n=this.mouseEventToContainerPoint(t),i=this.containerPointToLayerPoint(n),o=this.layerPointToLatLng(i);this.fire(e,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return s.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var n=this.getSize()._divideBy(2);return this.project(t,e)._subtract(n)._round()},_latLngToNewLayerPoint:function(t,e,n){var i=this._getNewTopLeftPoint(n,e).add(this._getMapPanePos());return this.project(t,e)._subtract(i)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,n){if(!n)return t;var i=this.project(t,e),o=this.getSize().divideBy(2),r=new s.Bounds(i.subtract(o),i.add(o)),a=this._getBoundsOffset(r,n,e);return this.unproject(i.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var n=this.getPixelBounds(),i=new s.Bounds(n.min.add(t),n.max.add(t));return t.add(this._getBoundsOffset(i,e))},_getBoundsOffset:function(t,e,n){var i=this.project(e.getNorthWest(),n).subtract(t.min),o=this.project(e.getSouthEast(),n).subtract(t.max),r=this._rebound(i.x,-o.x),a=this._rebound(i.y,-o.y);return new s.Point(r,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),n=this.getMaxZoom();return Math.max(e,Math.min(n,t))}}),s.map=function(t,e){return new s.Map(t,e)},s.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=s.LatLng.DEG_TO_RAD,n=this.MAX_LATITUDE,i=Math.max(Math.min(n,t.lat),-n),o=this.R_MAJOR,r=this.R_MINOR,a=t.lng*e*o,l=i*e,u=r/o,h=Math.sqrt(1-u*u),c=h*Math.sin(l);c=Math.pow((1-c)/(1+c),.5*h);var d=Math.tan(.5*(.5*Math.PI-l))/c;return l=-o*Math.log(d),new s.Point(a,l)},unproject:function(t){for(var e,n=s.LatLng.RAD_TO_DEG,i=this.R_MAJOR,o=this.R_MINOR,r=t.x*n/i,a=o/i,l=Math.sqrt(1-a*a),u=Math.exp(-t.y/i),h=Math.PI/2-2*Math.atan(u),c=15,d=1e-7,p=c,f=.1;Math.abs(f)>d&&--p>0;)e=l*Math.sin(h),f=Math.PI/2-2*Math.atan(u*Math.pow((1-e)/(1+e),.5*l))-h,h+=f;return new s.LatLng(h*n,r)}},s.CRS.EPSG3395=s.extend({},s.CRS,{code:"EPSG:3395",projection:s.Projection.Mercator,transformation:function(){var t=s.Projection.Mercator,e=t.R_MAJOR,n=.5/(Math.PI*e);return new s.Transformation(n,.5,-n,.5)}()}),s.TileLayer=s.Class.extend({includes:s.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:s.Browser.mobile,updateWhenIdle:s.Browser.mobile},initialize:function(t,e){e=s.setOptions(this,e),e.detectRetina&&s.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=s.latLngBounds(e.bounds)),this._url=t;var n=this.options.subdomains;"string"==typeof n&&(this.options.subdomains=n.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=s.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var n,i,o,s=t.children,r=-e(1/0,-(1/0));for(i=0,o=s.length;o>i;i++)s[i]!==this._container&&(n=parseInt(s[i].style.zIndex,10),isNaN(n)||(r=e(r,n)));this.options.zIndex=this._container.style.zIndex=(isFinite(r)?r:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(s.Browser.ielt9)for(t in e)s.DomUtil.setOpacity(e[t],this.options.opacity);else s.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=s.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=s.DomUtil.create("div",e,this._container),this._tileContainer=s.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,n=this.options.maxNativeZoom,i=this.options.tileSize;return n&&e>n&&(i=Math.round(t.getZoomScale(e)/t.getZoomScale(n)*i)),i},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),n=t.getZoom(),i=this._getTileSize();if(!(n>this.options.maxZoom||n<this.options.minZoom)){var o=s.bounds(e.min.divideBy(i)._floor(),e.max.divideBy(i)._floor());this._addTilesFromCenterOut(o),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(o)}}},_addTilesFromCenterOut:function(t){var e,i,o,r=[],a=t.getCenter();for(e=t.min.y;e<=t.max.y;e++)for(i=t.min.x;i<=t.max.x;i++)o=new s.Point(i,e),this._tileShouldBeLoaded(o)&&r.push(o);var l=r.length;if(0!==l){r.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var u=n.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=l,i=0;l>i;i++)this._addTile(r[i],u);this._tileContainer.appendChild(u)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var n=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=n.x)||t.y<0||t.y>=n.y)return!1}if(e.bounds){var i=this._getTileSize(),o=t.multiplyBy(i),s=o.add([i,i]),r=this._map.unproject(o),a=this._map.unproject(s);if(e.continuousWorld||e.noWrap||(r=r.wrap(),a=a.wrap()),!e.bounds.intersects([r,a]))return!1}return!0},_removeOtherTiles:function(t){var e,n,i,o;for(o in this._tiles)e=o.split(":"),n=parseInt(e[0],10),i=parseInt(e[1],10),(n<t.min.x||n>t.max.x||i<t.min.y||i>t.max.y)&&this._removeTile(o)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(s.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),s.Browser.android||(e.onload=null,e.src=s.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var n=this._getTilePos(t),i=this._getTile();s.DomUtil.setPosition(i,n,s.Browser.chrome),this._tiles[t.x+":"+t.y]=i,this._loadTile(i,t),i.parentNode!==this._tileContainer&&e.appendChild(i)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),n=this._getTileSize();return t.multiplyBy(n).subtract(e)},getTileUrl:function(t){return s.Util.template(this._url,s.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=s.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=s.Util.falseFn,s.Browser.ielt9&&this.options.opacity!==i&&s.DomUtil.setOpacity(t,this.options.opacity),s.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&s.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(s.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==s.Util.emptyImageUrl&&(s.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),s.tileLayer=function(t,e){return new s.TileLayer(t,e)},s.TileLayer.WMS=s.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var n=s.extend({},this.defaultWmsParams),i=e.tileSize||this.options.tileSize;e.detectRetina&&s.Browser.retina?n.width=n.height=2*i:n.width=n.height=i;for(var o in e)this.options.hasOwnProperty(o)||"crs"===o||(n[o]=e[o]);this.wmsParams=n,s.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,s.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,n=this.options.tileSize,i=t.multiplyBy(n),o=i.add([n,n]),r=this._crs.project(e.unproject(i,t.z)),a=this._crs.project(e.unproject(o,t.z)),l=this._wmsVersion>=1.3&&this._crs===s.CRS.EPSG4326?[a.y,r.x,r.y,a.x].join(","):[r.x,a.y,a.x,r.y].join(","),u=s.Util.template(this._url,{s:this._getSubdomain(t)});return u+s.Util.getParamString(this.wmsParams,u,!0)+"&BBOX="+l},setParams:function(t,e){return s.extend(this.wmsParams,t),e||this.redraw(),this}}),s.tileLayer.wms=function(t,e){return new s.TileLayer.WMS(t,e)},s.TileLayer.Canvas=s.TileLayer.extend({options:{async:!1},initialize:function(t){s.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=s.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=s.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),s.tileLayer.canvas=function(t){return new s.TileLayer.Canvas(t)},s.ImageOverlay=s.Class.extend({includes:s.Mixin.Events,options:{opacity:1},initialize:function(t,e,n){this._url=t,this._bounds=s.latLngBounds(e),s.setOptions(this,n)},onAdd:function(t){this._map=t,this._image||this._initImage(),
t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&s.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=s.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&s.Browser.any3d?s.DomUtil.addClass(this._image,"leaflet-zoom-animated"):s.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),s.extend(this._image,{galleryimg:"no",onselectstart:s.Util.falseFn,onmousemove:s.Util.falseFn,onload:s.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,n=this._image,i=e.getZoomScale(t.zoom),o=this._bounds.getNorthWest(),r=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(o,t.zoom,t.center),l=e._latLngToNewLayerPoint(r,t.zoom,t.center)._subtract(a),u=a._add(l._multiplyBy(.5*(1-1/i)));n.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(u)+" scale("+i+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),n=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);s.DomUtil.setPosition(t,e),t.style.width=n.x+"px",t.style.height=n.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){s.DomUtil.setOpacity(this._image,this.options.opacity)}}),s.imageOverlay=function(t,e,n){return new s.ImageOverlay(t,e,n)},s.Icon=s.Class.extend({options:{className:""},initialize:function(t){s.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var n=this._getIconUrl(t);if(!n){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var i;return i=e&&"IMG"===e.tagName?this._createImg(n,e):this._createImg(n),this._setIconStyles(i,t),i},_setIconStyles:function(t,e){var n,i=this.options,o=s.point(i[e+"Size"]);n="shadow"===e?s.point(i.shadowAnchor||i.iconAnchor):s.point(i.iconAnchor),!n&&o&&(n=o.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+i.className,n&&(t.style.marginLeft=-n.x+"px",t.style.marginTop=-n.y+"px"),o&&(t.style.width=o.x+"px",t.style.height=o.y+"px")},_createImg:function(t,e){return e=e||n.createElement("img"),e.src=t,e},_getIconUrl:function(t){return s.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),s.icon=function(t){return new s.Icon(t)},s.Icon.Default=s.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];s.Browser.retina&&"icon"===t&&(t+="-2x");var n=s.Icon.Default.imagePath;if(!n)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return n+"/marker-"+t+".png"}}),s.Icon.Default.imagePath=function(){var t,e,i,o,s,r=n.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,e=r.length;e>t;t++)if(i=r[t].src,o=i.match(a))return s=i.split(a)[0],(s?s+"/":"")+"images"}(),s.Marker=s.Class.extend({includes:s.Mixin.Events,options:{icon:new s.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){s.setOptions(this,e),this._latlng=s.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){return this._icon&&this._setPos(this._map.latLngToLayerPoint(this._latlng).round()),this},_initIcon:function(){var t=this.options,e=this._map,n=e.options.zoomAnimation&&e.options.markerZoomAnimation,i=n?"leaflet-zoom-animated":"leaflet-zoom-hide",o=t.icon.createIcon(this._icon),r=!1;o!==this._icon&&(this._icon&&this._removeIcon(),r=!0,t.title&&(o.title=t.title),t.alt&&(o.alt=t.alt)),s.DomUtil.addClass(o,i),t.keyboard&&(o.tabIndex="0"),this._icon=o,this._initInteraction(),t.riseOnHover&&s.DomEvent.on(o,"mouseover",this._bringToFront,this).on(o,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),l=!1;a!==this._shadow&&(this._removeShadow(),l=!0),a&&s.DomUtil.addClass(a,i),this._shadow=a,t.opacity<1&&this._updateOpacity();var u=this._map._panes;r&&u.markerPane.appendChild(this._icon),a&&l&&u.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&s.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){s.DomUtil.setPosition(this._icon,t),this._shadow&&s.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];s.DomUtil.addClass(t,"leaflet-clickable"),s.DomEvent.on(t,"click",this._onMouseClick,this),s.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var n=0;n<e.length;n++)s.DomEvent.on(t,e[n],this._fireMouseEvent,this);s.Handler.MarkerDrag&&(this.dragging=new s.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&s.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&s.DomEvent.preventDefault(t),"mousedown"!==t.type?s.DomEvent.stopPropagation(t):s.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){s.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&s.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),s.marker=function(t,e){return new s.Marker(t,e)},s.DivIcon=s.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var e=t&&"DIV"===t.tagName?t:n.createElement("div"),i=this.options;return i.html!==!1?e.innerHTML=i.html:e.innerHTML="",i.bgPos&&(e.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(e,"icon"),e},createShadow:function(){return null}}),s.divIcon=function(t){return new s.DivIcon(t)},s.Map.mergeOptions({closePopupOnClick:!0}),s.Popup=s.Class.extend({includes:s.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){s.setOptions(this,t),this._source=e,this._animated=s.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&s.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&s.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),s.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&s.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",n=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),i=this._container=s.DomUtil.create("div",n);this.options.closeButton&&(t=this._closeButton=s.DomUtil.create("a",e+"-close-button",i),t.href="#close",t.innerHTML="&#215;",s.DomEvent.disableClickPropagation(t),s.DomEvent.on(t,"click",this._onCloseButtonClick,this));var o=this._wrapper=s.DomUtil.create("div",e+"-content-wrapper",i);s.DomEvent.disableClickPropagation(o),this._contentNode=s.DomUtil.create("div",e+"-content",o),s.DomEvent.disableScrollPropagation(this._contentNode),s.DomEvent.on(o,"contextmenu",s.DomEvent.stopPropagation),this._tipContainer=s.DomUtil.create("div",e+"-tip-container",i),this._tip=s.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var n=t.offsetWidth;n=Math.min(n,this.options.maxWidth),n=Math.max(n,this.options.minWidth),e.width=n+1+"px",e.whiteSpace="",e.height="";var i=t.offsetHeight,o=this.options.maxHeight,r="leaflet-popup-scrolled";o&&i>o?(e.height=o+"px",s.DomUtil.addClass(t,r)):s.DomUtil.removeClass(t,r),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,n=s.point(this.options.offset);e&&s.DomUtil.setPosition(this._container,t),this._containerBottom=-n.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+n.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);s.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,n=this._containerWidth,i=new s.Point(this._containerLeft,-e-this._containerBottom);this._animated&&i._add(s.DomUtil.getPosition(this._container));var o=t.layerPointToContainerPoint(i),r=s.point(this.options.autoPanPadding),a=s.point(this.options.autoPanPaddingTopLeft||r),l=s.point(this.options.autoPanPaddingBottomRight||r),u=t.getSize(),h=0,c=0;o.x+n+l.x>u.x&&(h=o.x+n-u.x+l.x),o.x-h-a.x<0&&(h=o.x-a.x),o.y+e+l.y>u.y&&(c=o.y+e-u.y+l.y),o.y-c-a.y<0&&(c=o.y-a.y),(h||c)&&t.fire("autopanstart").panBy([h,c])}},_onCloseButtonClick:function(t){this._close(),s.DomEvent.stop(t)}}),s.popup=function(t,e){return new s.Popup(t,e)},s.Map.include({openPopup:function(t,e,n){if(this.closePopup(),!(t instanceof s.Popup)){var i=t;t=new s.Popup(n).setLatLng(e).setContent(i)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),s.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var n=s.point(this.options.icon.options.popupAnchor||[0,0]);return n=n.add(s.Popup.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=s.extend({offset:n},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof s.Popup?(s.setOptions(t,e),this._popup=t,t._source=this):this._popup=new s.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),s.LayerGroup=s.Class.extend({initialize:function(t){this._layers={};var e,n;if(t)for(e=0,n=t.length;n>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,n,i=Array.prototype.slice.call(arguments,1);for(e in this._layers)n=this._layers[e],n[t]&&n[t].apply(n,i);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var n in this._layers)t.call(e,this._layers[n]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s.stamp(t)}}),s.layerGroup=function(t){return new s.LayerGroup(t)},s.FeatureGroup=s.LayerGroup.extend({includes:s.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),"off"in t&&t.off(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new s.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof s.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=s.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),s.featureGroup=function(t){return new s.FeatureGroup(t)},s.Path=s.Class.extend({includes:[s.Mixin.Events],statics:{CLIP_PADDING:function(){var e=s.Browser.mobile?1280:2e3,n=(e/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,n))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){s.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,s.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return s.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),s.Map.include({_updatePathViewport:function(){var t=s.Path.CLIP_PADDING,e=this.getSize(),n=s.DomUtil.getPosition(this._mapPane),i=n.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),o=i.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new s.Bounds(i,o)}}),s.Path.SVG_NS="http://www.w3.org/2000/svg",s.Browser.svg=!(!n.createElementNS||!n.createElementNS(s.Path.SVG_NS,"svg").createSVGRect),s.Path=s.Path.extend({statics:{SVG:s.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,n=t.firstChild;return e&&n!==e&&t.insertBefore(e,n),this},getPathString:function(){},_createElement:function(t){return n.createElementNS(s.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&s.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(s.Browser.svg||!s.Browser.vml)&&s.DomUtil.addClass(this._path,"leaflet-clickable"),s.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)s.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this._map&&this.hasEventListeners(t.type)){var e=this._map,n=e.mouseEventToContainerPoint(t),i=e.containerPointToLayerPoint(n),o=e.layerPointToLatLng(i);this.fire(t.type,{latlng:o,layerPoint:i,containerPoint:n,originalEvent:t}),"contextmenu"===t.type&&s.DomEvent.preventDefault(t),"mousemove"!==t.type&&s.DomEvent.stopPropagation(t)}}}),s.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=s.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&s.Browser.any3d?(s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),n=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(n)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max,i=n.x-e.x,o=n.y-e.y,r=this._pathRoot,a=this._panes.overlayPane;s.Browser.mobileWebkit&&a.removeChild(r),s.DomUtil.setPosition(r,e),r.setAttribute("width",i),r.setAttribute("height",o),r.setAttribute("viewBox",[e.x,e.y,i,o].join(" ")),s.Browser.mobileWebkit&&a.appendChild(r)}}}),s.Path.include({bindPopup:function(t,e){return t instanceof s.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new s.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),s.Browser.vml=!s.Browser.svg&&function(){try{var t=n.createElement("div");t.innerHTML='<v:shape adj="1"/>';var e=t.firstChild;return e.style.behavior="url(#default#VML)",e&&"object"==typeof e.adj}catch(i){return!1}}(),s.Path=s.Browser.svg||!s.Browser.vml?s.Path:s.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return n.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return n.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return n.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");s.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&s.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,n=this.options,i=this._container;i.stroked=n.stroke,i.filled=n.fill,n.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",i.appendChild(t)),t.weight=n.weight+"px",t.color=n.color,t.opacity=n.opacity,n.dashArray?t.dashStyle=s.Util.isArray(n.dashArray)?n.dashArray.join(" "):n.dashArray.replace(/( *, *)/g," "):t.dashStyle="",n.lineCap&&(t.endcap=n.lineCap.replace("butt","flat")),n.lineJoin&&(t.joinstyle=n.lineJoin)):t&&(i.removeChild(t),this._stroke=null),n.fill?(e||(e=this._fill=this._createElement("fill"),i.appendChild(e)),e.color=n.fillColor||n.color,e.opacity=n.fillOpacity):e&&(i.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),s.Map.include(s.Browser.svg||!s.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=n.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),s.Browser.canvas=function(){return!!n.createElement("canvas").getContext}(),s.Path=s.Path.SVG&&!t.L_PREFER_CANVAS||!s.Browser.canvas?s.Path:s.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return s.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!s.Path._updateRequest&&(s.Path._updateRequest=s.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){s.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color),t.lineCap&&(this._ctx.lineCap=t.lineCap),t.lineJoin&&(this._ctx.lineJoin=t.lineJoin)},_drawPath:function(){var t,e,n,i,o,r;for(this._ctx.beginPath(),t=0,n=this._parts.length;n>t;t++){for(e=0,i=this._parts[t].length;i>e;e++)o=this._parts[t][e],r=(0===e?"move":"line")+"To",this._ctx[r](o.x,o.y);this instanceof s.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill(e.fillRule||"evenodd")),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click dblclick contextmenu",this._fireMouseEvent,this))},_fireMouseEvent:function(t){this._containsPoint(t.layerPoint)&&this.fire(t.type,t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),s.Map.include(s.Path.SVG&&!t.L_PREFER_CANVAS||!s.Browser.canvas?{}:{_initPathRoot:function(){var t,e=this._pathRoot;e||(e=this._pathRoot=n.createElement("canvas"),e.style.position="absolute",t=this._canvasCtx=e.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(e),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,n=t.max.subtract(e),i=this._pathRoot;s.DomUtil.setPosition(i,e),i.width=n.x,i.height=n.y,i.getContext("2d").translate(-e.x,-e.y)}}}),s.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var n=e*e;return t=this._reducePoints(t,n),t=this._simplifyDP(t,n)},pointToSegmentDistance:function(t,e,n){return Math.sqrt(this._sqClosestPointOnSegment(t,e,n,!0))},closestPointOnSegment:function(t,e,n){return this._sqClosestPointOnSegment(t,e,n)},_simplifyDP:function(t,e){var n=t.length,o=typeof Uint8Array!=i+""?Uint8Array:Array,s=new o(n);s[0]=s[n-1]=1,this._simplifyDPStep(t,s,e,0,n-1);var r,a=[];for(r=0;n>r;r++)s[r]&&a.push(t[r]);return a},_simplifyDPStep:function(t,e,n,i,o){var s,r,a,l=0;for(r=i+1;o-1>=r;r++)a=this._sqClosestPointOnSegment(t[r],t[i],t[o],!0),a>l&&(s=r,l=a);l>n&&(e[s]=1,this._simplifyDPStep(t,e,n,i,s),this._simplifyDPStep(t,e,n,s,o))},_reducePoints:function(t,e){for(var n=[t[0]],i=1,o=0,s=t.length;s>i;i++)this._sqDist(t[i],t[o])>e&&(n.push(t[i]),o=i);return s-1>o&&n.push(t[s-1]),n},clipSegment:function(t,e,n,i){var o,s,r,a=i?this._lastCode:this._getBitCode(t,n),l=this._getBitCode(e,n);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;o=a||l,s=this._getEdgeIntersection(t,e,o,n),r=this._getBitCode(s,n),o===a?(t=s,a=r):(e=s,l=r)}},_getEdgeIntersection:function(t,e,n,i){var o=e.x-t.x,r=e.y-t.y,a=i.min,l=i.max;return 8&n?new s.Point(t.x+o*(l.y-t.y)/r,l.y):4&n?new s.Point(t.x+o*(a.y-t.y)/r,a.y):2&n?new s.Point(l.x,t.y+r*(l.x-t.x)/o):1&n?new s.Point(a.x,t.y+r*(a.x-t.x)/o):void 0},_getBitCode:function(t,e){var n=0;return t.x<e.min.x?n|=1:t.x>e.max.x&&(n|=2),t.y<e.min.y?n|=4:t.y>e.max.y&&(n|=8),n},_sqDist:function(t,e){var n=e.x-t.x,i=e.y-t.y;return n*n+i*i},_sqClosestPointOnSegment:function(t,e,n,i){var o,r=e.x,a=e.y,l=n.x-r,u=n.y-a,h=l*l+u*u;return h>0&&(o=((t.x-r)*l+(t.y-a)*u)/h,o>1?(r=n.x,a=n.y):o>0&&(r+=l*o,a+=u*o)),l=t.x-r,u=t.y-a,i?l*l+u*u:new s.Point(r,a)}},s.Polyline=s.Path.extend({initialize:function(t,e){s.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,n="";e>t;t++)n+=this._getPathPartStr(this._parts[t]);return n},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(s.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,n,i=1/0,o=this._parts,r=null,a=0,l=o.length;l>a;a++)for(var u=o[a],h=1,c=u.length;c>h;h++){e=u[h-1],n=u[h];var d=s.LineUtil._sqClosestPointOnSegment(t,e,n,!0);i>d&&(i=d,r=s.LineUtil._sqClosestPointOnSegment(t,e,n))}return r&&(r.distance=Math.sqrt(i)),r},getBounds:function(){return new s.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var n,i,o=e?t:[];for(n=0,i=t.length;i>n;n++){if(s.Util.isArray(t[n])&&"number"!=typeof t[n][0])return;o[n]=s.latLng(t[n])}return o},_initEvents:function(){s.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,n=s.Path.VML,i=0,o=t.length,r="";o>i;i++)e=t[i],
n&&e._round(),r+=(i?"L":"M")+e.x+" "+e.y;return r},_clipPoints:function(){var t,e,n,i=this._originalPoints,o=i.length;if(this.options.noClip)return void(this._parts=[i]);this._parts=[];var r=this._parts,a=this._map._pathViewport,l=s.LineUtil;for(t=0,e=0;o-1>t;t++)n=l.clipSegment(i[t],i[t+1],a,t),n&&(r[e]=r[e]||[],r[e].push(n[0]),(n[1]!==i[t+1]||t===o-2)&&(r[e].push(n[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=s.LineUtil,n=0,i=t.length;i>n;n++)t[n]=e.simplify(t[n],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),s.Path.prototype._updatePath.call(this))}}),s.polyline=function(t,e){return new s.Polyline(t,e)},s.PolyUtil={},s.PolyUtil.clipPolygon=function(t,e){var n,i,o,r,a,l,u,h,c,d=[1,4,2,8],p=s.LineUtil;for(i=0,u=t.length;u>i;i++)t[i]._code=p._getBitCode(t[i],e);for(r=0;4>r;r++){for(h=d[r],n=[],i=0,u=t.length,o=u-1;u>i;o=i++)a=t[i],l=t[o],a._code&h?l._code&h||(c=p._getEdgeIntersection(l,a,h,e),c._code=p._getBitCode(c,e),n.push(c)):(l._code&h&&(c=p._getEdgeIntersection(l,a,h,e),c._code=p._getBitCode(c,e),n.push(c)),n.push(a));t=n}return t},s.Polygon=s.Polyline.extend({options:{fill:!0},initialize:function(t,e){s.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,n,i;if(t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,n=this._holes.length;n>e;e++)i=this._holes[e]=this._convertLatLngs(this._holes[e]),i[0].equals(i[i.length-1])&&i.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(s.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,n,i;for(t=0,n=this._holes.length;n>t;t++)for(this._holePoints[t]=[],e=0,i=this._holes[t].length;i>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):s.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var n=0,i=this._parts.length;i>n;n++){var o=s.PolyUtil.clipPolygon(this._parts[n],this._map._pathViewport);o.length&&e.push(o)}this._parts=e}},_getPathPartStr:function(t){var e=s.Polyline.prototype._getPathPartStr.call(this,t);return e+(s.Browser.svg?"z":"x")}}),s.polygon=function(t,e){return new s.Polygon(t,e)},function(){function t(t){return s.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var n=0,i=e.length;for(this.eachLayer(function(t){i>n?t.setLatLngs(e[n++]):this.removeLayer(t)},this);i>n;)this.addLayer(new t(e[n++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}s.MultiPolyline=t(s.Polyline),s.MultiPolygon=t(s.Polygon),s.multiPolyline=function(t,e){return new s.MultiPolyline(t,e)},s.multiPolygon=function(t,e){return new s.MultiPolygon(t,e)}}(),s.Rectangle=s.Polygon.extend({initialize:function(t,e){s.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=s.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),s.rectangle=function(t,e){return new s.Rectangle(t,e)},s.Circle=s.Path.extend({initialize:function(t,e,n){s.Path.prototype.initialize.call(this,n),this._latlng=s.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=s.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,n=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-n.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,n=this._latlng;return new s.LatLngBounds([n.lat-e,n.lng-t],[n.lat+e,n.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":s.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(s.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,n=this._point;return n.x-e>t.max.x||n.y-e>t.max.y||n.x+e<t.min.x||n.y+e<t.min.y}}),s.circle=function(t,e,n){return new s.Circle(t,e,n)},s.CircleMarker=s.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){s.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){s.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return s.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),s.circleMarker=function(t,e){return new s.CircleMarker(t,e)},s.Polyline.include(s.Path.CANVAS?{_containsPoint:function(t,e){var n,i,o,r,a,l,u,h=this.options.weight/2;for(s.Browser.touch&&(h+=10),n=0,r=this._parts.length;r>n;n++)for(u=this._parts[n],i=0,a=u.length,o=a-1;a>i;o=i++)if((e||0!==i)&&(l=s.LineUtil.pointToSegmentDistance(t,u[o],u[i]),h>=l))return!0;return!1}}:{}),s.Polygon.include(s.Path.CANVAS?{_containsPoint:function(t){var e,n,i,o,r,a,l,u,h=!1;if(s.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(o=0,l=this._parts.length;l>o;o++)for(e=this._parts[o],r=0,u=e.length,a=u-1;u>r;a=r++)n=e[r],i=e[a],n.y>t.y!=i.y>t.y&&t.x<(i.x-n.x)*(t.y-n.y)/(i.y-n.y)+n.x&&(h=!h);return h}}:{}),s.Circle.include(s.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,n=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+n}}:{}),s.CircleMarker.include(s.Path.CANVAS?{_updateStyle:function(){s.Path.prototype._updateStyle.call(this)}}:{}),s.GeoJSON=s.FeatureGroup.extend({initialize:function(t,e){s.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,n,i,o=s.Util.isArray(t)?t:t.features;if(o){for(e=0,n=o.length;n>e;e++)i=o[e],(i.geometries||i.geometry||i.features||i.coordinates)&&this.addData(o[e]);return this}var r=this.options;if(!r.filter||r.filter(t)){var a=s.GeoJSON.geometryToLayer(t,r.pointToLayer,r.coordsToLatLng,r);return a.feature=s.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),r.onEachFeature&&r.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(s.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),s.extend(s.GeoJSON,{geometryToLayer:function(t,e,n,i){var o,r,a,l,u="Feature"===t.type?t.geometry:t,h=u.coordinates,c=[];switch(n=n||this.coordsToLatLng,u.type){case"Point":return o=n(h),e?e(t,o):new s.Marker(o);case"MultiPoint":for(a=0,l=h.length;l>a;a++)o=n(h[a]),c.push(e?e(t,o):new s.Marker(o));return new s.FeatureGroup(c);case"LineString":return r=this.coordsToLatLngs(h,0,n),new s.Polyline(r,i);case"Polygon":if(2===h.length&&!h[1].length)throw new Error("Invalid GeoJSON object.");return r=this.coordsToLatLngs(h,1,n),new s.Polygon(r,i);case"MultiLineString":return r=this.coordsToLatLngs(h,1,n),new s.MultiPolyline(r,i);case"MultiPolygon":return r=this.coordsToLatLngs(h,2,n),new s.MultiPolygon(r,i);case"GeometryCollection":for(a=0,l=u.geometries.length;l>a;a++)c.push(this.geometryToLayer({geometry:u.geometries[a],type:"Feature",properties:t.properties},e,n,i));return new s.FeatureGroup(c);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new s.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,n){var i,o,s,r=[];for(o=0,s=t.length;s>o;o++)i=e?this.coordsToLatLngs(t[o],e-1,n):(n||this.coordsToLatLng)(t[o]),r.push(i);return r},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==i&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],n=0,i=t.length;i>n;n++)e.push(s.GeoJSON.latLngToCoords(t[n]));return e},getFeature:function(t,e){return t.feature?s.extend({},t.feature,{geometry:e}):s.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var a={toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"Point",coordinates:s.GeoJSON.latLngToCoords(this.getLatLng())})}};s.Marker.include(a),s.Circle.include(a),s.CircleMarker.include(a),s.Polyline.include({toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"LineString",coordinates:s.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),s.Polygon.include({toGeoJSON:function(){var t,e,n,i=[s.GeoJSON.latLngsToCoords(this.getLatLngs())];if(i[0].push(i[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)n=s.GeoJSON.latLngsToCoords(this._holes[t]),n.push(n[0]),i.push(n);return s.GeoJSON.getFeature(this,{type:"Polygon",coordinates:i})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),s.GeoJSON.getFeature(this,{type:t,coordinates:e})}}s.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),s.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),s.LayerGroup.include({toGeoJSON:function(){var e,n=this.feature&&this.feature.geometry,i=[];if(n&&"MultiPoint"===n.type)return t("MultiPoint").call(this);var o=n&&"GeometryCollection"===n.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),i.push(o?e.geometry:s.GeoJSON.asFeature(e)))}),o?s.GeoJSON.getFeature(this,{geometries:i,type:"GeometryCollection"}):{type:"FeatureCollection",features:i}}})}(),s.geoJson=function(t,e){return new s.GeoJSON(t,e)},s.DomEvent={addListener:function(t,e,n,i){var o,r,a,l=s.stamp(n),u="_leaflet_"+e+l;return t[u]?this:(o=function(e){return n.call(i||t,e||s.DomEvent._getEvent())},s.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,o,l):(s.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,o,l),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",o,!1),t.addEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?(r=o,a="mouseenter"===e?"mouseover":"mouseout",o=function(e){return s.DomEvent._checkMouse(t,e)?r(e):void 0},t.addEventListener(a,o,!1)):"click"===e&&s.Browser.android?(r=o,o=function(t){return s.DomEvent._filterClick(t,r)},t.addEventListener(e,o,!1)):t.addEventListener(e,o,!1):"attachEvent"in t&&t.attachEvent("on"+e,o),t[u]=o,this))},removeListener:function(t,e,n){var i=s.stamp(n),o="_leaflet_"+e+i,r=t[o];return r?(s.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,i):s.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,i):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",r,!1),t.removeEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",r,!1):t.removeEventListener(e,r,!1):"detachEvent"in t&&t.detachEvent("on"+e,r),t[o]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,s.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=s.DomEvent.stopPropagation;return s.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=s.DomEvent.stopPropagation,n=s.Draggable.START.length-1;n>=0;n--)s.DomEvent.on(t,s.Draggable.START[n],e);return s.DomEvent.on(t,"click",s.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return s.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new s.Point(t.clientX,t.clientY);var n=e.getBoundingClientRect();return new s.Point(t.clientX-n.left-e.clientLeft,t.clientY-n.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){s.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var n=e.relatedTarget;if(!n)return!0;try{for(;n&&n!==t;)n=n.parentNode}catch(i){return!1}return n!==t},_getEvent:function(){var e=t.event;if(!e)for(var n=arguments.callee.caller;n&&(e=n.arguments[0],!e||t.Event!==e.constructor);)n=n.caller;return e},_filterClick:function(t,e){var n=t.timeStamp||t.originalEvent.timeStamp,i=s.DomEvent._lastClick&&n-s.DomEvent._lastClick;return i&&i>100&&500>i||t.target._simulatedClick&&!t._simulated?void s.DomEvent.stop(t):(s.DomEvent._lastClick=n,e(t))}},s.DomEvent.on=s.DomEvent.addListener,s.DomEvent.off=s.DomEvent.removeListener,s.Draggable=s.Class.extend({includes:s.Mixin.Events,statics:{START:s.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.on(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.off(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!t.shiftKey&&(1===t.which||1===t.button||t.touches)&&(s.DomEvent.stopPropagation(t),!s.Draggable._disabled&&(s.DomUtil.disableImageDrag(),s.DomUtil.disableTextSelection(),!this._moving))){var e=t.touches?t.touches[0]:t;this._startPoint=new s.Point(e.clientX,e.clientY),this._startPos=this._newPos=s.DomUtil.getPosition(this._element),s.DomEvent.on(n,s.Draggable.MOVE[t.type],this._onMove,this).on(n,s.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var e=t.touches&&1===t.touches.length?t.touches[0]:t,i=new s.Point(e.clientX,e.clientY),o=i.subtract(this._startPoint);(o.x||o.y)&&(s.Browser.touch&&Math.abs(o.x)+Math.abs(o.y)<3||(s.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=s.DomUtil.getPosition(this._element).subtract(o),s.DomUtil.addClass(n.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,s.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(o),this._moving=!0,s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),s.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){s.DomUtil.removeClass(n.body,"leaflet-dragging"),this._lastTarget&&(s.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in s.Draggable.MOVE)s.DomEvent.off(n,s.Draggable.MOVE[t],this._onMove).off(n,s.Draggable.END[t],this._onUp);s.DomUtil.enableImageDrag(),s.DomUtil.enableTextSelection(),this._moved&&this._moving&&(s.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),s.Handler=s.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),s.Map.mergeOptions({dragging:!0,inertia:!s.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:s.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),s.Map.Drag=s.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new s.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),n=this._initialWorldOffset,i=this._draggable._newPos.x,o=(i-e+n)%t+e-n,s=(i+e+n)%t-e-n,r=Math.abs(o+n)<Math.abs(s+n)?o:s;this._draggable._newPos.x=r},_onDragEnd:function(t){var e=this._map,n=e.options,i=+new Date-this._lastTime,o=!n.inertia||i>n.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),o)e.fire("moveend");else{var r=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+i-this._times[0])/1e3,l=n.easeLinearity,u=r.multiplyBy(l/a),h=u.distanceTo([0,0]),c=Math.min(n.inertiaMaxSpeed,h),d=u.multiplyBy(c/h),p=c/(n.inertiaDeceleration*l),f=d.multiplyBy(-p/2).round();f.x&&f.y?(f=e._limitOffset(f,e.options.maxBounds),s.Util.requestAnimFrame(function(){e.panBy(f,{duration:p,easeLinearity:l,noMoveStart:!0})})):e.fire("moveend")}}}),s.Map.addInitHook("addHandler","dragging",s.Map.Drag),s.Map.mergeOptions({doubleClickZoom:!0}),s.Map.DoubleClickZoom=s.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,n=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(n):e.setZoomAround(t.containerPoint,n)}}),s.Map.addInitHook("addHandler","doubleClickZoom",s.Map.DoubleClickZoom),s.Map.mergeOptions({scrollWheelZoom:!0}),s.Map.ScrollWheelZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),s.DomEvent.on(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault),this._delta=0},removeHooks:function(){s.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),s.DomEvent.off(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=s.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var n=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s.bind(this._performZoom,this),n),s.DomEvent.preventDefault(t),s.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,n=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(n+e)-n,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(n+e):t.setZoomAround(this._lastMousePos,n+e))}}),s.Map.addInitHook("addHandler","scrollWheelZoom",s.Map.ScrollWheelZoom),s.extend(s.DomEvent,{_touchstart:s.Browser.msPointer?"MSPointerDown":s.Browser.pointer?"pointerdown":"touchstart",_touchend:s.Browser.msPointer?"MSPointerUp":s.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,e,i){function o(t){var e;if(s.Browser.pointer?(f.push(t.pointerId),e=f.length):e=t.touches.length,!(e>1)){var n=Date.now(),i=n-(a||n);l=t.touches?t.touches[0]:t,u=i>0&&h>=i,a=n}}function r(t){if(s.Browser.pointer){var n=f.indexOf(t.pointerId);if(-1===n)return;f.splice(n,1)}if(u){if(s.Browser.pointer){var i,o={};for(var r in l)i=l[r],"function"==typeof i?o[r]=i.bind(l):o[r]=i;l=o}l.type="dblclick",e(l),a=null}}var a,l,u=!1,h=250,c="_leaflet_",d=this._touchstart,p=this._touchend,f=[];t[c+d+i]=o,t[c+p+i]=r;var m=s.Browser.pointer?n.documentElement:t;return t.addEventListener(d,o,!1),m.addEventListener(p,r,!1),s.Browser.pointer&&m.addEventListener(s.DomEvent.POINTER_CANCEL,r,!1),this},removeDoubleTapListener:function(t,e){var i="_leaflet_";return t.removeEventListener(this._touchstart,t[i+this._touchstart+e],!1),(s.Browser.pointer?n.documentElement:t).removeEventListener(this._touchend,t[i+this._touchend+e],!1),s.Browser.pointer&&n.documentElement.removeEventListener(s.DomEvent.POINTER_CANCEL,t[i+this._touchend+e],!1),this}}),s.extend(s.DomEvent,{POINTER_DOWN:s.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:s.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:s.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:s.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,n,i){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,n,i);case"touchend":return this.addPointerListenerEnd(t,e,n,i);case"touchmove":return this.addPointerListenerMove(t,e,n,i);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,e,i,o){var r="_leaflet_",a=this._pointers,l=function(t){"mouse"!==t.pointerType&&t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&s.DomEvent.preventDefault(t);for(var e=!1,n=0;n<a.length;n++)if(a[n].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],i(t)};if(t[r+"touchstart"+o]=l,t.addEventListener(this.POINTER_DOWN,l,!1),!this._pointerDocumentListener){var u=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};n.documentElement.addEventListener(this.POINTER_UP,u,!1),n.documentElement.addEventListener(this.POINTER_CANCEL,u,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,n,i){function o(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r[e]=t;break}t.touches=r.slice(),t.changedTouches=[t],n(t)}}var s="_leaflet_",r=this._pointers;return t[s+"touchmove"+i]=o,t.addEventListener(this.POINTER_MOVE,o,!1),this},addPointerListenerEnd:function(t,e,n,i){var o="_leaflet_",s=this._pointers,r=function(t){for(var e=0;e<s.length;e++)if(s[e].pointerId===t.pointerId){s.splice(e,1);break}t.touches=s.slice(),t.changedTouches=[t],n(t)};return t[o+"touchend"+i]=r,t.addEventListener(this.POINTER_UP,r,!1),t.addEventListener(this.POINTER_CANCEL,r,!1),this},removePointerListener:function(t,e,n){var i="_leaflet_",o=t[i+e+n];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,o,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,o,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,o,!1),t.removeEventListener(this.POINTER_CANCEL,o,!1)}return this}}),s.Map.mergeOptions({touchZoom:s.Browser.touch&&!s.Browser.android23,bounceAtZoomLimits:!0}),s.Map.TouchZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&!e._animatingZoom&&!this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),o=e.mouseEventToLayerPoint(t.touches[1]),r=e._getCenterLayerPoint();this._startCenter=i.add(o)._divideBy(2),this._startDist=i.distanceTo(o),this._moved=!1,this._zooming=!0,this._centerOffset=r.subtract(this._startCenter),e._panAnim&&e._panAnim.stop(),s.DomEvent.on(n,"touchmove",this._onTouchMove,this).on(n,"touchend",this._onTouchEnd,this),s.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var n=e.mouseEventToLayerPoint(t.touches[0]),i=e.mouseEventToLayerPoint(t.touches[1]);this._scale=n.distanceTo(i)/this._startDist,this._delta=n._add(i)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(s.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),s.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),n=t.layerPointToLatLng(e),i=t.getScaleZoom(this._scale);t._animateZoom(n,i,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,s.DomUtil.removeClass(t._mapPane,"leaflet-touching"),s.Util.cancelAnimFrame(this._animRequest),s.DomEvent.off(n,"touchmove",this._onTouchMove).off(n,"touchend",this._onTouchEnd);var e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),o=t.getZoom(),r=t.getScaleZoom(this._scale)-o,a=r>0?Math.ceil(r):Math.floor(r),l=t._limitZoom(o+a),u=t.getZoomScale(l)/this._scale;t._animateZoom(i,l,e,u)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),s.Map.addInitHook("addHandler","touchZoom",s.Map.TouchZoom),s.Map.mergeOptions({tap:!0,tapTolerance:15}),s.Map.Tap=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(s.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var e=t.touches[0],i=e.target;this._startPos=this._newPos=new s.Point(e.clientX,e.clientY),i.tagName&&"a"===i.tagName.toLowerCase()&&s.DomUtil.addClass(i,"leaflet-active"),this._holdTimeout=setTimeout(s.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",e))},this),1e3),s.DomEvent.on(n,"touchmove",this._onMove,this).on(n,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),s.DomEvent.off(n,"touchmove",this._onMove,this).off(n,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var e=t.changedTouches[0],i=e.target;i&&i.tagName&&"a"===i.tagName.toLowerCase()&&s.DomUtil.removeClass(i,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",e)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new s.Point(e.clientX,e.clientY)},_simulateEvent:function(e,i){var o=n.createEvent("MouseEvents");o._simulated=!0,i.target._simulatedClick=!0,o.initMouseEvent(e,!0,!0,t,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),i.target.dispatchEvent(o)}}),s.Browser.touch&&!s.Browser.pointer&&s.Map.addInitHook("addHandler","tap",s.Map.Tap),s.Map.mergeOptions({boxZoom:!0}),s.Map.BoxZoom=s.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){s.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){s.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(s.DomUtil.disableTextSelection(),s.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void s.DomEvent.on(n,"mousemove",this._onMouseMove,this).on(n,"mouseup",this._onMouseUp,this).on(n,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=s.DomUtil.create("div","leaflet-zoom-box",this._pane),s.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,n=this._box,i=this._map.mouseEventToLayerPoint(t),o=i.subtract(e),r=new s.Point(Math.min(i.x,e.x),Math.min(i.y,e.y));s.DomUtil.setPosition(n,r),this._moved=!0,n.style.width=Math.max(0,Math.abs(o.x)-4)+"px",n.style.height=Math.max(0,Math.abs(o.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),s.DomUtil.enableTextSelection(),s.DomUtil.enableImageDrag(),s.DomEvent.off(n,"mousemove",this._onMouseMove).off(n,"mouseup",this._onMouseUp).off(n,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,n=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(n)){var i=new s.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(n));e.fitBounds(i),e.fire("boxzoomend",{boxZoomBounds:i})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),s.Map.addInitHook("addHandler","boxZoom",s.Map.BoxZoom),s.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),s.Map.Keyboard=s.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),s.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;s.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var e=n.body,i=n.documentElement,o=e.scrollTop||i.scrollTop,s=e.scrollLeft||i.scrollLeft;this._map._container.focus(),t.scrollTo(s,o)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,n,i=this._panKeys={},o=this.keyCodes;for(e=0,n=o.left.length;n>e;e++)i[o.left[e]]=[-1*t,0];for(e=0,n=o.right.length;n>e;e++)i[o.right[e]]=[t,0];for(e=0,n=o.down.length;n>e;e++)i[o.down[e]]=[0,t];for(e=0,n=o.up.length;n>e;e++)i[o.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,n,i=this._zoomKeys={},o=this.keyCodes;for(e=0,n=o.zoomIn.length;n>e;e++)i[o.zoomIn[e]]=t;for(e=0,n=o.zoomOut.length;n>e;e++)i[o.zoomOut[e]]=-t},_addHooks:function(){s.DomEvent.on(n,"keydown",this._onKeyDown,this)},_removeHooks:function(){s.DomEvent.off(n,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,n=this._map;if(e in this._panKeys){if(n._panAnim&&n._panAnim._inProgress)return;n.panBy(this._panKeys[e]),n.options.maxBounds&&n.panInsideBounds(n.options.maxBounds)}else{if(!(e in this._zoomKeys))return;n.setZoom(n.getZoom()+this._zoomKeys[e])}s.DomEvent.stop(t)}}),s.Map.addInitHook("addHandler","keyboard",s.Map.Keyboard),
s.Handler.MarkerDrag=s.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new s.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),s.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),s.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,n=s.DomUtil.getPosition(t._icon),i=t._map.layerPointToLatLng(n);e&&s.DomUtil.setPosition(e,n),t._latlng=i,t.fire("move",{latlng:i}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),s.Control=s.Class.extend({options:{position:"topright"},initialize:function(t){s.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),n=this.getPosition(),i=t._controlCorners[n];return s.DomUtil.addClass(e,"leaflet-control"),-1!==n.indexOf("bottom")?i.insertBefore(e,i.firstChild):i.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),n=t._controlCorners[e];return n.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),s.control=function(t){return new s.Control(t)},s.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,o){var r=n+t+" "+n+o;e[t+o]=s.DomUtil.create("div",r,i)}var e=this._controlCorners={},n="leaflet-",i=this._controlContainer=s.DomUtil.create("div",n+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),s.Control.Zoom=s.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",n=s.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",n,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",n,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),n},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,n,i,o,r){var a=s.DomUtil.create("a",n,i);a.innerHTML=t,a.href="#",a.title=e;var l=s.DomEvent.stopPropagation;return s.DomEvent.on(a,"click",l).on(a,"mousedown",l).on(a,"dblclick",l).on(a,"click",s.DomEvent.preventDefault).on(a,"click",o,r).on(a,"click",this._refocusOnMap,r),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";s.DomUtil.removeClass(this._zoomInButton,e),s.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&s.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&s.DomUtil.addClass(this._zoomInButton,e)}}),s.Map.mergeOptions({zoomControl:!0}),s.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new s.Control.Zoom,this.addControl(this.zoomControl))}),s.control.zoom=function(t){return new s.Control.Zoom(t)},s.Control.Attribution=s.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){s.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=s.DomUtil.create("div","leaflet-control-attribution"),s.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var n=[];this.options.prefix&&n.push(this.options.prefix),t.length&&n.push(t.join(", ")),this._container.innerHTML=n.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),s.Map.mergeOptions({attributionControl:!0}),s.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new s.Control.Attribution).addTo(this))}),s.control.attribution=function(t){return new s.Control.Attribution(t)},s.Control.Scale=s.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",n=s.DomUtil.create("div",e),i=this.options;return this._addScales(i,e,n),t.on(i.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),n},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,n){t.metric&&(this._mScale=s.DomUtil.create("div",e+"-line",n)),t.imperial&&(this._iScale=s.DomUtil.create("div",e+"-line",n))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,n=6378137*Math.PI*Math.cos(e*Math.PI/180),i=n*(t.getNorthEast().lng-t.getSouthWest().lng)/180,o=this._map.getSize(),s=this.options,r=0;o.x>0&&(r=i*(s.maxWidth/o.x)),this._updateScales(s,r)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,n,i,o=3.2808399*t,s=this._iScale;o>5280?(e=o/5280,n=this._getRoundNum(e),s.style.width=this._getScaleWidth(n/e)+"px",s.innerHTML=n+" mi"):(i=this._getRoundNum(o),s.style.width=this._getScaleWidth(i/o)+"px",s.innerHTML=i+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),n=t/e;return n=n>=10?10:n>=5?5:n>=3?3:n>=2?2:1,e*n}}),s.control.scale=function(t){return new s.Control.Scale(t)},s.Control.Layers=s.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,n){s.setOptions(this,n),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var i in t)this._addLayer(t[i],i);for(i in e)this._addLayer(e[i],i,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=s.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=s.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),s.Browser.touch?s.DomEvent.on(e,"click",s.DomEvent.stopPropagation):s.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var n=this._form=s.DomUtil.create("form",t+"-list");if(this.options.collapsed){s.Browser.android||s.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var i=this._layersLink=s.DomUtil.create("a",t+"-toggle",e);i.href="#",i.title="Layers",s.Browser.touch?s.DomEvent.on(i,"click",s.DomEvent.stop).on(i,"click",this._expand,this):s.DomEvent.on(i,"focus",this._expand,this),s.DomEvent.on(n,"click",function(){setTimeout(s.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=s.DomUtil.create("div",t+"-base",n),this._separator=s.DomUtil.create("div",t+"-separator",n),this._overlaysList=s.DomUtil.create("div",t+"-overlays",n),e.appendChild(n)},_addLayer:function(t,e,n){var i=s.stamp(t);this._layers[i]={layer:t,name:e,overlay:n},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,n=!1,i=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),i=i||e.overlay,n=n||!e.overlay;this._separator.style.display=i&&n?"":"none"}},_onLayerChange:function(t){var e=this._layers[s.stamp(t.layer)];if(e){this._handlingClick||this._update();var n=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;n&&this._map.fire(n,e)}},_createRadioElement:function(t,e){var i='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(i+=' checked="checked"'),i+="/>";var o=n.createElement("div");return o.innerHTML=i,o.firstChild},_addItem:function(t){var e,i=n.createElement("label"),o=this._map.hasLayer(t.layer);t.overlay?(e=n.createElement("input"),e.type="checkbox",e.className="leaflet-control-layers-selector",e.defaultChecked=o):e=this._createRadioElement("leaflet-base-layers",o),e.layerId=s.stamp(t.layer),s.DomEvent.on(e,"click",this._onInputClick,this);var r=n.createElement("span");r.innerHTML=" "+t.name,i.appendChild(e),i.appendChild(r);var a=t.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(i),i},_onInputClick:function(){var t,e,n,i=this._form.getElementsByTagName("input"),o=i.length;for(this._handlingClick=!0,t=0;o>t;t++)e=i[t],n=this._layers[e.layerId],e.checked&&!this._map.hasLayer(n.layer)?this._map.addLayer(n.layer):!e.checked&&this._map.hasLayer(n.layer)&&this._map.removeLayer(n.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){s.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),s.control.layers=function(t,e,n){return new s.Control.Layers(t,e,n)},s.PosAnimation=s.Class.extend({includes:s.Mixin.Events,run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[s.DomUtil.TRANSITION]="all "+(n||.25)+"s cubic-bezier(0,0,"+(i||.5)+",1)",s.DomEvent.on(t,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),s.DomUtil.setPosition(t,e),s.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(s.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(s.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),s.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,n,i,o=this._el,r=t.getComputedStyle(o);if(s.Browser.any3d){if(i=r[s.DomUtil.TRANSFORM].match(this._transformRe),!i)return;e=parseFloat(i[1]),n=parseFloat(i[2])}else e=parseFloat(r.left),n=parseFloat(r.top);return new s.Point(e,n,!0)},_onTransitionEnd:function(){s.DomEvent.off(this._el,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[s.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),s.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(s.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=s.extend({animate:n.animate},n.zoom),n.pan=s.extend({animate:n.animate},n.pan));var o=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(o)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=s.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new s.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){s.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var n=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,n,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){s.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var n=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(n)?(this.panBy(n,e),!0):!1}}),s.PosAnimation=s.DomUtil.TRANSITION?s.PosAnimation:s.PosAnimation.extend({run:function(t,e,n,i){this.stop(),this._el=t,this._inProgress=!0,this._duration=n||.25,this._easeOutPower=1/Math.max(i||.5,.2),this._startPos=s.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=s.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));s.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){s.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),s.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),s.DomUtil.TRANSITION&&s.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&s.DomUtil.TRANSITION&&s.Browser.any3d&&!s.Browser.android23&&!s.Browser.mobileOpera,this._zoomAnimated&&s.DomEvent.on(this._mapPane,s.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),s.Map.include(s.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,n){if(this._animatingZoom)return!0;if(n=n||{},!this._zoomAnimated||n.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var i=this.getZoomScale(e),o=this._getCenterOffset(t)._divideBy(1-1/i),s=this._getCenterLayerPoint()._add(o);return n.animate===!0||this.getSize().contains(o)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,s,i,null,!0),!0):!1},_animateZoom:function(t,e,n,i,o,r,a){a||(this._animatingZoom=!0),s.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,s.Draggable&&(s.Draggable._disabled=!0),s.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:n,scale:i,delta:o,backwards:r}),setTimeout(s.bind(this._onZoomTransitionEnd,this),250)},this)},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._animatingZoom=!1,s.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),s.Util.requestAnimFrame(function(){this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),s.Draggable&&(s.Draggable._disabled=!1)},this))}}:{}),s.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,n=s.DomUtil.TRANSFORM,i=t.delta?s.DomUtil.getTranslateString(t.delta):e.style[n],o=s.DomUtil.getScaleString(t.scale,t.origin);e.style[n]=t.backwards?o+" "+i:i+" "+o},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),s.Util.falseFn(e.offsetWidth);var n=this._map.getZoom();(n>this.options.maxZoom||n<this.options.minZoom)&&this._clearBgBuffer(),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[s.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,n=this._getLoadedTilesPercentage(e),i=this._getLoadedTilesPercentage(t);return e&&n>.5&&.5>i?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[s.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,n,i=t.getElementsByTagName("img"),o=0;for(e=0,n=i.length;n>e;e++)i[e].complete&&o++;return o/n},_stopLoadingImages:function(t){var e,n,i,o=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,n=o.length;n>e;e++)i=o[e],i.complete||(i.onload=s.Util.falseFn,i.onerror=s.Util.falseFn,i.src=s.Util.emptyImageUrl,i.parentNode.removeChild(i))}}),s.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=s.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=s.bind(this._handleGeolocationResponse,this),n=s.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,n,t):navigator.geolocation.getCurrentPosition(e,n,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,n=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+n+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,n=t.coords.longitude,i=new s.LatLng(e,n),o=180*t.coords.accuracy/40075017,r=o/Math.cos(s.LatLng.DEG_TO_RAD*e),a=s.latLngBounds([e-o,n-r],[e+o,n+r]),l=this._locateOptions;if(l.setView){var u=Math.min(this.getBoundsZoom(a),l.maxZoom);this.setView(i,u)}var h={latlng:i,bounds:a,timestamp:t.timestamp};for(var c in t.coords)"number"==typeof t.coords[c]&&(h[c]=t.coords[c]);this.fire("locationfound",h)}})}(window,document)},{}],58:[function(t,e,n){function i(){h=!1,a.length?u=a.concat(u):c=-1,u.length&&o()}function o(){if(!h){var t=setTimeout(i);h=!0;for(var e=u.length;e;){for(a=u,u=[];++c<e;)a&&a[c].run();c=-1,e=u.length}a=null,h=!1,clearTimeout(t)}}function s(t,e){this.fun=t,this.array=e}function r(){}var a,l=e.exports={},u=[],h=!1,c=-1;l.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new s(t,e)),1!==u.length||h||setTimeout(o,0)},s.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=r,l.addListener=r,l.once=r,l.off=r,l.removeListener=r,l.removeAllListeners=r,l.emit=r,l.binding=function(t){throw new Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(t){throw new Error("process.chdir is not supported")},l.umask=function(){return 0}},{}],59:[function(t,e,n){function i(t,e){var n=e.platforms.map(function(e){return t.platforms[e]});if(3===n.length)return n.every(function(t){return 2===t.transfers.length})?n:[];if(4===n.length){var i=n.slice().sort(function(t,e){return t.transfers.length-e.transfers.length}),o=i.map(function(t){return t.transfers.length});if(r.arrayEquals(o,[2,2,3,3]))return i;if(r.arrayEquals(o,[1,2,2,3]))return i.slice(1)}return[]}function o(t,e,n){for(var i=1,o=20,r=.7,u=30,h=60,c=240,d=360,p=function(t,e){return L.LatLng.prototype.distanceTo.call(t,e)},f=t.platforms,m=[],_=[],g=0;g<f.length;g++){var v=f[g],y=v.spans.map(function(e){return t.spans[e].routes[0]}).map(function(e){return t.routes[e].line}).some(function(t){return t.startsWith("E")}),b=p(e,v.location),x=b/i;m.push(x+(y?d:c)),b=p(v.location,n),x=b/i,_.push(x)}for(var P=f.indexOf(l.findClosestObject(e,f)),w=new Set(f.map(function(t,e){return e})),T=f.map(function(t){return null}),E=p(e,n)/i;w.size>0;){var C=1/0;w.forEach(function(t){m[t]<C&&(P=t,C=m[t])});var M=f[P];w["delete"](P);for(var k=T[P],S=(f[k],t.spans.find(function(t){return t.source===P&&t.target===k||t.source===k&&t.target===P})),O=[],D=[],A=0,I=M.spans;A<I.length;A++){var z=I[A],B=t.spans[z],N=P===B.source?B.target:B.source;if(w.has(N)){O.push(N);var j=f[N],b=p(M.location,j.location),U=0;S&&t.routes[S.routes[0]]!==t.routes[B.routes[0]];var R=t.routes[B.routes[0]].line.startsWith("E")?h:u,H=a.timeToTravel(b,o,r);D.push(H+R+U)}}for(var Z=0,W=t.stations[M.station].platforms;Z<W.length;Z++){var N=W[Z];if(w.has(N)){O.push(N);var j=f[N],y=j.spans.map(function(e){return t.spans[e].routes[0]}).map(function(e){return t.routes[e].line}).some(function(t){return t.startsWith("E")}),b=p(M.location,j.location)/2;D.push(b/i+(y?d:c))}}for(var z=0,F=O.length;F>z;++z){var N=O[z],G=m[P]+D[z];G<m[N]&&(m[N]=G,T[N]=P)}var V=m[P]+_[P]}for(var q=1/0,z=0;z<m.length;++z){var V=m[z]+_[z];q>V&&(q=V,P=z)}if(q>E)return{time:{walkTo:E}};for(var X=[],J=[P];;){var M=f[P],Y=T[P];if(null===Y)break;for(var K="",Q=0,$=M.spans;Q<$.length;Q++){var z=$[Q],B=t.spans[z];if(B.source===P&&B.target===Y||B.target===P&&B.source===Y){K="p-"+z;break}}if(""===K)for(var z=0,tt=t.transfers.length;tt>z;++z){var et=t.transfers[z];if(et.source===P&&et.target===Y||et.target===P&&et.source===Y){K="t-"+z;break}}if(""===K){var nt=s(t,Y,P),it=nt.transfers,ot=nt.midPlatforms;X.push.apply(X,it.reverse().map(function(t){return"t-"+t})),J.push.apply(J,ot)}else X.push(K);J.push(Y),P=Y}J.reverse(),X.reverse();var st=_[J[J.length-1]],rt=m[J[0]],at=q-st-rt;return{platforms:J,edges:X,time:{walkTo:rt,metro:at,walkFrom:st,total:q}}}function s(t,e,n){var i=t.platforms[e],o=t.platforms[n];if(i.station!==o.station)throw new Error("platforms ("+i.name+" & "+o.name+" must be on the same station");for(var s=function(t,e){return L.LatLng.prototype.distanceTo.call(t,e)},r=t.stations[i.station],a=r.platforms,l=new Set(a),u=[],h=[],c=0;c<a.length;c++){var d=a[c];u[d]=1/0,h[d]=null}u[e]=0;for(var p=e;l.size>0;){var f=1/0;l.forEach(function(t){u[t]<f&&(p=t,f=u[t])}),l["delete"](p);for(var m=t.platforms[p],_=m.transfers,g=0;g<_.length;g++){var v=_[g];if(l.has(v)){var y=s(m.location,t.platforms[v].location),b=u[p]+y;b<u[v]&&(u[v]=b,h[v]=p)}}}var x=[],P=[];for(p=n;;){var w=h[p];if(null===w)break;var T=t.transfers.findIndex(function(t){return t.source===p&&t.target===w||t.source===w&&t.target===p});x.push(T),p=w,P.push(p)}return P.pop(),{transfers:x.reverse(),midPlatforms:P.reverse()}}var r=t("./util"),a=t("./math"),l=t("./geo");n.findCircle=i,n.shortestRoute=o},{"./geo":61,"./math":64,"./util":75}],60:[function(t,e,n){function i(t,e){var n=this,i=[t.source,t.target],o=["source","target"];o.forEach(function(a,l){Object.defineProperty(t,a,{get:function(){return t["_"+a]},set:function(i){var u=document.getElementById("p-"+i),h=Number(u.getAttribute("r"))/2+parseFloat(getComputedStyle(u).strokeWidth),c=n.platformsOnSVG.get(i);if("line"===e[0].tagName){for(var d=l+1,p=n.platformsOnSVG.get(t[o[1-l]]),f=0;f<e.length;f++){var m=e[f];m.setAttribute("x"+d,c.x.toString()),m.setAttribute("y"+d,c.y.toString())}var _=document.getElementById("g-"+n.graph.transfers.indexOf(t)),g="source"===a?p.subtract(c):c.subtract(p);s.Gradients.setDirection(_,g);var v=h/c.distanceTo(p);s.Gradients.setOffset(_,v)}else{if("path"!==e[0].tagName)throw new Error("wrong element type for transfer");for(var y=[],b=[],x=0;x<n.graph.transfers.length;++x){var L=n.graph.transfers[x];if((L.source===t.source||L.target===t.target||L.source===t.target||L.target===t.source)&&(y.push(L),b.push(x),3===y.length))break}for(var P=new Set,w=0;w<y.length;w++){var T=y[w];P.add(T.source).add(T.target)}var E=[];P.forEach(function(t){return E.push(n.platformsOnSVG.get(t))});for(var C=(r.getCircumcenter(E),b.map(function(t){return document.getElementById("ot-"+t)})),M=b.map(function(t){return document.getElementById("it-"+t)}),x=0;3>x;++x){var T=y[x],k=C[x],S=M[x],O=n.platformsOnSVG.get(T.source),D=n.platformsOnSVG.get(T.target),A=E.find(function(t){return t!==O&&t!==D});s.setCircularPath(k,O,D,A),S.setAttribute("d",k.getAttribute("d"));var _=document.getElementById("g-"+b[x]);s.Gradients.setDirection(_,D.subtract(O));var v=h/O.distanceTo(D);s.Gradients.setOffset(_,v)}}}}),t["_"+a]=i[l]})}function o(t,e){var n=this,i="number"==typeof t?[t,this.graph.platforms[t]]:[this.graph.platforms.indexOf(t),t],o=i[0],r=i[1],a=r.location;Object.defineProperty(r,"location",{get:function(){return r._location},set:function(t){r._location=t;for(var i=n.map.getZoom()<12?n.graph.stations[r.station].location:t,a=n.map.latLngToContainerPoint(i).subtract(n.map.latLngToContainerPoint(n.bounds.getNorthWest())),l=0;l<e.length;l++){var u=e[l];u.setAttribute("cx",a.x.toString()),u.setAttribute("cy",a.y.toString())}n.whiskers[o]=n.makeWhiskers(o),n.platformsOnSVG.set(o,a);for(var h=new Set(r.spans),c=0,d=r.spans;c<d.length;c++){var p=d[c],f=n.graph.spans[p],m=f.source,_=f.target,g=o===m?_:m;n.whiskers[g]=n.makeWhiskers(g),n.graph.platforms[g].spans.forEach(function(t){return h.add(t)})}h.forEach(function(t){var e=n.graph.spans[t],i=e.source,o=e.target,r=[n.platformsOnSVG.get(i),n.whiskers[i][t],n.whiskers[o][t],n.platformsOnSVG.get(o)];s.setBezierPath(document.getElementById("op-"+t),r);var a=document.getElementById("ip-"+t);a&&s.setBezierPath(a,r)});for(var v=0,y=0,b=n.graph.transfers;y<b.length;y++){var x=b[y];x.source===o?(x.source=o,++v):x.target===o&&(x.target=o,++v)}console.log(v)}}),r._location=a}var s=t("./svg"),r=t("./math");n.transferToModel=i,n.platformToModel=o},{"./math":64,"./svg":68}],61:[function(t,e,n){function i(t,e){if(e.length<1)throw new Error("an objects array must contain at least 1 object");for(var n=e[0],i=t.distanceTo(n.location),o=1;o<e.length;++o){var s=t.distanceTo(e[o].location);i>s&&(n=e[o],i=s)}return n}function o(t,e,n,i){void 0===i&&(i=!1);var o=e.filter(function(e){return t.distanceTo(e.location)<=n});return i&&o.sort(function(e,n){return t.distanceTo(e.location)-t.distanceTo(n.location)}),o}function s(t){for(var e=t.length,n=0,i=0,o=0;e>o;++o)n+=t[o].lat,i+=t[o].lng;return new a.LatLng(n/e,i/e)}function r(t,e){for(var n=s(t),i=1/0,o=1;o>1e-8;o*=.5)for(var r=5*o,l=-r;r>=l;l+=o)for(var u=-5*o;5*o>=u;u+=o){var h=new a.LatLng(n.lat+l,n.lng+u),c=e(t,h);i>c&&(n=h,i=c)}return n}var a=t("leaflet");n.findClosestObject=i,n.findObjectsWithinRadius=o,n.getCenter=s,n.geoMean=r},{leaflet:57}],62:[function(t,e,n){function i(t){return t in n.dictionary&&n.userLanguage in n.dictionary[t]?n.dictionary[t][n.userLanguage]:t}function o(t,e){return 0===t?"":t+" "+(t>1&&"en"===n.userLanguage?e+"s":e)}function s(t){if(60>t)return Math.round(t)+" seconds";if(3570>t){var e=Math.round(t/60);return o(e,"min")}var n=Math.floor(t/3600),i=Math.floor((t-3600*n)/60);return o(n,"hour")+" "+o(i,"min")}n.userLanguage=(navigator.userLanguage||navigator.language).slice(0,2).toLowerCase(),n.dictionary={},n.translate=i,n.formatTime=s},{}],63:[function(t,e,n){"use strict";var i=t("./res"),o=t("./util"),s=t("leaflet"),r=t("./metro-map");s.Browser.ie?alert("Does not work in IE (yet)"):s.Browser.mobile&&alert("May work incorrectly in mobile browser");var a=t("./polyfills");a["default"]();var l=t("./tilelayers");i.dictionaryPromise.then(function(t){var e=(new r["default"]("map-container","json/graph.json",l["default"]),"St Petersburg metro plan proposal"),n=t[e];o.flashTitle(Object.keys(n).map(function(t){return n[t]}).concat([e]),3e3)}),console.log("user: "+navigator.userLanguage),console.log("language: "+navigator.language),console.log("browser: "+navigator.browserLanguage),console.log("system: "+navigator.systemLanguage)},{"./metro-map":65,"./polyfills":66,"./res":67,"./tilelayers":69,"./util":75,leaflet:57}],64:[function(t,e,n){function i(t,e){return t.x*e.x+t.y*e.y}function o(t,e){return i(t,e)/t.distanceTo(e)}function s(t){return t.reduce(function(t,e){return t.add(e)}).divideBy(t.length)}function r(t){if(3!==t.length)throw new Error("must have 3 vertices");var e=t[1].subtract(t[0]),n=t[2].subtract(t[0]),o=i(e,e),s=i(n,n);return new L.Point(n.y*o-e.y*s,e.x*s-n.x*o).divideBy(2*(e.x*n.y-e.y*n.x)).add(t[0])}function a(t,e,n){return new L.Point(t.x+e*Math.cos(n),t.y+e*Math.sin(n))}function l(t){var e=Math.abs(t.x),n=Math.abs(t.y);return t.divideBy(n>e?n:e)}function u(t,e,n){var i=e*e/n;return t>i?e/n*2+(t-i)/e:2*Math.sqrt(t/n)}n.dot=i,n.angle=o,n.getCenter=s,n.getCircumcenter=r,n.polarToCartesian=a,n.vectorToGradCoordinates=l,n.timeToTravel=u},{}],65:[function(t,e,n){var i=t("leaflet"),o=t("alertifyjs"),s=t("./res"),r=t("./util"),a=t("./math"),l=t("./algorithm"),u=t("./lang"),h=t("./svg"),c=t("./bind"),d=t("./geo"),p=t("./ui");i.Icon.Default.imagePath="http://cdn.leafletjs.com/leaflet/v0.7.7/images";var f=function(){function t(t,e,n){var o=this;this.whiskers=[],this.platformsOnSVG=new Map,this.fromMarker=new i.Marker([0,0]),this.toMarker=new i.Marker([0,0]);var a=fetch(e).then(function(t){return t.json()}).then(function(t){return o.graph=t}),l=fetch("json/hints.json").then(function(t){return t.json()}).then(function(t){return o.hints=t}),c=fetch("json/contextmenudata.json").then(function(t){return t.json()});this.map=new i.Map(t,{center:new i.LatLng(59.943556,30.30452),zoom:11,minZoom:9,inertia:!1}).addControl(new i.Control.Scale({imperial:!1})),n[Object.keys(n)[0]].addTo(this.map),this.map.addLayer(this.fromMarker).addLayer(this.toMarker),this.overlay=document.getElementById("overlay");var d=this.map.getContainer();d.removeChild(this.overlay),d.appendChild(this.overlay);var f=h.createSVGElement("defs");f.appendChild(h.Shadows.makeDrop()),f.appendChild(h.Shadows.makeGlow()),0===f.textContent.length&&alert(u.translate("Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience.")),this.overlay.appendChild(f),a["catch"](function(t){return alert(t)}).then(function(t){return o.extendBounds()}).then(function(){return l}).then(function(t){return s.lineRulesPromise}).then(function(t){return o.lineRules=t,o.redrawNetwork(),o.map.invalidateSize(!1),o.addMapListeners(),o.resetMapView(),o.fixFontRendering(),i.Browser.mobile||new p.MapEditor(o),new p.FAQ(o,"json/data.json"),c}).then(function(t){return o._contextMenu=new p.ContextMenu(o,new Map(t))}),Promise.all([a,l]).then(function(t){return r.Hints.verify(o.graph,o.hints)}).then(function(t){return console.log(t)})}return Object.defineProperty(t.prototype,"contextMenu",{get:function(){return this._contextMenu},enumerable:!0,configurable:!0}),t.prototype.getMap=function(){return this.map},t.prototype.getOverlay=function(){return this.overlay},t.prototype.getPlate=function(){return this.plate;
},t.prototype.getGraph=function(){return this.graph},t.prototype.addEventListener=function(t,e){},t.prototype.dispatchEvent=function(t){var e=this;switch(console.log("event target as seen from dispatcher",t.target),console.log(t),t.type){case"clearroute":this.fromMarker.setLatLng([0,0]),this.toMarker.setLatLng([0,0]),r.resetStyle(),o.dismissAll(),this.fixFontRendering();break;case"showheatmap":if(this.fromMarker.getLatLng().equals([0,0])){var n=this.bounds.getNorthWest(),s=this.map.latLngToContainerPoint(n),a=this.bounds.getSouthEast(),l=this.map.latLngToContainerPoint(a),p=l.subtract(s).divideBy(200);console.log(a.distanceTo(n)/200),console.log("for "+p),console.time("checking");for(var f=s.x;f<l.x;f+=p.x)for(var m=s.y;m<l.y;m+=p.y){var _=this.map.containerPointToLatLng(new i.Point(f,m)),g=d.findClosestObject(_,this.graph.platforms).location;i.LatLng.prototype.distanceTo.call(g,_)}console.timeEnd("checking")}break;case"measuredistance":var v=r.mouseToLatLng(this.map,t),y=document.getElementById("origin"),b=document.getElementById("measure-circles"),x=document.getElementById("measure-lines");null!==b&&(y.removeChild(b),y.removeChild(x)),b=h.createSVGElement("g"),b.id="measure-circles",x=h.createSVGElement("g"),x.id="measure-lines",y.appendChild(b),y.appendChild(x);var L=v,P=[];this.map.on("click",function(t){if(0===t.originalEvent.button){var n=e.map.latLngToContainerPoint(t.latlng).subtract(e.map.latLngToContainerPoint(e.bounds.getNorthWest())),i=h.makeCircle(n,3);i.classList.add("measure-circle");var s={lang:{ru:"Udali izmerenia",en:"Delete measurements"}};e._contextMenu.extraItems.set(i,(new Map).set("deletemeasurements",s)),b.appendChild(i);var r=e.map.latLngToContainerPoint(L).subtract(e.map.latLngToContainerPoint(e.bounds.getNorthWest())),a=h.makeLine(r,n);if(a.classList.add("measure-line"),x.appendChild(a),P.push(t.latlng),P.length>1){for(var l=0,u=1;u<P.length;++u)l+=P[u-1].distanceTo(P[u]);o.dismissAll(),o.message(Math.round(l)+"m")}L=t.latlng}}),this.map.fire("click",{latlng:v,originalEvent:{button:0}}),r.onceEscapePress(function(t){return e.dispatchEvent(new MouseEvent("deletemeasurements"))});break;case"deletemeasurements":for(var y=document.getElementById("origin"),w=0,T=["measure-circles","measure-lines"];w<T.length;w++){var E=T[w];y.removeChild(document.getElementById(E))}this.map.off("click");break;case"platformrename":var C=t,M=h.platformByCircle(C.relatedTarget,this.graph);this.plate.show(h.circleByDummy(C.relatedTarget)),r.platformRenameDialog(this.graph,M);break;case"platformdelete":var C=t,k=h.platformByCircle(C.relatedTarget,this.graph),S=(k.spans,this.graph.platforms.indexOf(k)),O=this.passingLines(k);if(1===O.size){var D=this.graph.spans.filter(function(t){return t.source===S||t.target===S});if(1===D.length);else if(2===D.length){var A=D[0],I=D[1];A[A.source===S?"target":"source"]=I[A.source===S?"target":"source"];var z=this.graph.spans.indexOf(I);this.graph.spans.splice(z,1);for(var B=0,N=this.graph.platforms;B<N.length;B++){for(var j=N[B],U=null,f=0;f<j.spans.length;++f)j.spans[f]>z?--j.spans[f]:j.spans[f]===z&&(U=f);null!==U&&j.spans.splice(U,1)}}}this.graph.platforms.splice(S,1);for(var R=0,H=this.graph.spans;R<H.length;R++){var Z=H[R];Z.source>S&&--Z.source,Z.target>S&&--Z.target}for(var W=0,F=this.graph.stations;W<F.length;W++){for(var Z=F[W],U=null,f=0;f<Z.platforms.length;++f)Z.platforms[f]>S?--Z.platforms[f]:Z.platforms[f]===S&&(U=f);null!==U&&Z.platforms.splice(U,1)}break;case"platformadd":var G=r.mouseToLatLng(this.map,t),V=this.map.latLngToContainerPoint(G).subtract(this.map.latLngToContainerPoint(this.bounds.getNorthWest())),q=document.getElementById("station-circles"),X=document.getElementById("dummy-circles"),J=h.makeCircle(V,+q.firstElementChild.getAttribute("r")),Y=h.makeCircle(V,+X.firstElementChild.getAttribute("r")),K=this.graph.platforms.length;J.id="p-"+K,Y.id="d-"+K,q.appendChild(J),X.appendChild(Y);var Q={name:u.translate("New station"),altNames:{},station:null,spans:[],transfers:[],elevation:0,location:G};this.graph.platforms.push(Q),c.platformToModel.call(this,Q,[J,Y]);break;default:return this.handleMenuFromTo(t),!1}},t.prototype.removeEventListener=function(t,e){},t.prototype.handleMenuFromTo=function(t){var e=this,n=r.mouseToLatLng(this.map,t),o="fromclick"===t.type?this.fromMarker:this.toMarker;o.setLatLng(n),console.log(this.fromMarker,this.toMarker);var s=new i.LatLng(0,0);this.fromMarker.getLatLng().equals(s)||this.toMarker.getLatLng().equals(s)||this.visualizeShortestRoute(this.fromMarker.getLatLng(),this.toMarker.getLatLng()),r.onceEscapePress(function(t){return e.dispatchEvent(new MouseEvent("clearroute"))}),this.fixFontRendering()},t.prototype.addMapListeners=function(){var t=this,e=this.map.getPanes().mapPane;this.map.on("movestart",function(e){console.log("move start"),t.map.touchZoom.disable(),i.Browser.webkit&&h.Gradients.removeAll()}).on("move",function(n){t.overlay.style.transform=e.style.transform}).on("moveend",function(n){console.log("move ended"),t.map.touchZoom.enable(),i.Browser.webkit&&h.Gradients.addAll(),t.fixFontRendering(),t.overlay.style.transform=e.style.transform}).on("zoomstart",function(e){console.log("zoomstart",e),t.map.dragging.disable();var n=e.target._zoom;setTimeout(function(){var o=e.target._animateToZoom,s=Math.pow(2,o-n),r=t.overlay.getBoundingClientRect(),a=e.target.scrollWheelZoom._lastMousePos;if(!a){var l=document.documentElement;a=new i.Point(l.clientWidth/2,l.clientHeight/2)}var u=new i.Point(a.x-r.left,a.y-r.top),h=new i.Point(u.x/r.width,u.y/r.height),c=t.overlay.style;c.left="0",c.top="0",c.transformOrigin=100*h.x+"% "+100*h.y+"%",c.transform="matrix("+s+", 0, 0, "+s+", "+r.left+", "+r.top+")"},0),t.overlay.style.opacity="0.5"}).on("zoomend",function(e){t.overlay.style.opacity=null,t.overlay.style.transformOrigin=null,t.redrawNetwork(),t.map.dragging.enable()})},t.prototype.fixFontRendering=function(){var t=document.querySelectorAll('img[style*="translate3d"]');console.log(t);for(var e=0;e<t.length;++e)r.CSSTransform.replace(t[e]);r.CSSTransform.replace(this.map.getPanes().mapPane)},t.prototype.resetMapView=function(){this.map.setView(this.bounds.getCenter(),11,{pan:{animate:!1},zoom:{animate:!1}})},t.prototype.resetOverlayStructure=function(){for(var t,e=document.getElementById("origin")||h.createSVGElement("g");t=e.firstChild;)e.removeChild(t);e.id="origin";for(var n=["paths-outer","paths-inner","transfers-outer","station-circles","transfers-inner","dummy-circles"],i=0;i<n.length;i++){var o=n[i],s=h.createSVGElement("g");s.id=o,e.appendChild(s)}this.overlay.appendChild(e),this.plate=new p.TextPlate(this.graph),e.insertBefore(this.plate.element,document.getElementById("dummy-circles"))},t.prototype.extendBounds=function(){var t=this,e=this.graph.platforms[0].location;this.bounds=new i.LatLngBounds(e,e),this.graph.platforms.forEach(function(e){return t.bounds.extend(e.location)})},t.prototype.addBindings=function(){for(var t=this.graph.platforms,e=0;e<t.length;++e){var n=document.getElementById("p-"+e),i=document.getElementById("d-"+e);c.platformToModel.call(this,e,[n,i])}},t.prototype.posOnSVG=function(t,e){var n=this.map.latLngToContainerPoint(e);return n.subtract(t.min)},t.prototype.updateOverlayPositioning=function(){var t=this.bounds.getNorthWest(),e=this.bounds.getSouthEast(),n=this.overlay.style,o=new i.Bounds(this.map.latLngToContainerPoint(t),this.map.latLngToContainerPoint(e)),s=r.CSSTransform.parse(n.transform),a=new i.Point(100,100),l=o.min.subtract(s).subtract(a);n.left=l.x+"px",n.top=l.y+"px";var u=document.getElementById("origin");u.setAttribute("transform","translate("+a.x+", "+a.y+")");var h=o.getSize().add(a).add(a);n.width=h.x+"px",n.height=h.y+"px"},t.prototype.redrawNetwork=function(){var t=this;this.fromMarker.setLatLng([0,0]),this.toMarker.setLatLng([0,0]),this.resetOverlayStructure(),this.updateOverlayPositioning(),this.getPlatformsPositionOnOverlay();for(var e={"station-circles":document.createDocumentFragment(),"dummy-circles":document.createDocumentFragment(),"paths-inner":document.createDocumentFragment(),"paths-outer":document.createDocumentFragment(),"transfers-inner":document.createDocumentFragment(),"transfers-outer":document.createDocumentFragment()},n=this.map.getZoom(),i=.5*(n-7),o=12>n?1.25*i:i,s=12>n?.4*o:.6*o,a=.9*i,u=1.25*s,d={"station-circles":s,"transfers-outer":a+u/2,"transfers-inner":a-u/2,"paths-outer":i,"paths-inner":i/2},p=0,f=Object.keys(d);p<f.length;p++){var m=f[p];document.getElementById(m).style.strokeWidth=d[m]+"px"}for(var _=new Set,g=new Map,v=0,y=this.graph.stations;v<y.length;v++){for(var b=y[v],x=[],L=0,P=b.platforms;L<P.length;L++){var w=P[L],T=this.graph.platforms[w],E=this.platformsOnSVG.get(w);if(n>9){var C=h.makeCircle(E,o);if(C.id="p-"+w,n>11){var M=this.passingLines(T);if(1===M.size){var k=M.values().next().value.match(/([MEL])(\d{0,2})/);k&&C.classList.add("M"===k[1]?k[0]:k[1])}else{var S=[];M.forEach(function(e){var n=e.match(/([MEL])(\d{0,2})/);n&&S.push(t.lineRules["M"===n[1]?n[0]:n[1]])}),C.style.stroke=r.Color.mean(S)}}var O=h.makeCircle(E,2*o);O.id="d-"+w,e["station-circles"].appendChild(C),e["dummy-circles"].appendChild(O)}this.whiskers[w]=this.makeWhiskers(w)}var D=document.getElementById("dummy-circles");D.addEventListener("mouseover",function(e){return t.plate.show(h.circleByDummy(e.target))}),D.addEventListener("mouseout",function(e){return t.plate.hide()});var A=l.findCircle(this.graph,b);if(A.length>0){for(var I=0,z=b.platforms;I<z.length;I++){var w=z[I],T=this.graph.platforms[w];A.indexOf(T)>-1&&(x.push(this.platformsOnSVG.get(w)),_.add(w))}g.set(b,A)}}if(n>11)for(var B=0;B<this.graph.transfers.length;++B){var N,j=this.graph.transfers[B],U=this.graph.platforms[j.source],R=this.graph.platforms[j.target],H=this.platformsOnSVG.get(j.source),Z=this.platformsOnSVG.get(j.target);if(_.has(j.source)&&_.has(j.target)){var W=g.get(this.graph.stations[U.station]),F=function(e){var n=t.platformsOnSVG.get(t.graph.platforms.indexOf(e));N=h.makeTransferArc(H,Z,n)};if(3===W.length)F(W.find(function(t){return t!==U&&t!==R}));else if(U===W[2]&&R===W[3]||U===W[3]&&R===W[2])N=h.makeTransfer(H,Z);else{var G=(W.map(function(t){return t.transfers.length}),2===U.transfers.length?[U,R]:[R,U]),V=G[0],q=G[1];F(this.graph.platforms[V.transfers.find(function(e){return t.graph.platforms[e]!==q})])}}else N=h.makeTransfer(H,Z);N[0].id="ot-"+B,N[1].id="it-"+B;var X=[U,R].map(function(e){var n=t.graph.spans[e.spans[0]],i=n.routes.map(function(e){return t.graph.routes[e]}),o=i[0].line.match(/([MEL])(\d{0,2})/),s=o[0],r=o[1];o[2];return t.lineRules["L"===r?r:s]}),J=(o+s/2)/H.distanceTo(Z),Y=document.getElementById("g-"+B);null===Y?(Y=h.Gradients.makeLinear(Z.subtract(H),X,J),Y.id="g-"+B,this.overlay.querySelector("defs").appendChild(Y)):(h.Gradients.setDirection(Y,Z.subtract(H)),h.Gradients.setOffset(Y,J)),N[0].style.stroke="url(#"+Y.id+")",e["transfers-outer"].appendChild(N[0]),e["transfers-inner"].appendChild(N[1]),c.transferToModel.call(this,j,N)}for(var K=0;K<this.graph.spans.length;++K){var Q=this.makePath(K),$=Q[0],tt=Q[1];e["paths-outer"].appendChild($),tt?e["paths-inner"].appendChild(tt):this.graph.routes[this.graph.spans[K].routes[0]].line.startsWith("L")&&($.style.strokeWidth=.75*i+"px")}for(var et=0,nt=Object.keys(e);et<nt.length;et++){var K=nt[et];document.getElementById(K).appendChild(e[K])}this.addBindings()},t.prototype.getPlatformsPositionOnOverlay=function(){for(var t=this.map.getZoom(),e=this.bounds.getNorthWest(),n=this.bounds.getSouthEast(),o=new i.Bounds(this.map.latLngToContainerPoint(e),this.map.latLngToContainerPoint(n)),s=this.graph.platforms,r=function(t){return d.getCenter(t.platforms.map(function(t){return s[t].location}))},a=0,l=this.graph.stations;a<l.length;a++)for(var u=l[a],h=12>t?r(u):null,c=0,p=u.platforms;c<p.length;c++){var f=p[c],m=this.posOnSVG(o,h||s[f].location);this.platformsOnSVG.set(f,m)}},t.prototype.passingLines=function(t){for(var e=new Set,n=0,i=t.spans;n<i.length;n++)for(var o=i[n],s=0,r=this.graph.spans[o].routes;s<r.length;s++){var a=r[s];e.add(this.graph.routes[a].line)}return e},t.prototype.makeWhiskers=function(t){var e=this,n=this.graph.platforms[t],i=this.platformsOnSVG.get(t);if(n.spans.length<2)return R={},R[n.spans[0]]=i,R;if(n.spans.length>2){var o=[[],[]],s=[[],[]],l=this.hints.crossPlatform,u=r.Hints.hintContainsLine(this.graph,l,n);if(n.name in l&&null!==u){for(var h=u>-1?l[n.name][u]:l[n.name],c=[],d=0,p=Object.keys(h);d<p.length;d++){var f=p[d],m=h[f];"string"==typeof m?c.push(m):c.push.apply(c,m)}for(var _=0,g=n.spans;_<g.length;_++){var v=g[_],y=this.graph.spans[v],b=y.source===t?y.target:y.source,x=this.graph.platforms[b],L=this.platformsOnSVG.get(b),P=c.indexOf(x.name)>-1?1:0;o[P].push(L),s[P].push(v)}}var w=o.map(function(t){return i.add(1===t.length?t[0]:0===t.length?i:a.getCenter(t)).divideBy(2)}),T=w.map(function(t){return i.distanceTo(t)}),E=w[1].subtract(w[0]).multiplyBy(T[0]/(T[0]+T[1])),C=w[0].add(E),M=i.subtract(C),k={};return s[0].forEach(function(t){return k[t]=w[0].add(M)}),s[1].forEach(function(t){return k[t]=w[1].add(M)}),k}var S=n.spans.map(function(t){return e.graph.routes[e.graph.spans[t].routes[0]].line});if(S[0]!==S[1])return H={},H[n.spans[0]]=i,H[n.spans[1]]=i,H;var O=[i,i],D=[0,0],A=this.graph.spans[n.spans[0]];A.source===t&&n.spans.reverse();for(var I=0;2>I;++I){var y=this.graph.spans[n.spans[I]],z=y.source===t?y.target:y.source,B=this.platformsOnSVG.get(z);D[I]=i.distanceTo(B),O[I]=i.add(B).divideBy(2)}var N=O[1].subtract(O[0]).multiplyBy(D[0]/(D[0]+D[1])),j=O[0].add(N),U=i.subtract(j);return Z={},Z[n.spans[0]]=O[0].add(U),Z[n.spans[1]]=O[1].add(U),Z;var R,H,Z},t.prototype.makePath=function(t){var e=this,n=this.graph.spans[t],i=n.source,o=n.target,s=n.routes.map(function(t){return e.graph.routes[t]}),r=s[0].line.match(/([MEL])(\d{0,2})/),a=r[0],l=r[1],u=(r[2],[this.platformsOnSVG.get(i),this.whiskers[i][t],this.whiskers[o][t],this.platformsOnSVG.get(o)]),c=h.makeCubicBezier(u);if(c.id="op-"+t,"E"===l){c.classList.add("E");var d=c.cloneNode(!0);return d.id="ip-"+t,[c,d]}return a&&c.classList.add(a),c.classList.add(l),[c]},t.prototype.visualizeShortestRoute=function(t,e){var n=this;r.resetStyle(),o.dismissAll();var i=l.shortestRoute(this.graph,t,e),s=i.platforms,a=i.edges,c=i.time,d=u.translate("on foot"),p=u.formatTime(c.walkTo);if(void 0===a)return o.success(p+" "+d+"!");for(var f="#paths-inner *, #paths-outer *, #transfers-inner *, #transfers-outer *, #station-circles *",m=this.overlay.querySelectorAll(f),_=0;_<m.length;++_)m[_].style.opacity="0.25";console.log(a),console.log(s.map(function(t){return n.graph.platforms[t].name})),h.Animation.animateRoute(this.graph,s,a).then(function(){o.message(u.translate("time").toUpperCase()+":<br>"+p+" "+d+"<br>"+u.formatTime(c.metro)+" "+u.translate("by metro")+"<br>"+u.formatTime(c.walkFrom)+" "+d+"<br>"+u.translate("TOTAL")+": "+u.formatTime(c.total),10)})},t}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=f},{"./algorithm":59,"./bind":60,"./geo":61,"./lang":62,"./math":64,"./res":67,"./svg":68,"./ui":70,"./util":75,alertifyjs:1,leaflet:57}],66:[function(t,e,n){function i(){"Promise"in window&&"then"in Promise.prototype&&"catch"in Promise.prototype||(console.log("promises not present, using a polyfill"),t("es6-promise").polyfill()),"Set"in window&&"add"in Set.prototype&&"has"in Set.prototype||(console.log("set not present, using a polyfill"),t("es6-set/implement")),"classList"in HTMLElement.prototype||(console.log("classlist not present, using a polyfill"),t("classlist-polyfill")),Array.prototype.find||(Array.prototype.find=function(t){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),i=n.length>>>0,o=arguments[1],s=0;i>s;s++)if(e=n[s],t.call(o,e,s,n))return e})}Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=i},{"classlist-polyfill":2,"es6-promise":44,"es6-set/implement":45}],67:[function(t,e,n){var i=t("./lang");n.dictionaryPromise=fetch("json/dictionary.json").then(function(t){return t.json()}).then(function(t){return i.dictionary=t})["catch"](function(t){return console.error(t)}),n.lineRulesPromise=new Promise(function(t){var e=document.querySelector('[href$="css/scheme.css"]'),n=e.sheet;n&&n.cssRules?t(n):e.onload=function(e){return t(n)}}).then(function(t){for(var e=t.cssRules,n={},i=0;i<e.length;++i){var o=e[i];if(o instanceof CSSStyleRule){var s=o.selectorText.match(/\.(M\d+|L)/);s&&s[1]?n[s[1]]=o.style.stroke:"#paths-outer .E"===o.selectorText&&(n.E=o.style.stroke)}}return n})["catch"](function(t){return console.error(t)})},{"./lang":62}],68:[function(t,e,n){function i(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function o(t,e){var n=i("circle");return n.setAttribute("r",e.toString()),n.setAttribute("cy",t.y.toString()),n.setAttribute("cx",t.x.toString()),n}function s(t,e){var n=i("line");return n.setAttribute("x1",t.x.toString()),n.setAttribute("y1",t.y.toString()),n.setAttribute("x2",e.x.toString()),n.setAttribute("y2",e.y.toString()),n}function r(t,e,n){var o=i("path");return h(o,t,e,n),o}function a(t){for(var e,n=[],i=/\D([\d\.]+).*?,.*?([\d\.]+)/g,o=t.getAttribute("d");null!==(e=i.exec(o));)n.push(new g.Point(Number(e[1]),Number(e[2])));return n}function l(t,e){if(4!==e.length)throw new Error("there should be 4 points");var n=(i("path"),["M"].concat(e.map(function(t){return t.x+","+t.y})));n.splice(2,0,"C"),t.setAttribute("d",n.join(" "))}function u(t){for(var e,n=[],i=/\D([\d\.]+)/g,o=t.getAttribute("d");null!==(e=i.exec(o));)n.push(Number(e[1]));return n}function h(t,e,n,i){var o=v.getCircumcenter([e,n,i]),s=Math.atan2(e.y-o.y,e.x-o.x),r=Math.atan2(n.y-o.y,n.x-o.x),a=(Math.atan2(i.y-o.y,i.x-o.x),r-s),l=a<=Math.PI||a>-Math.PI?0:1,u=e.subtract(o),h=n.subtract(o),c=u.x*h.y-h.x*u.y<0?0:1,d=v.dot(i.subtract(e),i.subtract(n));0>d&&(c=1-c,l=1-l);var p=o.distanceTo(e),f=["M",e.x,e.y,"A",p,p,0,l,c,n.x,n.y].join(" ");t.setAttribute("d",f)}function c(t){var e=i("path");return l(e,t),e}function d(t,e){var n=o(t,e),i=n.cloneNode(!0);return[n,i]}function p(t,e,n){var i=r(t,e,n),o=i.cloneNode(!0);return[i,o]}function f(t,e){var n=e.clone();return t.x===e.x?n.x+=.01:t.y===e.y&&(n.y+=.01),["transfer-outer","transfer-inner"].map(function(e){var o=i("line");return o.setAttribute("x1",t.x.toString()),o.setAttribute("y1",t.y.toString()),o.setAttribute("x2",n.x.toString()),o.setAttribute("y2",n.y.toString()),o.classList.add(e),o})}function m(t){return document.getElementById("p-"+t.id.slice(2))}function _(t,e){return e.platforms[+t.id.slice(2)]}var g=t("leaflet"),v=t("./math"),y=t("./util");n.createSVGElement=i,n.makeCircle=o,n.makeLine=s,n.makeArc=r,n.getBezierPath=a,n.setBezierPath=l,n.getCircularPath=u,n.setCircularPath=h,n.makeCubicBezier=c,n.makeTransferRing=d,n.makeTransferArc=p,n.makeTransfer=f,n.circleByDummy=m,n.platformByCircle=_;var b;!function(t){function e(t){if("dataset"in t)return t.dataset;for(var e=t.attributes,n={},i=0;i<e.length;++i){var o=e[i].name;o.startsWith("data-")&&(n[o.slice(5)]=t.getAttribute(o))}return n}function n(t,e){for(var n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];t.setAttribute("data-"+o,e[o])}}t.get=e,t.set=n}(b=n.SVGDataset||(n.SVGDataset={}));var x;!function(t){function e(){var t=i("filter");return t.id="shadow",t.setAttribute("width","200%"),t.setAttribute("height","200%"),t.innerHTML='\n            <feOffset result="offOut" in="SourceAlpha" dx="0" dy="4" />\n            <feColorMatrix result="matrixOut" in="offOut" type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.5 0"/>\n            <feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="2" />\n\n            <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n        ',t}function n(){var t=i("filter");return t.id="black-glow",t.innerHTML='<feColorMatrix type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.3 0"/>\n            <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>\n            <feMerge>\n                <feMergeNode in="coloredBlur"/>\n                <feMergeNode in="SourceGraphic"/>\n            </feMerge>',t}t.makeDrop=e,t.makeGlow=n}(x=n.Shadows||(n.Shadows={}));var L;!function(t){function e(t,e,n){void 0===n&&(n=0);var o=i("linearGradient");return s(o,t),o.innerHTML='<stop offset="'+n+'" style="stop-color:'+e[0]+'" />\n        <stop offset="'+(1-n)+'" style="stop-color:'+e[1]+'" />',o}function n(){var t=document.getElementById("transfers-outer").children;if(t)for(var e=0,n=t.length;n>e;++e){var i=t[e],o=i.getAttribute("data-fallbackcolor");if(null===o){var s=document.getElementById("g-"+e),r=[s.firstElementChild,s.lastElementChild].map(function(t){return t.style.stopColor});o=y.Color.mean(r),i.setAttribute("data-fallbackcolor",o)}i.style.stroke=o}}function o(){var t=document.getElementById("transfers-outer").children;if(void 0!==t&&0!==t.length)for(var e=0;e<t.length;++e){var n=t[e];n.style.stroke="url(#g-"+e+")"}}function s(t,e){var n=v.vectorToGradCoordinates(e);t.setAttribute("x1",50*(1-n.x)+"%"),t.setAttribute("y1",50*(1-n.y)+"%"),t.setAttribute("x2",50*(1+n.x)+"%"),t.setAttribute("y2",50*(1+n.y)+"%")}function r(t,e){t.firstElementChild.setAttribute("offset",e.toString()),t.lastElementChild.setAttribute("offset",(1-e).toString())}t.makeLinear=e,t.removeAll=n,t.addAll=o,t.setDirection=s,t.setOffset=r}(L=n.Gradients||(n.Gradients={}));var P;!function(t){function e(t,e,i){return new Promise(function(o){return function s(r){var a=document.getElementById("p-"+e[r]);if(a.style.opacity=null,g.Browser.mobile||n(a,r<i.length?1.5:3,200),r===i.length)return o();var l=document.getElementById("o"+i[r]);if(null===l)return s(r+1);var u=document.getElementById("i"+i[r]),h=l.cloneNode(!0),c=null===u?null:u.cloneNode(!0);document.getElementById("paths-outer").appendChild(h),c&&document.getElementById("paths-inner").appendChild(c);var d=h instanceof SVGLineElement?g.point(Number(h.getAttribute("x1")),Number(h.getAttribute("y1"))).distanceTo(g.point(Number(h.getAttribute("x2")),Number(h.getAttribute("y2")))):h.getTotalLength(),p=i[r].split("-"),f=t["p"===p[0]?"spans":"transfers"][+p[1]],m=f.source===e[r]?d:-d,_=d;h.style.filter="url(#black-glow)";for(var v=0,y=null===c?[h]:[h,c];v<y.length;v++){var b=y[v],x=b.style;x.transition=null,x.opacity=null,x.strokeDasharray=d+" "+d,x.strokeDashoffset=m.toString(),b.getBoundingClientRect(),x.transition="stroke-dashoffset "+_+"ms linear",x.strokeDashoffset="0"}h.addEventListener("transitionend",function(t){if(l.style.opacity=null,"t"!==h.id.charAt(1)){var e=h.getBoundingClientRect(),n=parseFloat(getComputedStyle(l).strokeWidth);e.height>=n&&e.width>=n&&(l.style.filter="url(#black-glow)")}document.getElementById("paths-outer").removeChild(h),c&&(u.style.opacity=null,document.getElementById("paths-inner").removeChild(c)),s(r+1)}),console.log(h)}(0)})}function n(t,e,n){t.getBoundingClientRect(),t.style.transition="transform "+n/2+"ms linear";var i=e-1,o=-t.getAttribute("cx")*i,s=-t.getAttribute("cy")*i;t.style.transform="matrix("+e+", 0, 0, "+e+", "+o+", "+s+")",t.addEventListener("transitionend",function r(t){this.removeEventListener("transitionend",r),this.style.transform="matrix(1, 0, 0, 1, 0, 0)",this.addEventListener("transitionend",function e(t){this.removeEventListener("transitionend",e),this.style.transform=null})})}t.animateRoute=e,t.pulsateCircle=n}(P=n.Animation||(n.Animation={}))},{"./math":64,"./util":75,leaflet:57}],69:[function(t,e,n){var i=t("leaflet"),o={Mapbox:new i.TileLayer("https://{s}.tiles.mapbox.com/v3/inker.mlo91c41/{z}/{x}/{y}.png",{minZoom:9,detectRetina:!1,bounds:null,attribution:'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery  <a href="https://mapbox.com">Mapbox</a>'}),OpenMapSurfer:new i.TileLayer("http://openmapsurfer.uni-hd.de/tiles/roads/x={x}&y={y}&z={z}",{minZoom:9,detectRetina:!0,attribution:'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="https://server.ts.openstreetmap.org/copyright">OpenStreetMap</a>'}),HyddaBase:i.tileLayer("http://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png",{minZoom:9,detectRetina:!0,attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href="http://server.ts.openstreetmap.org/copyright">OpenStreetMap</a>'}),EsriGrey:i.tileLayer("http://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ",minZoom:9,detectRetina:!0})};Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o},{leaflet:57}],70:[function(t,e,n){var i=t("./ui/mapeditor");n.MapEditor=i["default"];var o=t("./ui/faq");n.FAQ=o["default"];var s=t("./ui/textplate");n.TextPlate=s["default"];var r=t("./ui/contextmenu");n.ContextMenu=r["default"]},{"./ui/contextmenu":71,"./ui/faq":72,"./ui/mapeditor":73,"./ui/textplate":74}],71:[function(t,e,n){var i=t("../lang"),o=function(){function t(t,e){var n=this;console.log("adding context menu"),this.metroMap=t,this._items=e,this._extraItems=new Map;var i=t.getMap(),o=this.handler.bind(this);t.getOverlay().addEventListener("contextmenu",o),i.getPanes().mapPane.addEventListener("contextmenu",o);var s=(i.getContainer(),function(t){return n.state=!1});i.getContainer().addEventListener("mousedown",s),i.getContainer().addEventListener("touchstart",s),i.on("movestart",s),this.table=document.createElement("table"),this.table.id="contextmenu",document.body.appendChild(this.table)}return Object.defineProperty(t.prototype,"items",{get:function(){return this._items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"extraItems",{get:function(){return this._extraItems},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return"none"!==this.table.style.display},set:function(t){this.table.style.display=t?null:"none"},enumerable:!0,configurable:!0}),t.prototype.handler=function(t){var e=this;console.log("target",t.target),t.preventDefault(),this.state=!0,this.table.innerHTML="";var n=function(t,n){var o=e.table.insertRow().insertCell(0),s=t.disabled?["disabled",""]:["data-event",n],r=s[0],a=s[1];o.setAttribute(r,a),o.textContent=i.translate(t.text)};this._items.forEach(n),this._extraItems.forEach(function(i,o){o===t.target&&i.forEach(n),e._extraItems["delete"](o)}),this.table.onclick=function(n){console.log(n);var i=n.target,o={clientX:t.clientX,clientY:t.clientY,relatedTarget:t.target},s=i.getAttribute("data-event");s&&(e.state=!1,e.metroMap.dispatchEvent(new MouseEvent(s,o)))};var o=this.table.getBoundingClientRect(),s=o.width,r=o.height,a=document.documentElement,l=a.clientWidth,u=a.clientHeight,h=t.clientX,c=t.clientY,d=h+s>l?l-s:h,p=c+r>u?c-r:c;this.table.style.transform="translate("+d+"px, "+p+"px)"},t}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=o},{"../lang":62}],72:[function(t,e,n){var i=t("hammerjs"),o=t("../util"),s=function(){function t(t,e){var n=this,o=fetch(e)["catch"](function(t){return console.error(t)}).then(function(t){return t.json()});this.map=t.getMap();var s=document.createElement("button");s.id="faq-button",s.textContent="FAQ",s.classList.add("leaflet-control"),s.onclick=this.showFAQ.bind(this),document.querySelector(".leaflet-right.leaflet-top").appendChild(s),this.button=s,this.card=document.createElement("div"),this.card.id="faq-card",L.Browser.mobile&&new i(this.card).on("swipeleft swiperight",this.hideFAQ.bind(this)),document.body.appendChild(this.card);var r=function(t){return'<div><span class="question">'+t.q+'</span><span class="answer">'+t.a+"</span></div>"};o.then(function(t){return n.card.innerHTML+=t.faq.map(r).join("")})}return t.prototype.showFAQ=function(t){var e=this,n=this.card.style;n.display="inline",n.transform="scale(0.1)",n.opacity="0",this.card.getBoundingClientRect(),n.transform=null,n.opacity=null,this.button.disabled=!0,L.Browser.mobile||(this.map.getContainer().classList.add("dimmed"),this.map.once("mousedown",function(t){return e.hideFAQ(t.originalEvent)}),o.once(window,"keydown",function(t){27===t.keyCode&&e.map.fireEvent("mousedown")}))},t.prototype.hideFAQ=function(t){var e=this;console.log("hiding"),this.card.getBoundingClientRect(),this.card.style.transform="scale(0.1)",this.card.style.opacity="0",L.Browser.mobile||this.map.getContainer().classList.remove("dimmed"),o.once(this.card,"transitionend",function(t){return e.card.style.display=null}),this.button.disabled=!1},t}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=s},{"../util":75,hammerjs:56}],73:[function(t,e,n){var i=t("../util"),o=t("../svg"),s=t("../lang"),r=function(){function t(t){var e=this;this.metroMap=t;var n=document.createElement("button");n.id="edit-map-button",n.textContent="Edit Map",n.classList.add("leaflet-control"),n.onclick=this.editMapClick.bind(this),document.querySelector(".leaflet-right.leaflet-top").appendChild(n),this.button=n,this.editMode=!1,this.metroMap.getMap().on("zoomend",function(t){e.editMode&&e.addMapListeners()})}return Object.defineProperty(t.prototype,"editMode",{get:function(){return this._editMode},set:function(t){if(t){this.button.textContent=s.translate("Save map"),this.button.onclick=this.saveMapClick.bind(this);var e=document.getElementById("dummy-circles");e.onmousedown=e.onclick=null,this.metroMap.contextMenu.items["delete"]("platformadd")}else this.button.textContent=s.translate("Edit map"),this.button.onclick=this.editMapClick.bind(this);this._editMode=t},enumerable:!0,configurable:!0}),t.prototype.editMapClick=function(t){this.editMode=!0;var e=this.metroMap.getMap();e.getZoom()<12&&e.setZoom(12),this.addMapListeners()},t.prototype.saveMapClick=function(t){var e=this.metroMap.getGraph(),n=JSON.stringify(e,function(t,e){return t.startsWith("_")?void 0:e});i.downloadAsFile("graph.json",n),this.editMode=!1},t.prototype.addMapListeners=function(){console.log("adding");var t=this.metroMap.getMap(),e=this.metroMap.getPlate(),n=this.metroMap.getGraph(),i=document.getElementById("dummy-circles"),s=this.metroMap.contextMenu;s.items.set("platformadd",{text:"New station"}),i.onmousedown=function(i){if(0===i.button){var r=o.platformByCircle(i.target,n);t.dragging.disable(),t.on("mousemove",function(t){r.location=t.latlng,e.disabled=!0}),t.once("mouseup",function(n){t.off("mousemove").dragging.enable(),e.disabled=!1,e.show(o.circleByDummy(n.originalEvent.target))})}else if(1===i.button);else{console.log("circle right-clicked");var a=i.target;if(a.hasAttribute("cy")){var l=(new Map).set("platformrename",{text:"Rename station"}).set("platformdelete",{text:"Delete station"});s.extraItems.set(a,l)}}}},t}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=r},{"../lang":62,"../svg":68,"../util":75}],74:[function(t,e,n){var i=t("../svg"),o=t("../lang"),s=function(){function t(t){this._disabled=!1,this._editable=!1,this.graph=t,this._element=i.createSVGElement("g"),this._element.id="station-plate",this._element.style.display="none";var e=function(t,e,n,o){var s=i.createSVGElement(t);return s.id=e,s.classList.add(n),Object.keys(o).forEach(function(t){return s.setAttribute(t,o[t])}),s},n=e("line","pole","plate-pole",{x1:0,y1:0,x2:4,y2:8});this._element.appendChild(n);var o=i.createSVGElement("g"),s=e("rect","plate-box","plate-box",{x:0,y:0,filter:"url(#shadow)"});o.appendChild(s);var r=e("text","plate-text","plate-text",{fill:"black",x:0,y:0}),a=i.createSVGElement("tspan");a.setAttribute("x","3"),a.setAttribute("dy","12"),r.appendChild(a),r.appendChild(a.cloneNode(!0)),r.appendChild(a.cloneNode(!0)),o.appendChild(r),this._element.appendChild(o),
console.log(this._element.childNodes)}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){(t?this.hide:getSelection().removeAllRanges)(),this._disabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editable",{get:function(){return this._editable},set:function(t){for(var e=t?"true":null,n=this._element.childNodes[1].children[1],i=n.children,o=0;o<i.length;++o)i[o].contentEditable=e},enumerable:!0,configurable:!0}),t.prototype.show=function(t){this.disabled||"none"===this._element.style.display&&(this.modify(t),this._element.style.display=null)},t.prototype.hide=function(){this._element.style.display="none"},t.prototype.modify=function(t){var e=new L.Point(Number(t.getAttribute("cx")),Number(t.getAttribute("cy"))),n=Number(t.getAttribute("r")),s=Math.trunc(n),r=(this._element.firstElementChild,new L.Point(4+s,8+s)),a=i.platformByCircle(t,this.graph),l=a.name,u=a.altNames.fi,h=a.altNames.en,c=u?"fi"===o.userLanguage?[u,l]:[l,u]:[l];h&&c.push(h),this.modifyBox(e.subtract(r),c)},t.prototype.modifyBox=function(t,e){for(var n=this,i=this._element.lastChild,o=i.firstChild,s=i.lastChild,r=s.childNodes,a=0;a<e.length;++a)r[a].textContent=e[a];for(;a<r.length;)r[a++].textContent=null;var l=function(e){var i=s.getBBox(),r=i.width,a=i.height;r=Math.round(r),o.setAttribute("width",(r+6).toString()),o.setAttribute("height",(a+e).toString());var l=t.x-r,u=t.y-a;n._element.setAttribute("transform","translate("+l+", "+u+")"),s.setAttribute("transform","translate("+r+", 0)")};L.Browser.webkit?l(4):setTimeout(l,0,4)},t}();Object.defineProperty(n,"__esModule",{value:!0}),n["default"]=s},{"../lang":62,"../svg":68}],75:[function(t,e,n){function i(t,e){var n=t.length;if(n!==e.length)return!1;for(var i=0;n>i;++i)if(t[i]!==e[i])return!1;return!0}function o(t,e){var n=new d.Point(e.clientX,e.clientY),i=t.getContainer().getBoundingClientRect(),o=new d.Point(i.left,i.top),s=t.containerPointToLatLng(n.subtract(o));return s}function s(t,e,n){var i=function(o){t.removeEventListener(e,i),n(o)};t.addEventListener(e,i)}function r(t){function e(){removeEventListener("keydown",n),removeEventListener("backbutton",i)}var n=function(n){27===n.keyCode&&(t(n),e())},i=function(n){t(n),e()};addEventListener("keydown",n),addEventListener("backbutton",i)}function a(){for(var t="#paths-inner *, #paths-outer *, #transfers-inner *, #transfers-outer *, #station-circles *",e=document.querySelectorAll(t),n=0;n<e.length;++n){var i=e[n];i.style.opacity=null,"t"!==i.id.charAt(1)&&(i.style.filter=null)}}function l(t,e){var n=0;setInterval(function(){return document.title=t[++n%t.length]},e)}function u(t,e){var n=document.createElement("a"),i=new Blob([e],{type:"octet/stream"}),o=window.URL.createObjectURL(i);n.href=o,n.download=t,n.click(),window.URL.revokeObjectURL(o)}function h(t,e){var n=e.name,i=e.altNames,o=i.fi,s=i.en,r=s?[n,o,s]:o?[n,o]:[n],a=r.join("|");m.prompt(f("New name"),a,function(i,o){var s=o.split("|");if(e.name=s[0],e.altNames.fi=s[1],e.altNames.en=s[2],o===a)return m.warning(f("Name was not changed"));var l=r.slice(1).join(", "),u=s.slice(1).join(", ");m.success(n+" ("+l+") "+f("renamed to")+" "+s[0]+" ("+u+")");var h=t.stations[e.station];h.platforms.length<2||m.confirm(f("Rename the entire station")+"?",function(){for(var e=0,n=h.platforms;e<n.length;e++){var i=n[e],r=t.platforms[i];r.name=s[0],r.altNames.fi=s[1],r.altNames.en=s[2]}h.name=s[0],h.altNames.fi=s[1],h.altNames.en=s[2],m.success(f("The entire station was renamed to")+" "+o)})},function(){return m.warning(f("Name change cancelled"))})}function c(t){var e=this;this.graph=t.getGraph(),this.map=t.getMap();for(var n=this.graph.platforms.filter(function(t){return e.graph.routes[e.graph.spans[t.spans[0]].routes[0]].line.startsWith("M")}).map(function(t){return t.location}),i=function(t,e){return t.reduce(function(t,n){return t+e.distanceTo(n)},0)},o=y.geoMean(n,i),s=5e3;2e4>s;s+=5e3)d.circle(o,s-250,{weight:1}).addTo(this.map),d.circle(o,s+250,{weight:1}).addTo(this.map);var r=(this.graph.platforms.filter(function(t){return e.graph.routes[e.graph.spans[t.spans[0]].routes[0]].line.startsWith("E")}).map(function(t){return t.location}),this.graph.platforms.find(function(t){return"Glavnyj voxal"===t.name&&e.graph.routes[e.graph.spans[t.spans[0]].routes[0]].line.startsWith("E")}).location);d.circle(r,3e4).addTo(this.map),d.circle(r,45e3).addTo(this.map)}var d=t("leaflet"),p=t("./lang"),f=function(t){return p.translate(t)},m=t("alertifyjs");n.arrayEquals=i,n.mouseToLatLng=o,n.once=s,n.onceEscapePress=r,n.resetStyle=a;var _;!function(t){function e(t){if(0==t.length)return new d.Point(0,0);var e=t.match(/translate(3d)?\((-?\d+).*?,\s?(-?\d+).*?(,\s?(-?\d+).*?)?\)/i),n=e[0],i=e[2],o=e[3];return n?new d.Point(Number(i),Number(o)):new d.Point(0,0)}function n(t){var e=t.style;e.transform=e.transform.replace(/translate3d\s*\((.+?,\s*.+?),\s*.+?\s*\)/i,"translate($1)")}t.parse=e,t.replace=n}(_=n.CSSTransform||(n.CSSTransform={}));var g;!function(t){function e(t,e){function n(e){if(void 0===t.platforms.find(function(t){return t.name===e}))throw new Error("platform "+e+" doesn't exist")}function i(t){for(var e=0,i=Object.keys(t);e<i.length;e++){var o=i[e],s=t[o];"string"==typeof s?n(s):s.forEach(n)}}return new Promise(function(n,o){var s=e.crossPlatform;Object.keys(s).forEach(function(e){void 0===t.platforms.find(function(t){return t.name===e})&&o("platform "+e+" doesn't exist");var n=s[e];"forEach"in n?n.forEach(i):i(n)}),n("hints json seems okay")})}function n(t,e,n){var i=n.spans.map(function(e){return t.spans[e]}),o=[];i.forEach(function(e){return e.routes.forEach(function(e){return o.push(t.routes[e])})});var s=o.map(function(t){return t.line}),r=e[n.name];if(r)if("forEach"in r){for(var a=0;a<r.length;++a)if(Object.keys(r[a]).some(function(t){return s.indexOf(t)>-1}))return a}else if(Object.keys(r).some(function(t){return s.indexOf(t)>-1}))return-1;return null}t.verify=e,t.hintContainsLine=n}(g=n.Hints||(n.Hints={}));var v;!function(t){function e(t){return t.match(/[0-9a-f]{1,2}/gi).map(function(t){return parseInt(t,16)})}function n(t){return t.match(/rgb\s*\((\d+),\s*(\d+),\s*(\d+)\s*\)/).slice(1).map(Number)}function i(t){var i=function(t,i){return(i.startsWith("#")?e:n)(i).map(function(e,n){return t[n]+e})},o=t.reduce(i,[0,0,0]).map(function(e){return Math.floor(e/t.length)}),s=o[0],r=o[1],a=o[2];return"rgb("+s+", "+r+", "+a+")"}t.mean=i}(v=n.Color||(n.Color={})),n.flashTitle=l,n.downloadAsFile=u,n.platformRenameDialog=h;var y=t("./geo");n.drawZones=c},{"./geo":61,"./lang":62,alertifyjs:1,leaflet:57}],76:[function(t,e,n){},{}]},{},[76,63]);